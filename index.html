<!DOCTYPE html>
<html lang="fr">
<head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8F7MY8T2TC"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-8F7MY8T2TC');
</script>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ton coach en libert√© financi√®re !</title>

  <meta name="robots" content="index,follow">
  <link rel="canonical" href="https://parlonscash.pro/">

<style>

/* === STYLES √âCRAN D'ACCUEIL === */
.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.8);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9999;
}

.modal-content {
  background: white;
  border-radius: 20px;
  padding: 40px;
  max-width: 600px;
  width: 90%;
  max-height: 90vh;
  overflow-y: auto;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
  animation: slideIn 0.3s ease-out;
}

@keyframes slideIn {
  from {
    transform: translateY(-50px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

.welcome-header {
  text-align: center;
  margin-bottom: 30px;
}

.welcome-header h1 {
  font-size: 2em;
  color: #1e40af;
  margin-bottom: 10px;
}

.welcome-header p {
  color: #6b7280;
  font-size: 1.1em;
}

.choice-buttons {
  display: grid;
  gap: 20px;
  margin-top: 30px;
}

.choice-btn {
  padding: 25px;
  border: 2px solid #e5e7eb;
  border-radius: 12px;
  background: white;
  cursor: pointer;
  transition: all 0.2s;
  text-align: left;
}

.choice-btn:hover {
  border-color: #2563eb;
  background: #eff6ff;
  transform: translateY(-2px);
}

.choice-btn h3 {
  color: #1e40af;
  margin-bottom: 8px;
  font-size: 1.3em;
}

.choice-btn p {
  color: #6b7280;
  margin: 0;
}

.question-container {
  animation: fadeIn 0.3s ease-out;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

.question-title {
  color: #1f2937;
  font-size: 1.4em;
  margin-bottom: 20px;
  text-align: center;
}

.progress-bar {
  background: #e5e7eb;
  height: 8px;
  border-radius: 4px;
  margin-bottom: 30px;
  overflow: hidden;
}

.progress-fill {
  background: linear-gradient(90deg, #2563eb, #10b981);
  height: 100%;
  transition: width 0.3s ease;
}

.options-grid {
  display: grid;
  gap: 15px;
  margin: 20px 0;
}

.option-btn {
  padding: 20px;
  border: 2px solid #e5e7eb;
  border-radius: 10px;
  background: white;
  cursor: pointer;
  transition: all 0.2s;
  text-align: left;
  font-size: 1em;
}

.option-btn:hover {
  border-color: #2563eb;
  background: #eff6ff;
}

.option-btn.selected {
  border-color: #2563eb;
  background: #dbeafe;
  font-weight: 600;
}

.nav-buttons {
  display: flex;
  justify-content: space-between;
  margin-top: 30px;
}

.btn-secondary, .btn-primary {
  padding: 12px 30px;
  border: none;
  border-radius: 8px;
  font-size: 1em;
  cursor: pointer;
  transition: all 0.2s;
}

.btn-secondary {
  background: #f3f4f6;
  color: #374151;
}

.btn-secondary:hover {
  background: #e5e7eb;
}

.btn-primary {
  background: #2563eb;
  color: white;
}

.btn-primary:hover {
  background: #1e40af;
}

.btn-primary:disabled {
  background: #d1d5db;
  cursor: not-allowed;
}

.results-container {
  animation: fadeIn 0.5s ease-out;
}

.priority-box {
  background: #fef2f2;
  border-left: 4px solid #dc2626;
  padding: 20px;
  border-radius: 8px;
  margin-bottom: 20px;
}

.priority-box h3 {
  color: #dc2626;
  margin-bottom: 15px;
}

.priority-item {
  background: white;
  padding: 15px;
  border-radius: 8px;
  margin-bottom: 10px;
  border-left: 3px solid #f59e0b;
}

.priority-item h4 {
  color: #1f2937;
  margin-bottom: 5px;
}

.priority-item p {
  color: #6b7280;
  margin: 0;
  font-size: 0.9em;
}

.recommendations-box {
  background: #eff6ff;
  border-left: 4px solid #2563eb;
  padding: 20px;
  border-radius: 8px;
  margin-top: 20px;
}

.recommendations-box h3 {
  color: #1e40af;
  margin-bottom: 15px;
}

.recommendations-box ul {
  list-style: none;
  padding: 0;
}

.recommendations-box li {
  padding: 10px 0;
  color: #374151;
  border-bottom: 1px solid #dbeafe;
}

.recommendations-box li:last-child {
  border-bottom: none;
}

.final-buttons {
  display: flex;
  gap: 15px;
  margin-top: 30px;
}

.final-buttons button {
  flex: 1;
}

.skip-link {
  text-align: center;
  margin-top: 20px;
}

.skip-link a {
  color: #6b7280;
  text-decoration: none;
  font-size: 0.9em;
}

.skip-link a:hover {
  color: #2563eb;
  text-decoration: underline;
}

.hidden {
  display: none;
}

<style>
body {
  overflow-x: hidden;
}

.container {
  overflow: hidden;
}

.warning-box strong {
  display:flex;
  align-items:center;
  gap:8px;
  font-size:1em;
}

#tab-apropos .warning-box {
  display: none;
}

.danger-box strong {
  display:flex;
  align-items:center;
  gap:8px;
  font-size:1.05em;
}
.danger-box ul {
  margin:10px 0 0 20px;
  list-style:disc;
}

*{margin:0;padding:0;box-sizing:border-box}
body{font-family:Arial,sans-serif;background:#f3f4f6;color:#1f2937}
.container{max-width:1200px;margin:0 auto;padding:20px}
.tab-content.active h2:first-child {
  margin-top: 0;
}
header{background:linear-gradient(135deg,#1e40af 0%,#1e40af 100%);color:white;padding:30px 20px}
.btn-export {
  background:#10b981;
  color:white;
  padding:10px 20px;
  border:none;
  border-radius:8px;
  font-weight:bold;
  cursor:pointer;
}
header h1{font-size:2em;margin-bottom:10px}
.nav{background:white;padding:15px 20px;margin-bottom:0px;display:flex;gap:10px;overflow-x:auto;flex-wrap:wrap}
.nav button{padding:10px 20px;border:none;background:#e5e7eb;color:#374151;border-radius:8px;cursor:pointer;font-size:14px}
.nav button.active{background:#2563eb;color:white}
.tab-content{display:none}
.tab-content.active{display:block;padding-top:0}
.card{background:white;padding:25px;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,0.05);margin-bottom:20px}
.stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;margin-bottom:30px}
.stat-card{background:white;padding:25px;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,0.05)}
.stat-label{font-size:0.875em;color:#6b7280;margin-bottom:8px}
.stat-value{font-size:2em;font-weight:bold}
.blue{color:#2563eb}
.green{color:#10b981}
.red{color:#ef4444}
.purple{color:#8b5cf6}
.orange{color:#f97316}
.grid-2{display:grid;grid-template-columns:repeat(auto-fit,minmax(400px,1fr));gap:25px}
.form-group{margin-bottom:20px}
.form-group label{display:block;font-size:0.875em;font-weight:500;color:#374151;margin-bottom:8px}
.form-group input,.form-group select{width:100%;padding:12px;border:1px solid #d1d5db;border-radius:8px;font-size:1em}
.total-row{padding-top:20px;border-top:2px solid #e5e7eb;margin-top:20px;display:flex;justify-content:space-between;font-weight:600}
.total-row .value{font-size:1.5em}
.summary-box{background:#eff6ff;padding:20px;border-radius:10px;margin-top:25px}
.summary-row{display:flex;justify-content:space-between;padding:10px 0}
.result-box{padding:20px;border-radius:10px;margin-bottom:15px}
.result-box.blue{background:#dbeafe}
.result-box.red{background:#fee2e2}
.result-box.orange{background:#fed7aa}
.result-box.purple{background:#ede9fe}
.result-box.green{background:#d1fae5}
.result-box.yellow{background:#fef3c7}
.progress-bar{background:#e5e7eb;height:20px;border-radius:10px;overflow:hidden;margin-top:10px}
.progress-fill{background:#10b981;height:100%;transition:width 0.3s}
.section-title{font-size:1.3em;color:#1f2937;margin:30px 0 15px 0;font-weight:600;border-bottom:2px solid #e5e7eb;padding-bottom:10px}
.hidden{display:none}
footer{background:#1f2937;color:white;text-align:center;padding:30px;margin-top:50px}

body {
  font-family: system-ui, sans-serif;
  color: #374151;
  background: #f9fafb;
}

h2, h3 {
  color: #1e3a8a;
  font-weight: 600;
}

.card {
  background: #fff;
  border: 1px solid #e5e7eb;
  border-radius: 12px;
  padding: 20px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}

input[type="number"] {
  width: 100%;
  padding: 8px 10px;
  border: 1px solid #d1d5db;
  border-radius: 6px;
  font-size: 0.95rem;
}

button, .tab-button {
  transition: background-color 0.2s ease, transform 0.1s ease;
}
button:hover, .tab-button:hover {
  transform: scale(1.03);
  background-color: #1e3a8a;
}

</style>

</head>
<body>

<!-- === √âCRAN D'ACCUEIL GUID√â === -->
<div id="welcomeModal" class="modal-overlay">
  <div class="modal-content">
    <!-- √âcran de bienvenue -->
    <div id="welcomeScreen">
      <div class="welcome-header">
        <h1>üéØ Bienvenue !</h1>
        <p>Comment souhaitez-vous commencer ?</p>
      </div>
      
      <div class="choice-buttons">
        <button class="choice-btn" onclick="startGuide()">
          <h3>üöÄ Parcours guid√©</h3>
          <p>5 questions pour personnaliser votre exp√©rience (5 min)</p>
        </button>
        
        <button class="choice-btn" onclick="skipGuide()">
          <h3>üìä Acc√®s direct</h3>
          <p>Je sais ce que je veux faire</p>
        </button>
      </div>
      
      <div class="skip-link">
        <a href="#" onclick="skipGuide(); return false;">Passer cette intro</a>
      </div>
    </div>
    
    <!-- Questions (cach√© au d√©but) -->
    <div id="questionsScreen" class="hidden"></div>
    
    <!-- R√©sultats (cach√© au d√©but) -->
    <div id="resultsScreen" class="hidden"></div>
  </div>
</div>

<header>
  <div class="container" style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap">
    <div>
      <h1>Ton coach en libert√© financi√®re !</h1>
      <p>G√©rez vos finances intelligemment</p>
    </div>
    <div style="display:flex;gap:10px;flex-wrap:wrap">
      <button class="btn-export" onclick="exporterCSV()">üì• Exporter CSV</button>
      <button class="btn-export" style="background:#2563eb" onclick="window.print()">üñ®Ô∏è Exporter PDF</button>
    </div>
  </div>
</header>

<div class="nav">
<button onclick="changeTab('dashboard')" id="btn-dashboard" class="active">Tableau de bord</button>
<button onclick="changeTab('bilan')" id="btn-bilan">Bilan</button>
<button onclick="changeTab('budget')" id="btn-budget">Budget</button>
<button onclick="changeTab('impots')" id="btn-impots">Imp√¥ts</button>
<button onclick="changeTab('objectifs')" id="btn-objectifs">Objectifs</button>
<button onclick="changeTab('acheter-louer')" id="btn-acheter-louer">Acheter vs Louer</button>
<button onclick="changeTab('dettes')" id="btn-dettes">Remboursement dettes</button>
<button onclick="changeTab('plaisirs')" id="btn-plaisirs">Gestion des plaisirs</button>
<button onclick="changeTab('besoin')" id="btn-besoin">En as-tu besoin ?</button>
<button onclick="changeTab('couple')" id="btn-couple">Finances de couple</button>
<button onclick="changeTab('aide')" id="btn-aide">Aide √† la d√©cision</button>
<button onclick="changeTab('apropos')" id="btn-apropos">√Ä propos</button>
<button onclick="changeTab('confidentialite')" id="btn-confidentialite">Confidentialit√©</button>
</div>

<div class="container">
<div id="tab-dashboard" class="tab-content active">

  <h2>Tableau de bord financier</h2>

  <div class="stats">
    <div class="stat-card"><div class="stat-label">Valeur nette</div><div class="stat-value blue" id="dash-valeur">0 $</div></div>
    <div class="stat-card"><div class="stat-label">Actifs totaux</div><div class="stat-value green" id="dash-actifs">0 $</div></div>
    <div class="stat-card"><div class="stat-label">Passifs totaux</div><div class="stat-value red" id="dash-passifs">0 $</div></div>
    <div class="stat-card"><div class="stat-label">Taux √©pargne</div><div class="stat-value purple" id="dash-taux">0%</div></div>
  </div>

  <div class="card">
    <h3>Diagnostic financier</h3>
    <div id="diagnostic-global">Entrez vos donn√©es pour un diagnostic</div>
  </div>

  <!-- Bandeau inspirant -->
  <div style="background:linear-gradient(135deg,#1e40af 0%,#1e40af 100%);
              color:white;
              padding:40px;
              border-radius:12px;
              margin-top:20px;
              text-align:center;">
    <h3 style="font-size:1.8em;font-weight:bold;color:white;">¬´ "Le succ√®s est la somme de petits efforts r√©p√©t√©s jour apr√®s jour." ‚Äì Robert Collier ¬ª</h3>
    <p style="margin-top:15px;font-size:1.1em;">
      Merci de faire partie de cette aventure. Continue √† construire, apprendre et avancer ‚Äî
      une d√©cision √©clair√©e √† la fois.
    </p>
  </div>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3695467180266092"
     crossorigin="anonymous"></script>

</div>

<div id="tab-bilan" class="tab-content">
<h2>Bilan personnel</h2>
<div class="grid-2">
<div class="card">
<h3 class="green">ACTIFS</h3>
<div class="form-group"><label>Compte bancaire</label><input type="number" id="cb" value="0" onchange="calc()"></div>
<div class="form-group"><label>CELI</label><input type="number" id="celi" value="0" onchange="calc()"></div>
<div class="form-group"><label>CELIAPP</label><input type="number" id="celiapp" value="0" onchange="calc()"></div>
<div class="form-group"><label>Compte non enregistre</label><input type="number" id="cne" value="0" onchange="calc()"></div>
<div class="form-group"><label>REER</label><input type="number" id="reer" value="0" onchange="calc()"></div>
<div class="form-group"><label>Immobilisations</label><input type="number" id="immob" value="0" onchange="calc()"></div>
<div class="form-group"><label>Autre</label><input type="number" id="autre-actif" value="0" onchange="calc()"></div>
<div class="total-row green"><span>Total actifs</span><span class="value" id="ta">0 $</span></div>
</div>
<div class="card">
<h3 class="red">PASSIFS</h3>
<div class="form-group"><label>Cartes de credit</label><input type="number" id="cc" value="0" onchange="calc()"></div>
<div class="form-group"><label>Marge de credit</label><input type="number" id="mc" value="0" onchange="calc()"></div>
<div class="form-group"><label>Pret automobile</label><input type="number" id="pa" value="0" onchange="calc()"></div>
<div class="form-group"><label>Hypotheque</label><input type="number" id="hypo" value="0" onchange="calc()"></div>
<div class="form-group"><label>Autre</label><input type="number" id="autre-passif" value="0" onchange="calc()"></div>
<div class="total-row red"><span>Total passifs</span><span class="value" id="tp">0 $</span></div>
<div class="summary-box"><div class="summary-row"><strong>Valeur nette</strong><strong class="blue" style="font-size:1.5em" id="vn">0 $</strong></div></div>
</div>
</div>
</div>

<div id="tab-budget" class="tab-content">
<h2>Budget mensuel</h2>
<div class="grid-2">
<div class="card">
<h3>Revenus</h3>
<div class="form-group"><label>Revenu mensuel net</label><input type="number" id="revenu" value="0" onchange="calc()"></div>
<div class="form-group"><label>Revenu de loyer</label><input type="number" id="rev-loyer" value="0" onchange="calc()"></div>
<div class="form-group"><label>Autre revenu</label><input type="number" id="autre-revenu" value="0" onchange="calc()"></div>
<h4 style="margin-top:20px">Depenses</h4>
<div class="form-group">
<label>Statut residentiel</label>
<select id="statut-resid" onchange="toggleHypotheque()">
<option value="locataire">Locataire</option>
<option value="proprio">Proprietaire</option>
</select>
</div>
<div class="form-group" id="loyer-group"><label>Loyer</label><input type="number" id="loyer" value="0" onchange="calc()"></div>
<div class="form-group hidden" id="hypo-group"><label>Paiement hypothecaire</label><input type="number" id="paiement-hypo" value="0" onchange="calc()"></div>
<div class="form-group hidden" id="taxes-proprio-group">
  <label>Taxes et entretien (mensuels)</label>
  <input type="number" id="taxes-entretien" value="0" onchange="calc()">
  <small style="display:block;margin-top:5px;color:#6b7280;">
    Taxes municipales + scolaires + entretien moyen
  </small>
</div>
<div class="form-group"><label>Alimentation</label><input type="number" id="d2" value="0" onchange="calc()"></div>
<div class="form-group"><label>Transport</label><input type="number" id="d3" value="0" onchange="calc()"></div>
<div class="form-group"><label>Assurances</label><input type="number" id="d4" value="0" onchange="calc()"></div>
<div class="form-group"><label>Loisirs</label><input type="number" id="d5" value="0" onchange="calc()"></div>
<div class="form-group"><label>Autres</label><input type="number" id="d6" value="0" onchange="calc()"></div>
</div>
<div class="card">
<h3>Resume</h3>
<div class="summary-box">
<div class="summary-row"><span>Revenus totaux</span><strong id="rt">0 $</strong></div>
<div class="summary-row"><span>Total depenses</span><strong id="td">0 $</strong></div>
<div class="summary-row"><span>Epargne nette</span><strong class="green" id="en">0 $</strong></div>
<div class="summary-row"><span>Taux epargne</span><strong class="blue" id="te">0%</strong></div>
</div>
</div>
</div>
<div class="card">
<h3>Analyse budget 50-20-30</h3>
<p style="background:#fef3c7;padding:15px;border-radius:8px;margin-bottom:15px">Regle 50-20-30: 50% besoins essentiels, 20% epargne, 30% loisirs/desirs</p>
<div id="analyse-503020"></div>
</div>
<div class="card">
<h3>Fonds d'urgence</h3>
<p style="background:#fef3c7;padding:15px;border-radius:8px;margin-bottom:15px">Objectif: 3 √† 6 mois de depenses en compte bancaire</p>
<div id="resultat-fonds-urgence"></div>
</div>
</div>

<div id="tab-impots" class="tab-content">

  <!-- Encadr√© d‚Äôavertissement -->
  <div style="
    display:flex;
    align-items:flex-start;
    gap:12px;
    background:#fffaf0;
    border:1px solid #fcd34d;
    border-left:6px solid #f59e0b;
    padding:18px 22px;
    border-radius:10px;
    box-shadow:0 2px 4px rgba(0,0,0,0.05);
    margin-bottom:25px;
  ">
    <div style="font-size:26px;line-height:1;">‚ö†Ô∏è</div>
    <div style="color:#92400e;font-family:system-ui;">
      <strong style="font-size:1.1rem;">Avertissement important</strong><br>
      <p style="margin:6px 0 10px 0;">
        Le calcul ci-dessous est simplifi√© et ne tient pas compte des √©l√©ments suivants :
      </p>
      <ul style="margin:0 0 10px 20px; padding:0;">
        <li>Abattement du Qu√©bec (16.5%)</li>
        <li>Cr√©dits d‚Äôimp√¥t de base</li>
        <li>Cotisations RRQ, RQAP, Assurance-emploi</li>
        <li>D√©ductions sp√©cifiques (frais m√©dicaux, frais de garde, etc.)</li>
      </ul>
      <p style="margin:0;">
        üëâ Il est recommand√© de consulter un <strong>comptable</strong> ou un <strong>fiscaliste</strong>
        pour obtenir des calculs pr√©cis et adapt√©s √† votre situation.
      </p>
    </div>
  </div> <!-- ‚úÖ ici tu fermes l‚Äôencadr√© SEULEMENT -->

  <!-- Calculateur -->
  <h2>Calculateur d‚Äôimp√¥ts</h2>
  <p>Entrez vos informations pour estimer vos imp√¥ts :</p>
  <p style="background:#fef3c7;padding:15px;border-radius:8px;margin-bottom:15px">
    Calculs bas√©s sur les tranches d'imposition f√©d√©rales et provinciales du Qu√©bec pour 2025.
  </p>

  <div class="grid-2">
    <div class="card">
      <h3>Informations</h3>
      <div class="form-group"><label>Revenu brut annuel</label><input type="number" id="rb" value="0" onchange="calc()"></div>
      <div class="form-group"><label>Contribution REER</label><input type="number" id="cr" value="0" onchange="calc()"></div>
      <div class="form-group"><label>Autres d√©ductions</label><input type="number" id="ad" value="0" onchange="calc()"></div>
    </div>

    <div class="card">
      <h3>R√©sultats</h3>
      <div class="result-box blue"><div>Revenu imposable</div><div id="ri">0 $</div></div>
      <div class="result-box red"><div>Imp√¥t f√©d√©ral</div><div id="impf">0 $</div></div>
      <div class="result-box orange"><div>Imp√¥t provincial (QC)</div><div id="impp">0 $</div></div>
      <div class="result-box purple"><div>Imp√¥t total</div><div id="impt">0 $</div></div>
      <div class="result-box green"><div>Revenu net</div><div id="rn">0 $</div></div>
    </div>
  </div>

</div> <!-- ‚úÖ ici tu fermes le tab-impots -->

<div id="tab-objectifs" class="tab-content">
<h2>Objectifs et Projections</h2>

<div class="section-title">Achat d'une maison</div>
<div class="card">
  <div class="form-group">
    <label>Revenu brut annuel m√©nage ($)</label>
    <input type="number" id="revenu-brut-menage" value="0" onchange="calcImmobilier()">
  </div>
 <div class="form-group">
  <label>Mise de fonds (%)</label>
  <select id="mise-de-fonds-pct" onchange="calcImmobilier()">
    <option value="5">5%</option>
    <option value="10">10%</option>
    <option value="15">15%</option>
    <option value="20" selected>20%</option>
  </select>
</div> 
  <div class="form-group">
    <label>Taux hypoth√©caire (%)</label>
    <input type="number" id="taux-hypo" value="5" step="0.1" onchange="calcImmobilier()">
  </div>
<div class="form-group">
  <label>P√©riode d'amortissement (ann√©es)</label>
  <select id="amortissement" onchange="calcImmobilier()">
    <option value="25" selected>25 ans</option>
    <option value="26">26 ans</option>
    <option value="27">27 ans</option>
    <option value="28">28 ans</option>
    <option value="29">29 ans</option>
    <option value="30">30 ans</option>
  </select>
</div>

  <div class="form-group">
    <label>Prix de la maison envisag√©e ($)</label>
    <input type="number" id="prix-maison" value="0" onchange="calcImmobilier()">
  </div>

  <div id="resultat-immobilier"></div>
</div>

<div class="section-title">Epargne pour projet personnel</div>
<div class="card">
<p style="background:#fef3c7;padding:15px;border-radius:8px;margin-bottom:15px">Voyage, achat voiture, annee sabbatique, etudes... Calculez combien epargner mensuellement pour realiser votre projet.</p>
<div class="form-group"><label>Montant cible ($)</label><input type="number" id="obj-montant" value="0" onchange="calc()"></div>
<div class="form-group"><label>Date cible</label><input type="date" id="obj-date" onchange="calc()"></div>
<div class="form-group">
  <label>Taux de rendement annuel (%)</label>
  <input type="number" id="taux-rendement-objectif" value="3" step="0.1" min="0" max="10" onchange="calc()">
  <small style="display:block;margin-top:5px;color:#6b7280;">Ex: 3% pour un compte √©pargne, 5-6% pour un placement √©quilibr√©</small>
</div>
<div id="resultat-objectif"></div>
</div>

<div class="section-title">Capital necessaire a la retraite</div>
<div class="card">
<p style="background:#fef3c7;padding:15px;border-radius:8px;margin-bottom:15px">Calculez le capital necessaire selon votre taux de retrait. Le revenu desire est ajuste automatiquement pour l'inflation (3% annuel).</p>
<div class="form-group">
  <label>Votre √¢ge actuel</label>
  <input type="number" id="age-actuel" value="" oninput="calcRetraite()">
</div>
<div class="form-group">
  <label>√Çge de retraite souhait√©</label>
  <input type="number" id="age-retraite-souhaite" value="" oninput="calcRetraite()">
</div>
<div class="form-group">
  <label>Taux de rendement annuel avant retraite (%)</label>
  <input type="number" id="taux-rendement-avant-retraite" value="5" step="0.5" min="0" max="12" oninput="calcRetraite()">
  <small style="display:block;margin-top:5px;color:#6b7280;">
    Ex: 3-4% conservateur, 5-6% √©quilibr√©, 7-8% croissance
  </small>
</div>
<div class="form-group">
  <label>Taux de rendement pendant la retraite (%)</label>
  <input type="number" id="taux-rendement-pendant-retraite" value="5" step="0.5" min="0" max="20" oninput="calcRetraite()">
  <small style="display:block;margin-top:5px;color:#6b7280;">
    Rendement pr√©vu sur vos placements une fois √† la retraite
  </small>
</div>
<div class="form-group">
  <label>Revenu de pension estim√© (RRQ + PSV)</label>
  <input type="number" id="pension-publique" value="0" oninput="calcRetraite()">
  <small style="display:block;margin-top:5px;color:#6b7280;">
    Estimation 2025 : RRQ max ~15 600$/an, PSV ~8 600$/an (si 65 ans+)
  </small>
</div>
<div class="form-group">
  <label>Rente de fonds de pension (employeur)</label>
  <input type="number" id="rente-pension" value="0" oninput="calcRetraite()">
  <small style="display:block;margin-top:5px;color:#6b7280;">
    Revenu annuel estim√© de votre r√©gime de retraite d'employeur (si applicable)
  </small>
</div>
<div class="form-group"><label>Revenu annuel desire (en dollars d'aujourd'hui)</label><input type="number" id="revenu-retraite" value="0" oninput="calcRetraite()"></div>
<div class="form-group">
  <label style="display:flex;align-items:center;gap:10px;">
    <input type="checkbox" id="contribution-actuelle-toggle" onchange="toggleContributionActuelle()" style="width:auto;">
    <span>üí° J'√©pargne d√©j√† pour ma retraite</span>
  </label>
</div>

<div id="contribution-actuelle-section" class="hidden" style="background:#f0f9ff;padding:15px;border-radius:8px;margin:10px 0;">
  <div class="form-group">
    <label>Contribution mensuelle actuelle ($)</label>
    <input type="number" id="contribution-mensuelle-actuelle" value="0" oninput="calcRetraite()">
    <small style="display:block;margin-top:5px;color:#6b7280;">
      Combien √©pargnez-vous actuellement par mois pour votre retraite ?
    </small>
  </div>
</div
<div class="form-group">
  <label style="display:flex;align-items:center;gap:10px;cursor:pointer;">
    <input type="checkbox" id="retrait-indexe" onchange="calcRetraite()" checked style="width:auto;">
    <span>Indexer les retraits √† l'inflation (3% annuel)</span>
  </label>
  <small style="display:block;margin-top:5px;color:#6b7280;">
    Si coch√©, vos retraits augmenteront de 3% par an pour maintenir votre pouvoir d'achat
  </small>
</div>
<div id="resultat-retraite"></div>
</div>
</div>

</div>

</div> <!-- Fin de tab-objectifs -->

<!-- Onglet Acheter vs Louer -->
<div id="tab-acheter-louer" class="tab-content">
  <h2 style="margin-top:0;padding-top:0;">üè† Acheter vs Louer</h2>
  
  <p style="background:#eff6ff;padding:15px;border-radius:8px;border-left:4px solid #2563eb;margin-bottom:20px;">
    Cet outil compare le <strong>co√ªt r√©el total</strong> d'acheter une maison versus continuer √† louer, 
    en tenant compte de TOUS les frais cach√©s et du co√ªt d'opportunit√©.
  </p>

  <!-- SECTION 1 : Sc√©nario ACHAT -->
  <div class="card">
    <h3 style="color:#2563eb;">üè° Sc√©nario ACHAT</h3>
    
    <div class="form-group">
      <label>Prix d'achat de la maison ($)</label>
      <input type="number" id="al-prix" value="0" min="0" onchange="calcAcheterLouer()">
    </div>
    
    <div class="form-group">
      <label>Mise de fonds (%)</label>
      <select id="al-mise-fonds-pct" onchange="calcAcheterLouer()">
        <option value="5">5%</option>
        <option value="10">10%</option>
        <option value="15">15%</option>
        <option value="20" selected>20%</option>
        <option value="25">25%</option>
      </select>
    </div>
    
    <div class="form-group">
      <label>Taux hypoth√©caire (%)</label>
      <input type="number" id="al-taux-hypo" value="5" min="0" max="15" step="0.1" onchange="calcAcheterLouer()">
    </div>
    
    <div class="form-group">
      <label>P√©riode d'amortissement (ann√©es)</label>
      <select id="al-amortissement" onchange="calcAcheterLouer()">
        <option value="25" selected>25 ans</option>
        <option value="30">30 ans</option>
      </select>
    </div>
    
    <h4 style="margin-top:20px;color:#374151;">Frais de propri√©t√©</h4>
    
    <div class="form-group">
      <label>Taxes municipales + scolaires ($/an)</label>
      <input type="number" id="al-taxes" value="0" min="0" onchange="calcAcheterLouer()">
      <small style="display:block;margin-top:5px;color:#6b7280;">
        G√©n√©ralement 1-1.5% de la valeur de la maison au Qu√©bec
      </small>
    </div>
    
    <div class="form-group">
      <label>Entretien annuel estim√© ($/an)</label>
      <input type="number" id="al-entretien" value="0" min="0" onchange="calcAcheterLouer()">
      <small style="display:block;margin-top:5px;color:#6b7280;">
        R√®gle g√©n√©rale : 1-2% de la valeur de la maison
      </small>
    </div>
    
    <div class="form-group">
      <label>Assurances habitation ($/an)</label>
      <input type="number" id="al-assurance" value="0" min="0" onchange="calcAcheterLouer()">
    </div>
  </div>

  <!-- SECTION 2 : Sc√©nario LOCATION -->
  <div class="card">
    <h3 style="color:#10b981;">üîë Sc√©nario LOCATION</h3>
    
    <div class="form-group">
      <label>Loyer mensuel actuel/alternatif ($)</label>
      <input type="number" id="al-loyer" value="0" min="0" onchange="calcAcheterLouer()">
    </div>
    
 <div class="form-group">
<label>Augmentation annuelle du loyer (%)</label>
<input type="number" id="al-augmentation-loyer" value="3" min="0" max="10" step="0.5" onchange="calcAcheterLouer()">
<small style="display:block;margin-top:5px;color:#6b7280;">
Historique Qu√©bec : 2-4% par an
</small>
</div>

<div class="form-group">
<label>D√©p√¥t de garantie (en mois de loyer)</label>
<input type="number" id="al-depot-garantie" value="0" min="0" max="3" step="0.5" onchange="calcAcheterLouer()">
<small style="display:block;margin-top:5px;color:#6b7280;">
‚ö†Ô∏è Au Qu√©bec : les d√©p√¥ts de garantie sont INTERDITS (laisser √† 0). Peut varier ailleurs.
</small>
</div>

<div class="form-group">
<label>Rendement investissement √©pargne (%)</label>

      <input type="number" id="al-rendement" value="6" min="0" max="15" step="0.5" onchange="calcAcheterLouer()">
      <small style="display:block;margin-top:5px;color:#6b7280;">
        Si tu loues, tu investis la diff√©rence (mise de fonds + √©cart paiements) dans un portefeuille
      </small>
    </div>
  </div>

  <!-- SECTION 3 : Param√®tres de comparaison -->
  <div class="card">
    <h3 style="color:#f59e0b;">‚öôÔ∏è Param√®tres de comparaison</h3>
    
    <div class="form-group">
      <label>Dur√©e de la comparaison (ann√©es)</label>
      <input type="number" id="al-duree" value="10" min="1" max="30" onchange="calcAcheterLouer()">
      <small style="display:block;margin-top:5px;color:#6b7280;">
        Combien d'ann√©es pr√©vois-tu rester dans ce logement ?
      </small>
    </div>
    
    <div class="form-group">
      <label>Appr√©ciation annuelle de la maison (%)</label>
      <input type="number" id="al-appreciation" value="3" min="0" max="10" step="0.5" onchange="calcAcheterLouer()">
      <small style="display:block;margin-top:5px;color:#6b7280;">
        Historique Qu√©bec : 3-5% par an (varie selon r√©gion)
      </small>
    </div>
    
    <div class="form-group">
      <label>Frais de vente estim√©s (%)</label>
      <input type="number" id="al-frais-vente" value="6" min="0" max="10" step="0.5" onchange="calcAcheterLouer()">
      <small style="display:block;margin-top:5px;color:#6b7280;">
        Commission agent immobilier + frais l√©gaux (g√©n√©ralement 5-7%)
      </small>
    </div>
    
    <button onclick="calcAcheterLouer()" style="background:#10b981;color:white;padding:12px 30px;border:none;border-radius:8px;cursor:pointer;margin-top:15px;font-weight:bold;">
      üìä Comparer les deux sc√©narios
    </button>
  </div>

  <!-- R√âSULTATS -->
  <div id="resultats-acheter-louer"></div>

  <!-- Note √©ducative -->
  <div style="background:#fef3c7;border-left:4px solid #f59e0b;padding:20px;border-radius:10px;margin-top:30px;">
    <strong style="color:#92400e;">üí° Points importants √† consid√©rer</strong>
    <ul style="margin:10px 0 0 20px;color:#78350f;line-height:1.8;">
      <li><strong>Flexibilit√© :</strong> La location offre plus de mobilit√© (d√©m√©nagement plus facile)</li>
      <li><strong>Pr√©visibilit√© :</strong> L'achat fixe votre paiement hypoth√©caire (mais taxes/entretien peuvent augmenter)</li>
      <li><strong>Discipline d'√©pargne :</strong> L'achat "force" l'√©pargne, la location n√©cessite discipline pour investir</li>
      <li><strong>Risque de march√© :</strong> La valeur immobili√®re peut baisser (rare mais possible)</li>
      <li><strong>Co√ªt d'opportunit√© :</strong> L'argent investi dans une maison ne rapporte pas d'int√©r√™ts compos√©s</li>
    </ul>
  </div>

  <!-- Disclaimer -->
  <div style="background:#f9fafb;border-top:2px solid #e5e7eb;padding:20px;margin-top:30px;border-radius:8px;">
    <p style="margin:0;font-size:0.85em;color:#6b7280;">
      ‚ö†Ô∏è <strong>Avertissement :</strong> Cet outil fournit une estimation comparative bas√©e sur les donn√©es que vous entrez. 
      Chaque situation est unique et d√©pend de facteurs personnels (stabilit√© emploi, plans familiaux, tol√©rance au risque). 
      Consultez un <strong>conseiller financier</strong> ou un <strong>planificateur hypoth√©caire</strong> avant toute d√©cision importante.
    </p>
  </div>
</div>

<div id="tab-dettes" class="tab-content">
   <h2>Calculateur de remboursement de dettes</h2>
  
  <p style="background:#fef3c7;padding:15px;border-radius:8px;margin-bottom:20px;">
    Comparez deux strat√©gies populaires : <strong>Avalanche</strong> (rembourse d'abord les taux √©lev√©s - √©conomise plus d'int√©r√™ts) 
    et <strong>Boule de neige</strong> (rembourse d'abord les petits soldes - motivation psychologique).
  </p>

  <div class="card">
    <h3>Vos dettes</h3>
    <div id="liste-dettes-container"></div>
    
    <button onclick="ajouterLigneDette()" style="background:#2563eb;color:white;padding:10px 20px;border:none;border-radius:8px;cursor:pointer;margin-top:15px;">
      ‚ûï Ajouter une dette
    </button>
  </div>

  <div class="card">
    <h3>Paiement mensuel suppl√©mentaire</h3>
    <div class="form-group">
      <label>Montant mensuel disponible (au-del√† des minimums)</label>
      <input type="number" id="paiement-extra" value="0" min="0" onchange="calculerStrategies()">
      <small style="display:block;margin-top:5px;color:#6b7280;">
        Combien pouvez-vous allouer mensuellement en plus des paiements minimums ?
      </small>
    </div>
    
    <button onclick="calculerStrategies()" style="background:#10b981;color:white;padding:12px 30px;border:none;border-radius:8px;cursor:pointer;margin-top:15px;font-weight:bold;">
      üìä Calculer les strat√©gies
    </button>
  </div>

  <div id="resultats-strategies"></div>
</div>
</div>

<!-- Onglet √Ä propos -->
<div id="tab-apropos" class="tab-content">
  <h2>√Ä propos</h2>

<div class="card" style="display:flex;align-items:center;gap:20px;flex-wrap:wrap;">
  <img src="Aziz Guellouz.jpg" alt="Photo de Aziz Guellouz" 
       style="width:180px;height:180px;object-fit:cover;border-radius:50%;border:4px solid #2563eb;">
  
  <div>
    <h3 style="color:#92400e;">Bienvenue</h3>
    <p style="margin-top:10px;">
      Je m'appelle <strong>Aziz Guellouz</strong> et je me passionne pour tout ce qui touche √† la 
      <strong>finance, la strat√©gie et l'accompagnement des entrepreneurs</strong>.
      <br><br>
      Depuis plusieurs ann√©es, j'√©volue au c≈ìur du d√©veloppement √©conomique de Montr√©al, o√π j'ai accompagn√© 
      de nombreuses entreprises √† structurer leurs projets, renforcer leur gestion financi√®re 
      et acc√©der aux bons leviers de financement.
      <br><br>
      Mon approche est simple : allier <strong>rigueur</strong>, <strong>clart√©</strong> et 
      <strong>impact concret</strong> pour aider les gens √† transformer leurs ambitions en r√©sultats durables.
    </p>
  </div>
</div>

  <div class="card" style="background:#eff6ff;">
    <h3 style="color:#1e3a8a;">Mes valeurs</h3>
    <ul style="margin-top:10px;line-height:1.8em;">
      <li><strong>Rigueur</strong> ‚Äì Parce qu'un bon conseil repose sur des faits solides.</li>
      <li><strong>Transparence</strong> ‚Äì Dire les choses telles qu'elles sont, avec respect et honn√™tet√©.</li>
      <li><strong>Impact local</strong> ‚Äì Contribuer concr√®tement √† la vitalit√© √©conomique de Montr√©al.</li>
      <li><strong>Innovation utile</strong> ‚Äì Cr√©er des outils simples qui font gagner du temps et de la clart√©.</li>
    </ul>
  </div>
  
</div>

<div class="warning-box" style="background:#fef2f2;border-left:6px solid #dc2626;padding:25px;border-radius:12px;margin-bottom:30px;overflow:hidden;">
  <strong style="color:#991b1b;font-size:1.1em;">‚ö†Ô∏è Avertissement important</strong>
  
 <p style="margin:10px 0 10px 0;padding:0;line-height:1.7;color:#7f1d1d;text-align:left;"><strong>Cet outil est √† des fins √©ducatives et informatives seulement.</strong> Les calculs, projections et suggestions pr√©sent√©s sont des estimations simplifi√©es bas√©es sur des principes financiers g√©n√©ralement reconnus. <strong>Ils ne constituent en aucun cas des conseils financiers, fiscaux ou juridiques personnalis√©s.</strong></p>

<p style="margin:10px 0 10px 0;padding:0;line-height:1.7;color:#7f1d1d;text-align:left;">Chaque situation financi√®re est unique. Avant de prendre toute d√©cision financi√®re importante, consultez un conseiller financier autoris√©, un fiscaliste ou un planificateur financier certifi√©.</p>
  
  </p>
  
  <div style="margin-top:15px;padding-top:15px;border-top:1px solid #fca5a5;">
    <strong style="color:#991b1b;">üìö Ressources officielles :</strong>
    <ul style="margin:10px 0 0 20px;line-height:2;color:#7f1d1d;list-style-position:outside;padding-left:0;">
      <li style="margin-bottom:8px;"><a href="https://www.retraitequebec.gouv.qc.ca/" target="_blank" style="color:#1e40af;text-decoration:underline;">Retraite Qu√©bec</a> - Informations sur le RRQ et la retraite</li>
      <li style="margin-bottom:8px;"><a href="https://lautorite.qc.ca/" target="_blank" style="color:#1e40af;text-decoration:underline;">Autorit√© des march√©s financiers (AMF)</a> - √âducation financi√®re et protection</li>
      <li style="margin-bottom:8px;"><a href="https://www.canada.ca/fr/services/prestations/pensionspubliques.html" target="_blank" style="color:#1e40af;text-decoration:underline;">Gouvernement du Canada</a> - Programmes de retraite publics</li>
    </ul>
  </div>
</div>


<!-- Onglet Gestion des plaisirs -->
<div id="tab-plaisirs" class="tab-content">
  <h2 style="margin-top:0;padding-top:0;">üéâ Gestion des plaisirs</h2>
  
  <p style="background:#eff6ff;padding:15px;border-radius:8px;border-left:4px solid #2563eb;margin-bottom:20px;">
    Se faire plaisir est <strong>essentiel</strong> pour une vie √©quilibr√©e. L'objectif n'est pas de tout couper, 
    mais de <strong>d√©penser consciemment</strong> selon TES priorit√©s.
  </p>

  <!-- SECTION 1 : Budget loisirs disponible -->
  <div class="card">
    <h3 style="color:#2563eb;">üí∞ Ton budget loisirs disponible</h3>
    
    <div class="form-group">
      <label>Revenu mensuel net ($)</label>
      <input type="number" id="plaisirs-revenu" value="0" min="0" onchange="calcPlaisirs()">
    </div>
    
    <div class="form-group">
      <label>D√©penses essentielles mensuelles (loyer, √©picerie, transport, etc.) ($)</label>
      <input type="number" id="plaisirs-essentielles" value="0" min="0" onchange="calcPlaisirs()">
      <small style="display:block;margin-top:5px;color:#6b7280;">
        Si vous avez rempli l'onglet Budget, utilisez votre "Total d√©penses" moins les loisirs
      </small>
    </div>
    
    <div class="form-group">
      <label>Objectif d'√©pargne mensuelle (%)</label>
      <input type="number" id="plaisirs-epargne-pct" value="20" min="0" max="50" onchange="calcPlaisirs()">
      <small style="display:block;margin-top:5px;color:#6b7280;">
        Recommandation g√©n√©rale : 20% du revenu
      </small>
    </div>
    
    <div id="budget-disponible"></div>
  </div>

  <!-- SECTION 2 : Abonnements mensuels -->
  <div class="card">
    <h3 style="color:#8b5cf6;">üì∫ Tes abonnements mensuels</h3>
    
    <div style="background:#fef3c7;padding:15px;border-radius:8px;margin-bottom:15px;">
      üí° <strong>Astuce :</strong> Pour chaque abonnement, note combien de fois tu l'utilises par mois. 
      Cela r√©v√®le les "petits" abonnements qui co√ªtent TR√àS cher √† l'utilisation.
    </div>
    
    <div id="liste-abonnements">
      <div class="form-group">
        <label>Netflix / Streaming vid√©o ($/mois)</label>
        <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;">
          <input type="number" id="abo-netflix" value="0" min="0" onchange="calcPlaisirs()" placeholder="Co√ªt">
          <input type="number" id="abo-netflix-freq" min="0" onchange="calcPlaisirs()" placeholder="Utilisations/mois">
          <div style="padding:10px;background:#f3f4f6;border-radius:6px;text-align:center;" id="abo-netflix-cout">-</div>
        </div>
      </div>
      
      <div class="form-group">
        <label>Spotify / Musique ($/mois)</label>
        <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;">
          <input type="number" id="abo-musique" min="0" onchange="calcPlaisirs()" placeholder="Co√ªt">
          <input type="number" id="abo-musique-freq" min="0" onchange="calcPlaisirs()" placeholder="Utilisations/mois">
          <div style="padding:10px;background:#f3f4f6;border-radius:6px;text-align:center;" id="abo-musique-cout">-</div>
        </div>
      </div>
      
      <div class="form-group">
        <label>Gym / Sport ($/mois)</label>
        <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;">
          <input type="number" id="abo-gym" min="0" onchange="calcPlaisirs()" placeholder="Co√ªt">
          <input type="number" id="abo-gym-freq" min="0" onchange="calcPlaisirs()" placeholder="Visites/mois">
          <div style="padding:10px;background:#f3f4f6;border-radius:6px;text-align:center;" id="abo-gym-cout">-</div>
        </div>
      </div>
      
      <div class="form-group">
        <label>Jeux vid√©o (Xbox Live, PS+, etc.) ($/mois)</label>
        <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;">
          <input type="number" id="abo-jeux" min="0" onchange="calcPlaisirs()" placeholder="Co√ªt">
          <input type="number" id="abo-jeux-freq" min="0" onchange="calcPlaisirs()" placeholder="Utilisations/mois">
          <div style="padding:10px;background:#f3f4f6;border-radius:6px;text-align:center;" id="abo-jeux-cout">-</div>
        </div>
      </div>
      
      <div class="form-group">
        <label>Caf√© quotidien / Caf√© resto ($/mois)</label>
        <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;">
          <input type="number" id="abo-cafe" min="0" onchange="calcPlaisirs()" placeholder="Co√ªt">
          <input type="number" id="abo-cafe-freq" min="0" onchange="calcPlaisirs()" placeholder="Fois/mois">
          <div style="padding:10px;background:#f3f4f6;border-radius:6px;text-align:center;" id="abo-cafe-cout">-</div>
        </div>
      </div>
      
      <div class="form-group">
        <label>Autre abonnement ($/mois)</label>
        <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;">
          <input type="number" id="abo-autre" min="0" onchange="calcPlaisirs()" placeholder="Co√ªt">
          <input type="number" id="abo-autre-freq" min="0" onchange="calcPlaisirs()" placeholder="Utilisations/mois">
          <div style="padding:10px;background:#f3f4f6;border-radius:6px;text-align:center;" id="abo-autre-cout">-</div>
        </div>
      </div>
    </div>
    
    <div class="total-row purple">
      <span>Total abonnements mensuels</span>
      <span class="value" id="total-abonnements">0 $</span>
    </div>
    
    <div style="margin-top:10px;padding:10px;background:#f3f4f6;border-radius:6px;">
      <strong>Sur un an :</strong> <span id="total-abonnements-an">0 $</span>
    </div>
  </div>

  <!-- SECTION 3 : D√©penses variables -->
  <div class="card">
    <h3 style="color:#10b981;">üçΩÔ∏è D√©penses variables mensuelles</h3>
    
    <div class="form-group">
      <label>Restaurants / Livraison ($/mois)</label>
      <input type="number" id="var-resto" value="0" min="0" onchange="calcPlaisirs()">
    </div>
    
    <div class="form-group">
      <label>Bars / Sorties ($/mois)</label>
      <input type="number" id="var-bars" value="0" min="0" onchange="calcPlaisirs()">
    </div>
    
    <div class="form-group">
      <label>Cin√©ma / Spectacles ($/mois)</label>
      <input type="number" id="var-spectacles" value="0" min="0" onchange="calcPlaisirs()">
    </div>
    
    <div class="form-group">
      <label>Shopping non-essentiel ($/mois)</label>
      <input type="number" id="var-shopping" value="0" min="0" onchange="calcPlaisirs()">
      <small style="display:block;margin-top:5px;color:#6b7280;">
        V√™tements de luxe, gadgets, d√©co, etc.
      </small>
    </div>
    
    <div class="form-group">
      <label>Passe-temps / Hobbies ($/mois)</label>
      <input type="number" id="var-hobbies" value="0" min="0" onchange="calcPlaisirs()">
    </div>
    
    <div class="form-group">
      <label>Autres d√©penses plaisirs ($/mois)</label>
      <input type="number" id="var-autres" value="0" min="0" onchange="calcPlaisirs()">
    </div>
    
    <div class="total-row green">
      <span>Total variables</span>
      <span class="value" id="total-variables">0 $</span>
    </div>
  </div>

  <!-- SECTION 4 : Budget vacances/projets -->
  <div class="card">
    <h3 style="color:#f59e0b;">‚úàÔ∏è Budget vacances / Projet plaisir</h3>
    
    <div class="form-group">
      <label>Nom du projet</label>
      <input type="text" id="projet-nom" value="Voyage" onchange="calcPlaisirs()">
    </div>
    
    <div class="form-group">
      <label>Co√ªt estim√© du projet ($)</label>
      <input type="number" id="projet-cout" value="0" min="0" onchange="calcPlaisirs()">
    </div>
    
    <div class="form-group">
      <label>Dans combien de mois ?</label>
      <input type="number" id="projet-mois" value="12" min="1" onchange="calcPlaisirs()">
    </div>
    
    <div id="resultat-projet"></div>
  </div>

  <!-- R√âSULTATS GLOBAUX -->
  <div id="resultats-plaisirs"></div>

</div>

<!-- Onglet : En as-tu vraiment besoin ? -->
<div id="tab-besoin" class="tab-content">

  <h2>ü§î En as-tu vraiment besoin ?</h2>
  
  <p style="background:#eff6ff;padding:15px;border-radius:8px;border-left:4px solid #2563eb;margin-bottom:20px;">
    Ce calculateur s'inspire de principes de finances personnelles, notamment ceux popularis√©s par 
    Pierre-Yves McSween dans <em>"En as-tu vraiment besoin ?"</em>. 
    <strong>Cet outil est une cr√©ation ind√©pendante non affili√©e √† l'auteur.</strong> 
    Il t'aide √† prendre une d√©cision √©clair√©e avant un achat et √† √©viter les achats impulsifs.
  </p>

  <div class="card">
    <h3>üí∞ Informations sur l'achat</h3>
    
    <div class="form-group">
      <label>Prix de l'article ($)</label>
      <input type="number" id="prix-article" value="0" oninput="calcBesoin()">
    </div>

    <div class="form-group">
      <label>Ton salaire horaire NET (apr√®s imp√¥ts, $)</label>
      <input type="number" id="salaire-horaire" value="25" step="0.5" oninput="calcBesoin()">
      <small style="display:block;margin-top:5px;color:#6b7280;">
        Ex: Si tu gagnes 50 000$/an net, c'est environ 25$/h (50000 √∑ 2000h)
      </small>
    </div>

    <div class="form-group">
      <label>Dur√©e de vie estim√©e (ann√©es)</label>
      <input type="number" id="duree-vie" value="5" min="0.5" step="0.5" oninput="calcBesoin()">
      <small style="display:block;margin-top:5px;color:#6b7280;">
        Ex: T√©l√©phone = 3 ans, Voiture = 10 ans, V√™tements = 2 ans
      </small>
    </div>
  </div>

<div class="card" id="questions-reflexion">
  <h3>‚ùì Questions de r√©flexion</h3>
  <p style="background:#fef3c7;padding:12px;border-radius:6px;font-size:0.9em;margin-bottom:15px;">
    <strong>üìå R√®gle McSween :</strong> Pour un achat ‚â• 50$, attends 30 jours avant d'acheter. Si tu y penses encore apr√®s, c'est probablement un bon achat !
  </p>
    
    <div style="margin-bottom:15px;">
      <label style="display:flex;align-items:center;gap:10px;cursor:pointer;">
        <input type="checkbox" id="q1-besoin" onchange="calcBesoin()">
        <span>Est-ce un besoin VITAL et au prix le plus raisonnable ? (√©picerie de base, loyer, m√©dicaments, transport n√©cessaire au travail)</span>
      </label>
    </div>

    <div style="margin-bottom:15px;">
      <label style="display:flex;align-items:center;gap:10px;cursor:pointer;">
        <input type="checkbox" id="q2-remplace" onchange="calcBesoin()">
        <span>Remplace-t-il quelque chose de bris√© ou us√© ?</span>
      </label>
    </div>

    <div style="margin-bottom:15px;">
      <label style="display:flex;align-items:center;gap:10px;cursor:pointer;">
        <input type="checkbox" id="q3-utilise" onchange="calcBesoin()">
        <span>Vas-tu l'utiliser au moins une fois par semaine ?</span>
      </label>
    </div>

    <div style="margin-bottom:15px;">
      <label style="display:flex;align-items:center;gap:10px;cursor:pointer;">
        <input type="checkbox" id="q4-budget" onchange="calcBesoin()">
        <span>As-tu le budget sans t'endetter ni toucher √† ton √©pargne ?</span>
      </label>
    </div>

    <div style="margin-bottom:15px;">
      <label style="display:flex;align-items:center;gap:10px;cursor:pointer;">
        <input type="checkbox" id="q5-attente" onchange="calcBesoin()">
        <span>Y penses-tu depuis plus de 30 jours ?</span>
      </label>
    </div>

    <div style="margin-bottom:15px;">
      <label style="display:flex;align-items:center;gap:10px;cursor:pointer;">
        <input type="checkbox" id="q6-alternative" onchange="calcBesoin()">
        <span>As-tu consid√©r√© des alternatives (usag√©, location, emprunt) ?</span>
      </label>
    </div>
  </div>

  <!-- R√©sultats -->
  <div id="resultat-besoin"></div>

</div>








<!-- Onglet : Aide √† la d√©cision -->
<div id="tab-aide" class="tab-content">

  <h2>üí° Aide √† la d√©cision : CELI ou REER ?</h2>

  <p>Voici un aper√ßu comparatif des deux principaux r√©gimes d'√©pargne au Canada.</p>

  <table style="width:100%;border-collapse:collapse;margin-top:18px;font-size:0.95rem;">
    <thead style="background:#f9fafb;">
      <tr>
        <th style="text-align:left;padding:10px;border-bottom:1px solid #e5e7eb;">Aspect</th>
        <th style="text-align:left;padding:10px;border-bottom:1px solid #e5e7eb;">CELI</th>
        <th style="text-align:left;padding:10px;border-bottom:1px solid #e5e7eb;">REER</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td style="padding:10px;border-bottom:1px solid #e5e7eb;">Objectif</td>
        <td style="padding:10px;border-bottom:1px solid #e5e7eb;">Croissance libre d'imp√¥t ‚Äî id√©al pour flexibilit√© et retraits √† court ou moyen terme.</td>
        <td style="padding:10px;border-bottom:1px solid #e5e7eb;">Report d'imp√¥t ‚Äî avantageux si votre taux d'imposition est plus bas √† la retraite.</td>
      </tr>
      <tr>
        <td style="padding:10px;border-bottom:1px solid #e5e7eb;">Retraits</td>
        <td style="padding:10px;border-bottom:1px solid #e5e7eb;">Non imposables et sans impact fiscal.</td>
        <td style="padding:10px;border-bottom:1px solid #e5e7eb;">Imposables selon votre taux au moment du retrait.</td>
      </tr>
      <tr>
        <td style="padding:10px;border-bottom:1px solid #e5e7eb;">Cotisations</td>
        <td style="padding:10px;border-bottom:1px solid #e5e7eb;">Non d√©ductibles, mais rendement non imposable.</td>
        <td style="padding:10px;border-bottom:1px solid #e5e7eb;">D√©ductibles du revenu imposable, r√©duisent l'imp√¥t pay√© cette ann√©e.</td>
      </tr>
      <tr>
        <td style="padding:10px;border-bottom:1px solid #e5e7eb;">Plafond annuel (2025)</td>
        <td style="padding:10px;border-bottom:1px solid #e5e7eb;">7 000 $ (droits cumulatifs si non utilis√©s).</td>
        <td style="padding:10px;border-bottom:1px solid #e5e7eb;">18 % du revenu gagn√©, jusqu'√† un maximum de 31 560 $.</td>
      </tr>
    </tbody>
  </table>

  <p style="margin-top:20px;">
    üí¨ <strong>Astuce :</strong> Comparez votre taux d'imposition actuel et celui anticip√© √† la retraite.
    Si votre taux futur est plus √©lev√©, le CELI peut √™tre avantageux ; s'il est plus bas, le REER peut
    offrir un meilleur report d'imp√¥t.  
    Ces informations visent √† <strong>√©clairer</strong> votre r√©flexion, pas √† d√©terminer un choix.
  </p>

  <!-- S√©parateur -->
  <hr style="margin:50px 0;border:none;border-top:2px solid #e5e7eb;">

  <!-- Section Budget mensuel -->
  <h2>üí∞ G√©rer son budget mensuel</h2>
  <p>Un budget, c'est avant tout un outil de libert√© : il permet de choisir o√π va votre argent, plut√¥t que de le subir. Voici quelques principes simples pour mieux g√©rer vos finances mensuelles.</p>

  <div class="card" style="margin-top:20px;">
    <h3>1Ô∏è‚É£ R√®gle 50 / 30 / 20</h3>
    <p>Une m√©thode simple pour r√©partir vos revenus :</p>
    <ul style="margin-left:20px;line-height:1.8;">
      <li><strong>50 %</strong> : besoins essentiels (logement, nourriture, transport, assurances)</li>
      <li><strong>30 %</strong> : d√©penses personnelles (loisirs, abonnements, sorties)</li>
      <li><strong>20 %</strong> : √©pargne et remboursement de dettes</li>
    </ul>
    <p>üìä Cette approche aide √† √©quilibrer vos priorit√©s sans suivre un budget rigide au dollar pr√®s.</p>
  </div>

  <div class="card" style="margin-top:20px;">
    <h3>2Ô∏è‚É£ Suivre ses d√©penses</h3>
    <p>Avant d'ajuster, il faut observer. Listez vos d√©penses pendant 1 √† 3 mois et classez-les par cat√©gorie :</p>
    <ul style="margin-left:20px;line-height:1.8;">
      <li>Logement</li>
      <li>Alimentation</li>
      <li>Transport</li>
      <li>Loisirs</li>
      <li>Dettes</li>
      <li>√âpargne</li>
    </ul>
    <p>üí° <strong>Astuce :</strong> Un simple tableau Excel, Google Sheets ou une appli comme <em>Moka</em>, <em>YNAB</em> ou <em>Spendee</em> suffit.</p>
  </div>

  <div class="card" style="margin-top:20px;">
    <h3>3Ô∏è‚É£ Prioriser les paiements essentiels</h3>
    <p>Le budget n'est pas qu'un tableau : c'est un plan d'action. Classez vos paiements selon leur importance :</p>
    <ol style="margin-left:20px;line-height:1.8;">
      <li>Logement et factures fixes</li>
      <li>Nourriture et transport</li>
      <li>Dettes √† taux √©lev√© (cartes de cr√©dit, marges)</li>
      <li>√âpargne de s√©curit√© (3 mois de d√©penses)</li>
      <li>Investissements et projets</li>
    </ol>
  </div>

  <div class="card" style="margin-top:20px;">
    <h3>4Ô∏è‚É£ Cr√©er une marge de s√©curit√©</h3>
    <p>Un bon budget inclut toujours l'impr√©vu. R√©servez chaque mois une petite somme (100 √† 200 $) dans un compte distinct pour les urgences.</p>
    <p>üí° Cela √©vite d'avoir recours au cr√©dit √† chaque d√©pense inattendue.</p>
  </div>

  <div class="card" style="margin-top:20px;">
    <h3>5Ô∏è‚É£ Automatiser les virements</h3>
    <p>Simplifiez votre gestion en programmant vos paiements et virements automatiques juste apr√®s la paie :</p>
    <ul style="margin-left:20px;line-height:1.8;">
      <li>Priorisez l'√©pargne et le remboursement de dettes</li>
      <li>Puis les d√©penses fixes et variables</li>
    </ul>
    <p>üí° Moins de stress, moins d'oublis, et une discipline financi√®re sans effort.</p>
  </div>

  <div class="card" style="margin-top:20px;">
    <h3>6Ô∏è‚É£ Ajuster au fil des mois</h3>
    <p>Un budget efficace √©volue avec vous. Chaque trimestre :</p>
    <ul style="margin-left:20px;line-height:1.8;">
      <li>Comparez vos d√©penses pr√©vues et r√©elles</li>
      <li>R√©√©valuez vos priorit√©s</li>
      <li>Adaptez vos objectifs d'√©pargne</li>
    </ul>
    <p>üìà Le but n'est pas la perfection, mais la constance.</p>
  </div>

  <!-- Avertissement final -->
  <div style="
    background:#fff8e1;
    border:1px solid #fcd34d;
    border-left:6px solid #f59e0b;
    padding:18px 22px;
    border-radius:10px;
    margin-top:40px;
    color:#78350f;
    line-height:1.5;
  ">
    ‚ö†Ô∏è <strong>Avertissement :</strong> Les informations pr√©sent√©es sur cette page sont fournies √† titre informatif seulement.
    Elles visent √† soutenir la prise de d√©cision financi√®re, sans constituer des recommandations personnalis√©es.
    Chaque situation est unique ‚Äî consultez un professionnel (planificateur financier ou conseiller budg√©taire) pour un accompagnement adapt√©.
  </div>

</div>

<!-- Onglet Finances de couple -->
<div id="tab-couple" class="tab-content">
  <h2 style="margin-top:0;padding-top:0;">üíë Finances de couple</h2>
  
  <p style="background:#eff6ff;padding:15px;border-radius:8px;border-left:4px solid #2563eb;margin-bottom:20px;">
    Cet outil vous aide √† √©tablir une <strong>r√©partition √©quitable</strong> des d√©penses communes 
    bas√©e sur la <strong>capacit√© r√©elle</strong> de chacun, pas seulement sur le revenu.
  </p>

  <!-- SECTION 1 : PERSONNE A -->
  <div class="card">
    <h3 style="color:#2563eb;">üë§ Profil financier - Personne A</h3>
    
    <div class="form-group">
      <label>Revenu net mensuel ($)</label>
      <input type="number" id="couple-revenu-a" value="0" onchange="calcCouple()">
    </div>
    
    <h4 style="margin-top:20px;color:#374151;">Dettes et obligations personnelles</h4>
    
    <!-- Disclaimer confidentialit√© -->
    <div style="background:#fff8e1;border-left:4px solid #f59e0b;padding:15px;border-radius:8px;margin:15px 0;">
   <strong style="color:#92400e;">üîí Confidentialit√© et consentement</strong><p style="margin:8px 0 0 0;color:#78350f;font-size:0.9em;line-height:1.6;">
        Partagez vos informations financi√®res <strong>seulement si vous √™tes confortable</strong> de le faire. 
        Aucune information saisie ici n'est sauvegard√©e ou partag√©e - tout reste dans votre navigateur.
        <br>
        üí° Une relation saine repose sur la <strong>transparence volontaire</strong>, pas sur l'obligation ou la surveillance.
      </p>
    </div>
    
    <div class="form-group">
      <label>Cartes de cr√©dit - Paiement mensuel minimum ($)</label>
      <input type="number" id="couple-cc-a" value="0" min="0" onchange="calcCouple()">
    </div>
    
    <div class="form-group">
      <label>Pr√™t √©tudiant - Paiement mensuel ($)</label>
      <input type="number" id="couple-pret-etude-a" value="0" min="0" onchange="calcCouple()">
    </div>
    
    <div class="form-group">
      <label>Pr√™t automobile personnel - Paiement mensuel ($)</label>
      <input type="number" id="couple-auto-a" value="0" min="0" onchange="calcCouple()">
    </div>
    
    <div class="form-group">
      <label>Autres dettes personnelles - Paiement mensuel ($)</label>
      <input type="number" id="couple-autres-dettes-a" value="0" min="0" onchange="calcCouple()">
    </div>
    
    <h4 style="margin-top:20px;color:#374151;">D√©penses personnelles fixes</h4>
    
    <div class="form-group">
      <label>Assurances personnelles (vie, invalidit√©, etc.)</label>
      <input type="number" id="couple-assurance-a" value="0" min="0" onchange="calcCouple()">
    </div>
    
    <div class="form-group">
      <label>Abonnements/t√©l√©phone personnel ($)</label>
      <input type="number" id="couple-abonnements-a" value="0" min="0" onchange="calcCouple()">
    </div>
    
    <div class="form-group">
      <label>Pension alimentaire / autres obligations ($)</label>
      <input type="number" id="couple-pension-a" value="0" min="0" onchange="calcCouple()">
    </div>
    
    <h4 style="margin-top:20px;color:#374151;">√âpargne actuelle</h4>
    
    <div class="form-group">
      <label>Fonds d'urgence / √©pargne disponible ($)</label>
      <input type="number" id="couple-epargne-a" value="0" onchange="calcCouple()">
    </div>
    
    <div id="diagnostic-a"></div>
  </div>

  <!-- SECTION 2 : PERSONNE B -->
  <div class="card">
    <h3 style="color:#8b5cf6;">üë§ Profil financier - Personne B</h3>
    
    <div class="form-group">
      <label>Revenu net mensuel ($)</label>
      <input type="number" id="couple-revenu-b" value="0" min="0" onchange="calcCouple()">
    </div>
    
    <h4 style="margin-top:20px;color:#374151;">Dettes et obligations personnelles</h4>
    
    <div class="form-group">
      <label>Cartes de cr√©dit - Paiement mensuel minimum ($)</label>
      <input type="number" id="couple-cc-b" value="0" min="0" onchange="calcCouple()">
    </div>
    
    <div class="form-group">
      <label>Pr√™t √©tudiant - Paiement mensuel ($)</label>
      <input type="number" id="couple-pret-etude-b" value="0" min="0" onchange="calcCouple()">
    </div>
    
    <div class="form-group">
      <label>Pr√™t automobile personnel - Paiement mensuel ($)</label>
      <input type="number" id="couple-auto-b" value="0" min="0" onchange="calcCouple()">
    </div>
    
    <div class="form-group">
      <label>Autres dettes personnelles - Paiement mensuel ($)</label>
      <input type="number" id="couple-autres-dettes-b" value="0" min="0" onchange="calcCouple()">
    </div>
    
    <h4 style="margin-top:20px;color:#374151;">D√©penses personnelles fixes</h4>
    
    <div class="form-group">
      <label>Assurances personnelles (vie, invalidit√©, etc.)</label>
      <input type="number" id="couple-assurance-b" value="0" min="0" onchange="calcCouple()">
    </div>
    
    <div class="form-group">
      <label>Abonnements/t√©l√©phone personnel ($)</label>
      <input type="number" id="couple-abonnements-b" value="0" min="0" onchange="calcCouple()">
    </div>
    
    <div class="form-group">
      <label>Pension alimentaire / autres obligations ($)</label>
      <input type="number" id="couple-pension-b" value="0" min="0" onchange="calcCouple()">
    </div>
    
    <h4 style="margin-top:20px;color:#374151;">√âpargne actuelle</h4>
    
    <div class="form-group">
      <label>Fonds d'urgence / √©pargne disponible ($)</label>
      <input type="number" id="couple-epargne-b" value="0" min="0" onchange="calcCouple()">
    </div>
    
    <div id="diagnostic-b"></div>
  </div>

  <!-- SECTION 3 : D√âPENSES COMMUNES -->
  <div class="card">
    <h3 style="color:#10b981;">üè† D√©penses communes mensuelles</h3>
    
    <div class="form-group">
      <label>Loyer / Hypoth√®que ($)</label>
      <input type="number" id="couple-loyer" value="0" min="0" onchange="calcCouple()">
    </div>
    
    <div class="form-group">
      <label>√âpicerie ($)</label>
      <input type="number" id="couple-epicerie" value="0" min="0" onchange="calcCouple()">
    </div>
    
    <div class="form-group">
      <label>Services publics (√©lectricit√©, internet, etc.) ($)</label>
      <input type="number" id="couple-services" value="0" min="0" onchange="calcCouple()">
    </div>
    
    <div class="form-group">
      <label>Transport commun / Essence partag√©e ($)</label>
      <input type="number" id="couple-transport" value="0" min="0" onchange="calcCouple()">
    </div>
    
    <div class="form-group">
      <label>Loisirs / Sorties en couple ($)</label>
      <input type="number" id="couple-loisirs" value="0" min="0" onchange="calcCouple()">
    </div>
    
    <div class="form-group">
      <label>Autres d√©penses communes ($)</label>
      <input type="number" id="couple-autres" value="0" min="0" onchange="calcCouple()">
    </div>
    
    <div class="total-row green">
      <span>Total d√©penses communes</span>
      <span class="value" id="couple-total-depenses">0 $</span>
    </div>
  </div>

  <!-- SECTION 4 : OBJECTIF D'√âPARGNE -->
  <div class="card">
    <h3 style="color:#f59e0b;">üéØ Objectif d'√©pargne</h3>
    
    <div class="form-group">
      <label>Taux d'√©pargne cible pour chacun (%)</label>
      <input type="number" id="couple-taux-epargne" value="20" min="0" max="50" onchange="calcCouple()">
      <small style="display:block;margin-top:5px;color:#6b7280;">
        Recommandation g√©n√©rale : 20% du revenu disponible
      </small>
    </div>
    
    <button onclick="calcCouple()" style="background:#10b981;color:white;padding:12px 30px;border:none;border-radius:8px;cursor:pointer;margin-top:15px;font-weight:bold;">
      üìä Calculer la r√©partition √©quitable
    </button>
  </div>

  <!-- R√âSULTATS -->
  <div id="resultats-couple"></div>

  <!-- DISCLAIMER PRINCIPAL -->
  <div style="background:#fef2f2;border-left:6px solid #dc2626;padding:25px;border-radius:12px;margin-bottom:30px;">
    <strong style="color:#991b1b;font-size:1.1em;">‚ö†Ô∏è Avertissement important</strong>
    
    <p style="margin:10px 0;line-height:1.7;color:#7f1d1d;">
      Cet outil est √† des fins <strong>√©ducatives et de r√©flexion</strong> seulement. 
      Les calculs et suggestions pr√©sent√©s sont des <strong>estimations g√©n√©rales</strong> 
      qui ne tiennent pas compte de toutes les nuances de votre situation.
    </p>
    
    <p style="margin:10px 0;line-height:1.7;color:#7f1d1d;">
      <strong>Chaque couple est unique.</strong> Les dynamiques financi√®res d√©pendent 
      de facteurs √©motionnels, historiques et relationnels que cet outil ne peut pas mesurer.
    </p>
    
    <div style="background:#fee2e2;padding:15px;border-radius:8px;margin-top:15px;">
      <strong style="color:#991b1b;">üö® Situations √† risque :</strong>
      <ul style="margin:10px 0 0 20px;line-height:1.8;color:#7f1d1d;">
        <li>Si vous sentez de la <strong>pression, manipulation ou contr√¥le</strong> dans vos d√©cisions financi√®res</li>
        <li>Si votre partenaire refuse la <strong>transparence</strong> ou cache des informations financi√®res</li>
        <li>Si vous √™tes dans une situation de <strong>d√©pendance financi√®re</strong> ou de vuln√©rabilit√©</li>
      </ul>
      <p style="margin:10px 0 0 0;font-weight:600;color:#991b1b;">
        ‚Üí Consultez un professionnel (conseiller conjugal, travailleur social, ou SOS Violence conjugale : 1-800-363-9010)
      </p>
    </div>
    
    <p style="margin:15px 0 0 0;padding-top:15px;border-top:1px solid #fca5a5;">
      <strong style="color:#991b1b;">Avant toute d√©cision :</strong><br>
      <span style="color:#7f1d1d;">
        Il est recommand√© de consulter un <strong>planificateur financier</strong>, 
        un <strong>conseiller conjugal</strong> ou un <strong>m√©diateur familial</strong> 
        pour √©tablir une entente qui respecte vos besoins et limites.
      </span>
    </p>
  </div>


  <!-- RESSOURCES EN BAS -->
  <div style="background:#f9fafb;border-top:2px solid #e5e7eb;padding:20px;margin-top:40px;border-radius:8px;">
    <h4 style="color:#374151;margin:0 0 10px 0;">üìö Ressources utiles</h4>
    
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:15px;">
      <div>
        <strong style="color:#1f2937;">M√©diation familiale :</strong>
        <br><a href="https://www.justice.gouv.qc.ca/couples-et-familles/separation-et-divorce/mediation-familiale/" 
           target="_blank" style="color:#2563eb;">
          Service de m√©diation familiale du Qu√©bec
        </a>
      </div>
      
      <div>
        <strong style="color:#1f2937;">Aide financi√®re :</strong>
        <br><a href="https://www.acef-est.org/" target="_blank" style="color:#2563eb;">
          ACEF (Associations coop√©ratives d'√©conomie familiale)
        </a>
      </div>
      
      <div>
        <strong style="color:#1f2937;">Violence conjugale :</strong>
        <br><a href="https://sosviolenceconjugale.ca/" target="_blank" style="color:#2563eb;">
          SOS Violence conjugale : 1-800-363-9010
        </a>
      </div>
      
      <div>
        <strong style="color:#1f2937;">Conseils financiers :</strong>
        <br><a href="https://lautorite.qc.ca/" target="_blank" style="color:#2563eb;">
          Autorit√© des march√©s financiers (AMF)
        </a>
      </div>
    </div>
    
    <p style="margin:15px 0 0 0;font-size:0.85em;color:#6b7280;">
      Cet outil ne constitue pas un avis juridique, financier ou conjugal. 
      Toute d√©cision financi√®re importante devrait √™tre prise apr√®s consultation 
      avec des professionnels qualifi√©s.
    </p>
  </div>
</div>

<div id="tab-confidentialite" class="tab-content">
  <h2>Politique de confidentialit√©</h2>
  
  <div class="card">
    <p style="margin-bottom:20px;"><em>Derni√®re mise √† jour : Octobre 2025</em></p>
    
    <h3 style="color:#2563eb;margin-top:0;">Notre engagement</h3>
    <p style="line-height:1.7;">
      Finance Personnelle Pro respecte votre vie priv√©e. Cette politique explique quelles donn√©es sont collect√©es 
      lorsque vous utilisez notre site et comment elles sont utilis√©es.
    </p>
    
    <h3 style="color:#2563eb;margin-top:30px;">üíæ Vos donn√©es financi√®res</h3>
    <div style="background:#d1fae5;padding:15px;border-radius:8px;border-left:4px solid #10b981;margin:15px 0;">
      <p style="margin:0;font-weight:600;color:#065f46;">
        ‚úÖ AUCUNE de vos donn√©es financi√®res personnelles (revenus, dettes, actifs, etc.) n'est envoy√©e √† nos serveurs ou stock√©e en ligne.
      </p>
    </div>
    <p style="line-height:1.7;">
      Toutes les donn√©es que vous entrez dans les calculateurs restent <strong>localement dans votre navigateur</strong>. 
      Nous n'avons aucun acc√®s √† ces informations sensibles.
    </p>
    
    <h3 style="color:#2563eb;margin-top:30px;">üìä Google Analytics</h3>
    <p style="line-height:1.7;">
      Nous utilisons Google Analytics pour comprendre comment les visiteurs utilisent notre site et l'am√©liorer. 
      Les donn√©es collect√©es incluent :
    </p>
    <ul style="line-height:1.8;margin-left:20px;">
      <li>Pages visit√©es et dur√©e de visite</li>
      <li>Localisation g√©ographique approximative (ville/r√©gion)</li>
      <li>Type d'appareil et navigateur utilis√©</li>
      <li>Adresse IP (anonymis√©e)</li>
    </ul>
    <p style="line-height:1.7;">
      Ces donn√©es sont <strong>anonymes</strong> et ne permettent pas de vous identifier personnellement.
    </p>
    
    <h3 style="color:#2563eb;margin-top:30px;">üéØ Publicit√© (Google AdSense)</h3>
    <p style="line-height:1.7;">
      Nous utilisons Google AdSense pour afficher des publicit√©s qui financent ce site gratuit. 
      Google et ses partenaires publicitaires utilisent des cookies pour :
    </p>
    <ul style="line-height:1.8;margin-left:20px;">
      <li>Personnaliser les publicit√©s selon vos centres d'int√©r√™t</li>
      <li>Mesurer l'efficacit√© des publicit√©s</li>
      <li>Limiter le nombre de fois qu'une publicit√© vous est montr√©e</li>
    </ul>
    <p style="line-height:1.7;">
      Vous pouvez g√©rer vos pr√©f√©rences publicitaires sur 
      <a href="https://adssettings.google.com" target="_blank" style="color:#2563eb;">Google Ads Settings</a>.
    </p>
    
    <h3 style="color:#2563eb;margin-top:30px;">üç™ Cookies</h3>
    <p style="line-height:1.7;">
      Notre site utilise des cookies pour Google Analytics et AdSense. Vous pouvez bloquer ou supprimer les cookies 
      via les param√®tres de votre navigateur. Cela n'affectera pas le fonctionnement des calculateurs.
    </p>
    
    <h3 style="color:#2563eb;margin-top:30px;">üîí S√©curit√©</h3>
    <p style="line-height:1.7;">
      Comme nous ne collectons ni ne stockons vos donn√©es financi√®res personnelles, il n'y a aucun risque de fuite 
      de ces informations sensibles depuis notre site.
    </p>
    
    <h3 style="color:#2563eb;margin-top:30px;">‚öñÔ∏è Vos droits</h3>
    <p style="line-height:1.7;">
      Conform√©ment aux lois canadiennes (LPRPDE) et europ√©ennes (RGPD), vous avez le droit de :
    </p>
    <ul style="line-height:1.8;margin-left:20px;">
      <li>Refuser les cookies (via les param√®tres de votre navigateur)</li>
      <li>Demander l'acc√®s aux donn√©es que nous d√©tenons (Analytics anonyme uniquement)</li>
      <li>Utiliser notre site sans accepter les cookies publicitaires</li>
    </ul>
    
    <h3 style="color:#2563eb;margin-top:30px;">üìß Contact</h3>
    <p style="line-height:1.7;">
      Pour toute question concernant cette politique de confidentialit√©, vous pouvez nous contacter √† : 
      <a href="mailto:azizguellouz@gmail.com" style="color:#2563eb;">azizguellouz@gmail.com</a>
    </p>
    
    <h3 style="color:#2563eb;margin-top:30px;">üîÑ Modifications</h3>
    <p style="line-height:1.7;">
      Nous pouvons mettre √† jour cette politique de confidentialit√© occasionnellement. 
      La date de derni√®re mise √† jour est indiqu√©e en haut de cette page.
    </p>
  </div>
  
  <div class="card" style="background:#eff6ff;margin-top:20px;">
    <h3 style="color:#1e40af;margin-top:0;">üìö Ressources utiles</h3>
    <ul style="line-height:2;">
      <li><a href="https://policies.google.com/privacy" target="_blank" style="color:#2563eb;">Politique de confidentialit√© de Google</a></li>
      <li><a href="https://www.priv.gc.ca/fr/" target="_blank" style="color:#2563eb;">Commissariat √† la protection de la vie priv√©e du Canada</a></li>
      <li><a href="https://support.google.com/analytics/answer/6004245" target="_blank" style="color:#2563eb;">Comment Google Analytics prot√®ge vos donn√©es</a></li>
    </ul>
  </div>
</div>

<footer style="background:#1f2937;color:white;padding:40px 20px;margin-top:50px;">
  <div class="container">
     <div style="text-align:center;color:#9ca3af;">
      <p style="margin:0 0 10px 0;font-size:1em;">Finance Personnelle Pro</p>
      <p style="margin:0;font-size:0.85em;">¬© 2025 Aziz Guellouz. Tous droits r√©serv√©s.</p>
      <p style="margin:10px 0 0 0;font-size:0.8em;">
        Le code source et les calculateurs de ce site sont la propri√©t√© intellectuelle d'Aziz Guellouz. 
        Toute reproduction ou utilisation non autoris√©e est interdite.
      </p>
    </div>
  </div>
</footer>

<script>
var DATA={};

function changeTab(t){
console.log('calcBesoin() appel√©e !');
  var tabs=document.querySelectorAll('.tab-content');
  for(var i=0;i<tabs.length;i++){tabs[i].classList.remove('active');}
  document.getElementById('tab-'+t).classList.add('active');
  var btns=document.querySelectorAll('.nav button');
  for(var i=0;i<btns.length;i++){btns[i].classList.remove('active');}
  document.getElementById('btn-'+t).classList.add('active');
  
// Cacher les bandeaux d'avertissement
var warnings = document.querySelectorAll('.warning-box, .danger-box');
for(var i = 0; i < warnings.length; i++) {
  if(t === 'apropos' || t === 'confidentialite' || t === 'aide' || t === 'besoin' || t === 'couple' || t === 'plaisirs' || t === 'acheter-louer') {
    warnings[i].style.display = 'none';
  } else {
    warnings[i].style.display = 'block';
  }
}
  
  // Recalcul automatique quand on arrive sur l'onglet "En as-tu besoin?"
  if(t === 'besoin') {
    calcBesoin();
  }
} 

function fmt(n){return Math.round(n).toLocaleString('fr-CA');}

function toggleHypotheque(){
var statut=document.getElementById('statut-resid').value;
if(statut==='proprio'){
  document.getElementById('loyer-group').classList.add('hidden');
  document.getElementById('hypo-group').classList.remove('hidden');
  document.getElementById('taxes-proprio-group').classList.remove('hidden'); // ‚Üê AJOUTER
}else{
  document.getElementById('loyer-group').classList.remove('hidden');
  document.getElementById('hypo-group').classList.add('hidden');
  document.getElementById('taxes-proprio-group').classList.add('hidden'); // ‚Üê AJOUTER
}
calc();
}

function calc(){
var a1=parseFloat(document.getElementById('cb').value)||0;
var a2=parseFloat(document.getElementById('celi').value)||0;
var a2b=parseFloat(document.getElementById('celiapp').value)||0;
var a3=parseFloat(document.getElementById('cne').value)||0;
var a4=parseFloat(document.getElementById('reer').value)||0;
var a5=parseFloat(document.getElementById('immob').value)||0;
var a6=parseFloat(document.getElementById('autre-actif').value)||0;
var p1=parseFloat(document.getElementById('cc').value)||0;
var p2=parseFloat(document.getElementById('mc').value)||0;
var p3=parseFloat(document.getElementById('pa').value)||0;
var p4=parseFloat(document.getElementById('hypo').value)||0;
var p5=parseFloat(document.getElementById('autre-passif').value)||0;
DATA.totalA=a1+a2+a2b+a3+a4+a5+a6;
DATA.totalP=p1+p2+p3+p4+p5;
DATA.vn=DATA.totalA-DATA.totalP;
DATA.cb=a1;
DATA.liquidite=a1+a2+a2b;

document.getElementById('ta').textContent=fmt(DATA.totalA)+' $';
document.getElementById('tp').textContent=fmt(DATA.totalP)+' $';
document.getElementById('vn').textContent=fmt(DATA.vn)+' $';
document.getElementById('dash-valeur').textContent=fmt(DATA.vn)+' $';
document.getElementById('dash-actifs').textContent=fmt(DATA.totalA)+' $';
document.getElementById('dash-passifs').textContent=fmt(DATA.totalP)+' $';

if(a4 > 0){
  var tauxMarginal = 0.40;
  var impotLatent = a4 * tauxMarginal;
  var reerNet = a4 - impotLatent;
  var valeurNetteAjustee = DATA.vn - impotLatent;
  
  var htmlReer = '<div class="result-box yellow" style="margin-top:15px;">';
  htmlReer += '<strong>üí° Imp√¥t latent sur REER</strong><br>';
  htmlReer += '<small style="display:block;margin:8px 0;line-height:1.6;">Les retraits REER sont impos√©s comme du revenu ordinaire. Voici une estimation de l\'impact fiscal :</small>';
  htmlReer += '<p style="margin:5px 0;">REER brut: ' + fmt(a4) + ' $</p>';
  htmlReer += '<p style="margin:5px 0;color:#dc2626;">Imp√¥t estim√© (40%): -' + fmt(impotLatent) + ' $</p>';
  htmlReer += '<p style="margin:5px 0;font-weight:bold;color:#047857;">Valeur REER nette estim√©e: ' + fmt(reerNet) + ' $</p>';
  htmlReer += '<p style="margin:10px 0;padding-top:10px;border-top:1px solid #f59e0b;font-weight:bold;color:#1e40af;">Valeur nette ajust√©e: ' + fmt(valeurNetteAjustee) + ' $</p>';
  htmlReer += '<small style="display:block;margin-top:8px;color:#78350f;">Cette estimation suppose un taux marginal de 40%. Le taux r√©el d√©pendra de votre revenu et strat√©gie de retrait √† la retraite.</small>';
  htmlReer += '</div>';
  
  // Ins√©rer dans le DOM (apr√®s la summary-box de valeur nette)
  var summaryBox = document.querySelector('#tab-bilan .summary-box');
  if(summaryBox && !document.getElementById('info-reer')){
    var infoDiv = document.createElement('div');
    infoDiv.id = 'info-reer';
    infoDiv.innerHTML = htmlReer;
    summaryBox.parentNode.insertBefore(infoDiv, summaryBox.nextSibling);
  } else if(document.getElementById('info-reer')) {
    document.getElementById('info-reer').innerHTML = htmlReer;
  }
} else {
  // Supprimer l'info si REER = 0
  var infoReer = document.getElementById('info-reer');
  if(infoReer) infoReer.remove();
}
var rev=parseFloat(document.getElementById('revenu').value)||0;
var revLoyer=parseFloat(document.getElementById('rev-loyer').value)||0;
var autreRev=parseFloat(document.getElementById('autre-revenu').value)||0;
DATA.revenuTotal=rev+revLoyer+autreRev;

var statut=document.getElementById('statut-resid').value;
var d1=statut==='proprio'?
  ((parseFloat(document.getElementById('paiement-hypo').value)||0) + 
   (parseFloat(document.getElementById('taxes-entretien').value)||0))
  :(parseFloat(document.getElementById('loyer').value)||0);
var d2=parseFloat(document.getElementById('d2').value)||0;
var d3=parseFloat(document.getElementById('d3').value)||0;
var d4=parseFloat(document.getElementById('d4').value)||0;
var d5=parseFloat(document.getElementById('d5').value)||0;
var d6=parseFloat(document.getElementById('d6').value)||0;
DATA.totalD=d1+d2+d3+d4+d5+d6;
DATA.epargne=DATA.revenuTotal-DATA.totalD;
DATA.taux=DATA.revenuTotal>0?((DATA.epargne/DATA.revenuTotal)*100).toFixed(1):0;

document.getElementById('rt').textContent=fmt(DATA.revenuTotal)+' $';
document.getElementById('td').textContent=fmt(DATA.totalD)+' $';
document.getElementById('en').textContent=fmt(DATA.epargne)+' $';
document.getElementById('te').textContent=DATA.taux+'%';
document.getElementById('dash-taux').textContent=DATA.taux+'%';

calcImpots();
calcObjectif();
calcRetraite();
calcImmobilier();
calcFondsUrgence();
calc503020();
genererDiagnostic();
}

function calcImpots(){
var rb=parseFloat(document.getElementById('rb').value)||0;
var cr=parseFloat(document.getElementById('cr').value)||0;
var ad=parseFloat(document.getElementById('ad').value)||0;
var ri=Math.max(0,rb-cr-ad);

// IMP√îT F√âD√âRAL 2025 (tranches corrig√©es)
var impf=0;
if(ri<=55867){
  impf=ri*0.15;
}else if(ri<=111733){
  impf=55867*0.15+(ri-55867)*0.205;
}else if(ri<=173205){
  impf=55867*0.15+(111733-55867)*0.205+(ri-111733)*0.26;
}else if(ri<=246752){
  impf=55867*0.15+(111733-55867)*0.205+(173205-111733)*0.26+(ri-173205)*0.29;
}else{
  impf=55867*0.15+(111733-55867)*0.205+(173205-111733)*0.26+(246752-173205)*0.29+(ri-246752)*0.33;
}

// IMP√îT PROVINCIAL QU√âBEC 2025 (tranches corrig√©es)
var impp=0;
if(ri<=51780){
  impp=ri*0.14;
}else if(ri<=103545){
  impp=51780*0.14+(ri-51780)*0.19;
}else if(ri<=126000){
  impp=51780*0.14+(103545-51780)*0.19+(ri-103545)*0.24;
}else{
  impp=51780*0.14+(103545-51780)*0.19+(126000-103545)*0.24+(ri-126000)*0.2575;
}

var impt=impf+impp;
var rn = ri - impt;
document.getElementById('ri').textContent=fmt(ri)+' $';
document.getElementById('impf').textContent=fmt(impf)+' $';
document.getElementById('impp').textContent=fmt(impp)+' $';
document.getElementById('impt').textContent=fmt(impt)+' $';
document.getElementById('rn').textContent=fmt(rn)+' $';
}

function calc503020(){
var rev=DATA.revenuTotal||0;
if(rev<=0){
document.getElementById('analyse-503020').innerHTML='<p>Entrez votre revenu mensuel dans l\'onglet Budget.</p>';
return;
}
var besoin50=rev*0.5;
var epargne20=rev*0.2;
var desirs30=rev*0.3;
var html='<div style="margin:20px 0">';
html+='<div style="margin:10px 0"><strong>Besoins (50%):</strong> '+fmt(besoin50)+' $ recommand√©s</div>';
html+='<div class="progress-bar"><div class="progress-fill" style="width:50%;background:#3b82f6"></div></div>';
html+='<div style="margin:10px 0;margin-top:20px"><strong>√âpargne (20%):</strong> '+fmt(epargne20)+' $ recommand√©s';
var epargneActuelle=DATA.epargne||0;
var pourc=rev>0?(epargneActuelle/rev*100):0;
html+=' (Actuel: '+fmt(epargneActuelle)+' $ = '+pourc.toFixed(1)+'%)</div>';
html+='<div class="progress-bar"><div class="progress-fill" style="width:20%;background:#10b981"></div></div>';
html+='<div style="margin:10px 0;margin-top:20px"><strong>D√©sirs (30%):</strong> '+fmt(desirs30)+' $ recommand√©s</div>';
html+='<div class="progress-bar"><div class="progress-fill" style="width:30%;background:#f59e0b"></div></div>';
html+='</div>';
if(epargneActuelle>=epargne20){
html+='<div class="result-box green">‚úÖ F√©licitations! Vous atteignez l\'objectif d\'√©pargne de 20%.</div>';
}else{
var deficit=epargne20-epargneActuelle;
html+='<div class="result-box orange">‚ö†Ô∏è Attention: Il vous manque '+fmt(deficit)+' $ pour atteindre les 20% d\'√©pargne recommand√©s.</div>';
}
document.getElementById('analyse-503020').innerHTML=html;
}

function calcFondsUrgence(){
var fonds=DATA.cb||0;
var depenses=DATA.totalD||1;
var mois=fonds/depenses;
var c3=depenses*3;
var c6=depenses*6;
var html='<div class="result-box '+(mois>=6?'green':mois>=3?'orange':'red')+'">';
html+='Fonds actuel: '+fmt(fonds)+' $ ('+mois.toFixed(1)+' mois)</div>';
html+='<div class="result-box blue">Objectif min (3 mois): '+fmt(c3)+' $<br>Objectif optimal (6 mois): '+fmt(c6)+' $';
var prog=(fonds/c6*100);
html+='<div class="progress-bar" style="margin-top:10px"><div class="progress-fill" style="width:'+Math.min(prog,100)+'%"></div></div></div>';
document.getElementById('resultat-fonds-urgence').innerHTML=html;
}

function toggleContributionActuelle() {
  var checked = document.getElementById('contribution-actuelle-toggle').checked;
  var section = document.getElementById('contribution-actuelle-section');
  if(checked) {
    section.classList.remove('hidden');
  } else {
    section.classList.add('hidden');
    document.getElementById('contribution-mensuelle-actuelle').value = 0;
  }
  calcRetraite();
}

function calcRetraite() {
 var revRet = parseFloat(document.getElementById('revenu-retraite').value) || 50000;
// Nouveaux calculs automatiques
var ageActuel = parseFloat(document.getElementById('age-actuel').value) || 35;
var ageRetraiteSouhaite = parseFloat(document.getElementById('age-retraite-souhaite').value) || 65;
var esperanceVie = 90; // Hypoth√®se conservative
var annees = Math.max(0, ageRetraiteSouhaite - ageActuel);
var ageRetraite = ageRetraiteSouhaite;
  var pensionPublique = parseFloat(document.getElementById('pension-publique').value) || 0;
  var rentePension = parseFloat(document.getElementById('rente-pension').value) || 0;
  var tauxRendementAvant = (parseFloat(document.getElementById('taux-rendement-avant-retraite').value) || 5) / 100;
  var tauxRendementPendant = (parseFloat(document.getElementById('taux-rendement-pendant-retraite').value) || 5) / 100;
  var retraitIndexe = document.getElementById('retrait-indexe').checked;

  var tauxInflation = 0.03;
  
  // Ajustement du revenu pour l'inflation
  var revenuAjuste = revRet * Math.pow(1 + tauxInflation, annees);

  // Pension publique disponible seulement si retraite √† 60 ans minimum
  var pensionDisponible = (ageRetraite >= 60) ? pensionPublique : 0;
  var pensionAjustee = pensionDisponible * Math.pow(1 + tauxInflation, annees);

  // Rente de pension (employeur)
  var rentePensionAjustee = rentePension * Math.pow(1 + tauxInflation, annees);
  
  // Revenu √† combler par l'√©pargne personnelle
  var revenuACombler = Math.max(0, revenuAjuste - pensionAjustee - rentePensionAjustee);
  var revenuACompleterActuel = Math.max(0, revRet - pensionDisponible - rentePension);

  // CALCUL DU CAPITAL N√âCESSAIRE (formule de rente)
// Calcul de l'√©pargne accumul√©e gr√¢ce aux contributions mensuelles
var contributionMensuelle = parseFloat(document.getElementById('contribution-mensuelle-actuelle').value) || 0;
var epargneAccumulee = 0;
if (contributionMensuelle > 0 && tauxRendementAvant > 0) {
  // Formule de la valeur future d'une rente (contributions r√©guli√®res)
  var tauxMensuel = tauxRendementAvant / 12; // D√©j√† en d√©cimal
  var nbMois = annees * 12;
  epargneAccumulee = contributionMensuelle * ((Math.pow(1 + tauxMensuel, nbMois) - 1) / tauxMensuel);
} else if (contributionMensuelle > 0) {
  epargneAccumulee = contributionMensuelle * annees * 12;
}
  // On suppose une retraite de 30 ans (65 √† 95 ans)
  // Esp√©rance de vie moyenne au Qu√©bec (environ 82-85 ans)
  var esperanceVie = 90; // Tu peux ajuster ou m√™me ajouter un input pour √ßa
  var dureeRetraite = esperanceVie - ageRetraite;
  var tauxReel = tauxRendementPendant - tauxInflation; // Taux r√©el apr√®s inflation
  
 var capitalNecessaire;
if (tauxReel > 0.001) {
  if (retraitIndexe) {
    capitalNecessaire = revenuACompleterActuel * ((1 - Math.pow(1 + tauxReel, -dureeRetraite)) / tauxReel);
  } else {
    var facteur = (1 - Math.pow(1 + tauxRendementPendant, -dureeRetraite)) / tauxRendementPendant;
    capitalNecessaire = revenuACompleterActuel * facteur;
  }
} else {
  capitalNecessaire = revenuACompleterActuel * dureeRetraite;
}

  // Capital liquide actuel (CELI, CELIAPP, CNE, REER)
  var capAct = 
    (parseFloat(document.getElementById('celi').value) || 0) +
    (parseFloat(document.getElementById('celiapp').value) || 0) +
    (parseFloat(document.getElementById('cne').value) || 0) +
    (parseFloat(document.getElementById('reer').value) || 0);

// Valeur future du capital actuel
var valeurFuture = capAct * Math.pow(1 + tauxRendementAvant, annees);
// Valeur future totale = capital actuel + √©pargne accumul√©e
var valeurFutureTotale = valeurFuture + epargneAccumulee;
// √âcart √† combler
var ecart = Math.max(0, capitalNecessaire - valeurFutureTotale);
var prog = (valeurFutureTotale / capitalNecessaire * 100);

  // SIMULATION ANN√âE PAR ANN√âE pour trouver l'√¢ge d'√©puisement
  var capitalSimulation = valeurFutureTotale;
  var retraitAnnuel = revenuACompleterActuel;
  var ageEpuisement = null;

  for (var i = 0; i <= 95 - ageRetraite && capitalSimulation > 0; i++) {
    if (retraitIndexe && i > 0) retraitAnnuel *= (1 + tauxInflation);
    var gain = capitalSimulation * tauxRendementPendant;
    capitalSimulation = capitalSimulation + gain - retraitAnnuel;
    if (capitalSimulation <= 0 && ageEpuisement === null) {
      ageEpuisement = ageRetraite + i;
    }
  }

  // CONSTRUCTION DU HTML
  var html = '';
  html += '<div class="result-box green">Capital n√©cessaire √† la retraite: <span style="font-size:1.8em">' + fmt(capitalNecessaire) + ' $</span></div>';
  html += '<p style="margin-top:6px;font-size:0.9em;color:#6b7280;">üí° Ce calcul consid√®re uniquement vos actifs financiers liquides (CELI, CELIAPP, CNE, REER). Les immobilisations et le compte bancaire ne sont pas inclus.</p>';

  html += '<p style="margin:10px 0;font-size:0.9em;color:#6b7280">';
  html += 'Revenu d√©sir√©: ' + fmt(revRet) + ' $ ‚Üí Ajust√© inflation: ' + fmt(revenuAjuste) + ' $<br>';
  if (pensionPublique > 0 || rentePension > 0) {
    if (pensionPublique > 0) {
      html += 'Pension publique (RRQ+PSV): ' + fmt(pensionPublique) + ' $';
      if (ageRetraite < 60) html += ' <strong style="color:#dc2626;">(Non disponible avant 60 ans)</strong>';
      html += '<br>';
    }
    if (rentePension > 0) html += 'Rente de pension (employeur): ' + fmt(rentePension) + ' $<br>';
    html += '<strong>Revenu √† combler par √©pargne: ' + fmt(revenuACompleterActuel) + ' $</strong><br>';
  }
  html += 'Dur√©e de retraite pr√©vue: ' + dureeRetraite + ' ans (jusqu\'√† ' + (ageRetraite + dureeRetraite) + ' ans)<br>';
  html += 'Rendement pendant la retraite: ' + fmt(tauxRendementPendant * 100) + '%';
  html += '</p>';

if(contributionMensuelle > 0) {
  var progAvecContrib = (valeurFutureTotale / capitalNecessaire * 100);
  
  html += '<div class="result-box blue">';
  html += '<strong>üìà Impact de votre √©pargne actuelle</strong><br>';
  html += 'Contribution mensuelle: ' + fmt(contributionMensuelle) + ' $/mois<br>';
  html += 'Valeur future des contributions: <span style="font-size:1.3em;color:#047857;">' + fmt(epargneAccumulee) + ' $</span><br>';
  html += '<strong style="font-size:1.1em;">Total dans ' + annees + ' ans: ' + fmt(valeurFutureTotale) + ' $</strong><br>';
  
  if(progAvecContrib >= 100) {
    html += '<p style="margin-top:10px;color:#047857;font-weight:bold;">‚úÖ Avec vos contributions actuelles, vous atteindrez votre objectif !</p>';
  } else {
    var manqueEncore = capitalNecessaire - valeurFutureTotale;
    html += '<p style="margin-top:10px;color:#ea580c;">‚ö†Ô∏è Il manquera encore ' + fmt(manqueEncore) + ' $ √† votre objectif.</p>';
  }
  html += '</div>';
}

  html += '<div class="result-box ' + (prog >= 100 ? 'green' : 'orange') + '">Progression vers l\'objectif: ' + prog.toFixed(1) + '%';
  html += '<div class="progress-bar"><div class="progress-fill" style="width:' + Math.min(prog, 100) + '%"></div></div>';
  html += '<p style="margin-top:8px;font-size:0.9em;">Valeur future totale: ' + fmt(valeurFutureTotale) + ' $<br>Capital n√©cessaire: ' + fmt(capitalNecessaire) + ' $</p></div>';

  // Si capital insuffisant : calcul √©pargne mensuelle requise
  if (prog < 100) {
    var tauxMensuel = tauxRendementAvant / 12;
    var mois = annees * 12;
    var epargneRequise = (tauxMensuel > 0)
      ? ecart / ((Math.pow(1 + tauxMensuel, mois) - 1) / tauxMensuel)
      : ecart / mois;

    html += '<div class="result-box orange">';
    html += '<strong>üìä √âpargne mensuelle n√©cessaire</strong><br>';
    html += 'Il manque: ' + fmt(ecart) + ' $ √† accumuler<br>';
    html += '<span style="font-size:1.8em;font-weight:bold;color:#ea580c;">' + fmt(epargneRequise) + ' $/mois</span><br>';
    html += '<small style="display:block;margin-top:8px;color:#6b7280;">Sur ' + annees + ' ans avec un rendement de ' + fmt(tauxRendementAvant * 100) + '%/an</small>';
    html += '</div>';
  }

  // AFFICHAGE √âPUISEMENT DU CAPITAL
  if (valeurFuture <= 0) {
    html += '<div class="result-box red" style="margin-top:10px;">‚ö†Ô∏è Vous n\'avez actuellement aucun capital disponible pour la retraite.</div>';
  } else if (ageEpuisement) {
    html += '<div class="result-box yellow" style="margin-top:10px;">‚è≥ <strong>Votre capital serait √©puis√© apr√®s environ ' +
            (ageEpuisement - ageRetraite) + ' ans de retraite</strong> (vers ' + ageEpuisement + ' ans).</div>';
  } else {
    html += '<div class="result-box green" style="margin-top:10px;">üí∞ <strong>Votre capital ne s\'√©puiserait pas avant 95 ans</strong> selon vos hypoth√®ses actuelles.</div>';
  }

  document.getElementById('resultat-retraite').innerHTML = html;
}

function calcImmobilier() {
  var revBrut = parseFloat(document.getElementById('revenu-brut-menage').value) || 0;
  // V√©rification si revenu est 0
  if(revBrut === 0) {
    document.getElementById('resultat-immobilier').innerHTML = '<div class="result-box red">‚ö†Ô∏è Veuillez entrer un revenu brut annuel pour calculer votre capacit√© d\'achat immobilier.</div>';
    return;
  }
  var tauxHypo = (parseFloat(document.getElementById('taux-hypo').value) || 5) / 100;
  var amortissement = (parseFloat(document.getElementById('amortissement').value) || 25) * 12;
  var tauxMensuel = tauxHypo / 12;
  var miseDeFondsPct = parseFloat(document.getElementById('mise-de-fonds-pct').value) / 100;
  
  // Calcul des frais SCHL selon la mise de fonds
  function calculerFraisSCHL(prixMaison, miseDeFondsPct) {
    if (miseDeFondsPct >= 0.20) return 0;
    
    var ratioEmprunt = 1 - miseDeFondsPct;
    var tauxPrime;
    
    if (ratioEmprunt > 0.95) tauxPrime = 0.04; // 5% de mise de fonds
    else if (ratioEmprunt > 0.90) tauxPrime = 0.031; // 10% de mise de fonds
    else if (ratioEmprunt > 0.85) tauxPrime = 0.028; // 15% de mise de fonds
    else tauxPrime = 0.024; // 20% de mise de fonds
    
    var montantEmprunt = prixMaison * ratioEmprunt;
    return montantEmprunt * tauxPrime;
  }
  
  // Calcul de la taxe de bienvenue (droits de mutation au Qu√©bec)
  function calculerTaxeBienvenue(prixMaison) {
    var taxe = 0;
    if (prixMaison <= 58900) {
      taxe = prixMaison * 0.005;
    } else if (prixMaison <= 294600) {
      taxe = 58900 * 0.005 + (prixMaison - 58900) * 0.01;
    } else {
      taxe = 58900 * 0.005 + (294600 - 58900) * 0.01 + (prixMaison - 294600) * 0.015;
    }
    return taxe;
  }
  
  // Approche 1 : R√®gle traditionnelle (4x le revenu)
  var prixRegleSimple = revBrut * 4;
  var miseFondsSimple = prixRegleSimple * miseDeFondsPct;
  var empruntSimple = prixRegleSimple - miseFondsSimple;
  var fraisSCHLSimple = calculerFraisSCHL(prixRegleSimple, miseDeFondsPct);
  var empruntTotalSimple = empruntSimple + fraisSCHLSimple;
  var paiementSimple = (empruntTotalSimple * tauxMensuel) / (1 - Math.pow(1 + tauxMensuel, -amortissement));
  var taxeBienvenueSimple = calculerTaxeBienvenue(prixRegleSimple);
  
  // Approche 2 : Capacit√© r√©elle selon les institutions (32% du revenu)
  var maxLog = revBrut * 0.32 / 12;
  var maxTot = revBrut * 0.40 / 12;
  
  // Calcul it√©ratif pour trouver le prix max tenant compte des frais SCHL
  var prixMaxMaison = 0;
  var tentative = revBrut * 4;
  for (var i = 0; i < 10; i++) {
    var miseFondsMax = tentative * miseDeFondsPct;
    var empruntMax = tentative - miseFondsMax;
    var fraisSCHLMax = calculerFraisSCHL(tentative, miseDeFondsPct);
    var empruntTotalMax = empruntMax + fraisSCHLMax;
    var paiementMax = (empruntTotalMax * tauxMensuel) / (1 - Math.pow(1 + tauxMensuel, -amortissement));
    if (paiementMax <= maxLog) {
      prixMaxMaison = tentative;
      tentative *= 1.05;
    } else {
      tentative *= 0.95;
    }
  }
  
  var miseFondsMaxFinal = prixMaxMaison * miseDeFondsPct;
  var fraisSCHLMaxFinal = calculerFraisSCHL(prixMaxMaison, miseDeFondsPct);
  var taxeBienvenueMax = calculerTaxeBienvenue(prixMaxMaison);

  var html = `
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:20px;margin-bottom:20px;">
      
      <div style="background:#e0f2fe;padding:20px;border-radius:12px;border-left:4px solid #0284c7;">
        <h4 style="color:#075985;margin-bottom:15px;">üìò R√®gle traditionnelle (4x revenu)</h4>
        <p style="margin:8px 0;"><strong>Prix sugg√©r√© :</strong> ${fmt(prixRegleSimple)} $</p>
        <p style="margin:8px 0;"><strong>Mise de fonds (${(miseDeFondsPct*100).toFixed(0)}%) :</strong> ${fmt(miseFondsSimple)} $</p>
        ${fraisSCHLSimple > 0 ? `<p style="margin:8px 0;color:#dc2626;"><strong>Frais SCHL :</strong> ${fmt(fraisSCHLSimple)} $</p>` : ''}
        <p style="margin:8px 0;color:#7c3aed;"><strong>Taxe de bienvenue :</strong> ${fmt(taxeBienvenueSimple)} $</p>
        <p style="margin:8px 0;font-size:1.1em;color:#047857;font-weight:bold;">
          üí∞ Paiement mensuel : ${fmt(paiementSimple)} $/mois
        </p>
        <p style="margin-top:10px;font-size:0.85em;color:#64748b;">
          R√®gle empirique simple qui ne tient pas compte du taux d'int√©r√™t actuel.
        </p>
      </div>

      <div style="background:#dcfce7;padding:20px;border-radius:12px;border-left:4px solid #16a34a;">
        <h4 style="color:#15803d;margin-bottom:15px;">üè¶ Capacit√© r√©elle (selon institutions)</h4>
        <p style="margin:8px 0;"><strong>Prix maximal :</strong> ${fmt(prixMaxMaison)} $</p>
        <p style="margin:8px 0;"><strong>Mise de fonds (${(miseDeFondsPct*100).toFixed(0)}%) :</strong> ${fmt(miseFondsMaxFinal)} $</p>
        ${fraisSCHLMaxFinal > 0 ? `<p style="margin:8px 0;color:#dc2626;"><strong>Frais SCHL :</strong> ${fmt(fraisSCHLMaxFinal)} $</p>` : ''}
        <p style="margin:8px 0;color:#7c3aed;"><strong>Taxe de bienvenue :</strong> ${fmt(taxeBienvenueMax)} $</p>
        <p style="margin:8px 0;font-size:1.1em;color:#047857;font-weight:bold;">
          üí∞ Paiement mensuel : ${fmt(maxLog)} $/mois
        </p>
        <p style="margin-top:10px;font-size:0.85em;color:#64748b;">
          Bas√© sur 32% du revenu brut et le taux actuel de ${(tauxHypo * 100).toFixed(2)}%.
        </p>
      </div>
    </div>

    ${miseDeFondsPct < 0.20 ? `
    <div style="background:#fef2f2;padding:18px 20px;border-left:6px solid #dc2626;border-radius:10px;margin:20px 0;overflow:hidden;">
    <div class="warning-box" style="background:#fef2f2;border-left:6px solid #dc2626;padding:25px;border-radius:12px;margin-bottom:30px;overflow:hidden;">
      <h4 style="margin:0 0 10px 0;color:#991b1b;">‚ö†Ô∏è Mise de fonds inf√©rieure √† 20%</h4>
      <p style="margin:0;color:#7f1d1d;font-size:0.95em;line-height:1.7;">
        Avec une mise de fonds de ${(miseDeFondsPct*100).toFixed(0)}%, vous devrez payer une assurance pr√™t hypoth√©caire SCHL. 
        Cette prime est ajout√©e √† votre emprunt et augmente vos paiements mensuels.
      </p>
    </div>
    ` : ''}

    <div style="background:#fef3c7;padding:18px 20px;border-left:6px solid #f59e0b;border-radius:10px;margin:20px 0;">
      <h4 style="margin:0 0 10px 0;color:#92400e;">üí° Comparaison des deux approches</h4>
      <p style="margin:0;color:#78350f;font-size:0.95em;line-height:1.7;">
        ${prixMaxMaison > prixRegleSimple 
          ? `Avec le taux actuel de ${(tauxHypo * 100).toFixed(2)}%, vous pourriez emprunter <strong>${fmt(prixMaxMaison - prixRegleSimple)} $ de plus</strong> que la r√®gle traditionnelle. Attention √† ne pas vous surendetter!`
          : `Avec le taux actuel de ${(tauxHypo * 100).toFixed(2)}%, votre capacit√© r√©elle est <strong>${fmt(prixRegleSimple - prixMaxMaison)} $ inf√©rieure</strong> √† la r√®gle traditionnelle. Les taux √©lev√©s r√©duisent votre pouvoir d'achat.`
        }
      </p>
    </div>
    
    <div style="background:#eef6ff;padding:18px 20px;border-left:6px solid #2563eb;border-radius:10px;margin:20px 0;font-family:system-ui,Segoe UI,Roboto,sans-serif;">
      <h3 style="margin:0;color:#1e3a8a;font-size:1.1em;">üìò R√®gle de qualification hypoth√©caire</h3>
      <p style="margin:10px 0 0 0;color:#374151;font-size:0.95em;line-height:1.7;">
        Les institutions financi√®res appliquent g√©n√©ralement les r√®gles suivantes :
        <br><strong>‚Ä¢ 32 %</strong> du revenu brut peut √™tre consacr√© au logement (<em>paiement hypoth√©caire, taxes, chauffage</em>);
        <br><strong>‚Ä¢ 40 %</strong> du revenu brut peut √™tre consacr√© √† l'ensemble des dettes (<em>logement + autres emprunts</em>).
      </p>
    </div>
  `;

  var prixMaison = parseFloat(document.getElementById('prix-maison').value) || 0;
  if (prixMaison > 0) {
    var miseFonds = prixMaison * miseDeFondsPct;
    var montantEmprunte = prixMaison - miseFonds;
    var fraisSCHL = calculerFraisSCHL(prixMaison, miseDeFondsPct);
    var empruntTotal = montantEmprunte + fraisSCHL;
    var paiementReel = (empruntTotal * tauxMensuel) / (1 - Math.pow(1 + tauxMensuel, -amortissement));
    var taxeBienvenue = calculerTaxeBienvenue(prixMaison);
    var argentRequis = miseFonds + taxeBienvenue;
    var ecartReel = prixMaison - prixMaxMaison;
    var ecartRegle = prixMaison - prixRegleSimple;
    var conformeInstitution = paiementReel <= maxLog;
    
    html += `
      <div class="result-box ${conformeInstitution ? 'green' : 'red'}">
        <h4 style="margin:0 0 10px 0;">Maison envisag√©e : ${fmt(prixMaison)} $</h4>
        <p style="margin:5px 0;"><strong>Mise de fonds (${(miseDeFondsPct*100).toFixed(0)}%) :</strong> ${fmt(miseFonds)} $</p>
        ${fraisSCHL > 0 ? `<p style="margin:5px 0;color:#dc2626;"><strong>Frais SCHL :</strong> ${fmt(fraisSCHL)} $</p>` : ''}
        <p style="margin:5px 0;color:#7c3aed;"><strong>Taxe de bienvenue :</strong> ${fmt(taxeBienvenue)} $</p>
        <p style="margin:5px 0;font-size:1.1em;font-weight:bold;color:#1e40af;"><strong>üíµ Argent requis au comptant :</strong> ${fmt(argentRequis)} $</p>
        <p style="margin:5px 0;"><strong>Paiement mensuel :</strong> ${fmt(paiementReel)} $ / mois</p>
        <p style="margin:10px 0;font-weight:bold;">
          ${conformeInstitution ? '‚úÖ Conforme √† la r√®gle du 32%' : '‚ùå D√©passe la r√®gle du 32% - Risque de refus bancaire'}
        </p>
      </div>
    `;
    
    // Analyse par rapport aux deux approches
    if (conformeInstitution && Math.abs(ecartRegle / prixRegleSimple * 100) < 10) {
      html += `<div class="result-box green">‚úÖ Le prix envisag√© est raisonnable selon les deux approches (r√®gle traditionnelle et capacit√© r√©elle).</div>`;
    } else if (!conformeInstitution) {
      html += `<div class="result-box red">‚ùå Le prix envisag√© d√©passe votre capacit√© de paiement mensuel de ${fmt(paiementReel - maxLog)} $/mois. Les institutions financi√®res risquent de refuser ce montant.</div>`;
    } else {
      html += `<div class="result-box orange">‚ö†Ô∏è Le prix envisag√© utilise toute votre capacit√© d'emprunt. Budget serr√© mais acceptable.</div>`;
    }
  }

  document.getElementById('resultat-immobilier').innerHTML = html;
}

function calcObjectif(){
  var montant=parseFloat(document.getElementById('obj-montant').value)||0;
  var date=document.getElementById('obj-date').value;
  var tauxAnnuel=(parseFloat(document.getElementById('taux-rendement-objectif').value)||0)/100;
  var tauxMensuel=tauxAnnuel/12;
  
  if(!date){
    document.getElementById('resultat-objectif').innerHTML='Selectionnez une date';
    return;
  }
  
  var aujourd=new Date();
  var dateCible=new Date(date);
  var mois=Math.max(1,(dateCible-aujourd)/(1000*60*60*24*30));
  var epargneAct=DATA.liquidite||0;
  
  var html='<div class="result-box blue">Objectif: '+fmt(montant)+' $<br>Temps: '+Math.round(mois)+' mois<br>Epargne liquide actuelle: '+fmt(epargneAct)+' $</div>';
  
  if(epargneAct>=montant){
    html+='<div class="result-box green">‚úÖ Objectif atteint!</div>';
  } else {
    var manque=montant-epargneAct;
    
    if(tauxMensuel>0){
      // Calcul avec int√©r√™ts compos√©s
      var facteur=Math.pow(1+tauxMensuel,mois);
      var valeurFutureActuelle=epargneAct*facteur;
      var manqueFutur=montant-valeurFutureActuelle;
      
      if(manqueFutur<=0){
        html+='<div class="result-box green">‚úÖ Votre √©pargne actuelle, avec les int√©r√™ts, atteindra '+fmt(valeurFutureActuelle)+' $ √† la date cible. Objectif d√©j√† atteint!</div>';
      } else {
        var mensuel=manqueFutur/(((facteur-1)/tauxMensuel));
        var totalVerse=mensuel*mois;
        var totalInterets=montant-epargneAct-totalVerse;
        
        html+='<div class="result-box orange">Avec un rendement de '+fmt(tauxAnnuel*100)+'% par ann√©e:<br>';
        html+='<span style="font-size:1.8em;font-weight:bold">'+fmt(mensuel)+' $/mois</span><br>';
        html+='<small style="display:block;margin-top:10px;color:#6b7280;">';
        html+='Total vers√©: '+fmt(totalVerse)+' $ | Int√©r√™ts gagn√©s: '+fmt(totalInterets)+' $';
        html+='</small></div>';
      }
      
      // Comparaison sans int√©r√™ts
      var mensuelSansInteret=manque/mois;
      if(mensuel<mensuelSansInteret){
        var economie=mensuelSansInteret-mensuel;
        html+='<div class="result-box blue">üí° Gr√¢ce aux int√©r√™ts compos√©s, vous √©pargnez '+fmt(economie)+' $/mois de moins qu\'un compte sans rendement ('+fmt(mensuelSansInteret)+' $/mois).</div>';
      }
      
    } else {
      // Calcul sans int√©r√™ts (taux = 0%)
      var mensuel=manque/mois;
      html+='<div class="result-box orange">Epargne mensuelle necessaire: <span style="font-size:1.8em">'+fmt(mensuel)+' $/mois</span></div>';
    }
  }
  
  document.getElementById('resultat-objectif').innerHTML=html;
}

function calcBesoin() {
 // Lecture des inputs de l'achat
  var prix = parseFloat(document.getElementById('prix-article').value) || 0;
  var salaireHoraire = parseFloat(document.getElementById('salaire-horaire').value) || 25;
  var dureeVie = parseFloat(document.getElementById('duree-vie').value) || 5;
  
  // NOUVEAU : Lecture des donn√©es du bilan
  var comptesBancaires = parseFloat(document.getElementById('cb').value) || 0;
  var celi = parseFloat(document.getElementById('celi').value) || 0;
  var celiapp = parseFloat(document.getElementById('celiapp').value) || 0;
  var epargneDisponible = comptesBancaires + celi ;

  var cartesCredit = parseFloat(document.getElementById('cc').value) || 0;
  var margesCredit = parseFloat(document.getElementById('mc').value) || 0;
  var dettesConsommation = cartesCredit + margesCredit;
  
  // NOUVEAU : Lecture du revenu du budget
  var revenuMensuel = parseFloat(document.getElementById('revenu').value) || 0;
  if(revenuMensuel === 0 && salaireHoraire > 0) {
    revenuMensuel = salaireHoraire * 160; // Estimation : 160h/mois
  }
  
  // Questions de r√©flexion
  var q1 = document.getElementById('q1-besoin').checked;
  var q2 = document.getElementById('q2-remplace').checked;
  var q3 = document.getElementById('q3-utilise').checked;
  var q4 = document.getElementById('q4-budget').checked;
  var q5 = document.getElementById('q5-attente').checked;
  var q6 = document.getElementById('q6-alternative').checked;
  
  // Calculs de base
  var heuresTravail = prix / salaireHoraire;
  var joursUtilisation = dureeVie * 365;
  var coutParJour = prix / joursUtilisation;
  var pctRevenuMensuel = (prix / revenuMensuel * 100);
  
  // Co√ªt d'opportunit√©
  var valeurSiInvesti = prix * Math.pow(1.06, dureeVie);
  var gainManque = valeurSiInvesti - prix;
  
// ===== APPROCHE McSWEEN : < 50$ = simple, ‚â• 50$ = analyse compl√®te =====
  var score = 0;
  var details = [];
  var recommandation = '';
  var couleur = '';
  var emoji = '';
  
  // Cacher/Afficher les questions selon le prix
  var questionsBlock = document.getElementById('questions-reflexion');
  
  if(prix < 50) {
    // ========== MICRO-ACHAT (< 50$) : LOGIQUE ULTRA-SIMPLE ==========
    questionsBlock.style.display = 'none'; // Cacher les questions
    
    details.push('üí∞ Achat de moins de 50$ (micro-achat selon McSween)');
    
    if(prix <= comptesBancaires) {
      score = 95;
      details.push('‚úÖ Tu as le budget en compte bancaire');
      recommandation = "C'est un micro-achat et tu as le budget : vas-y !";
      couleur = '#10b981';
      emoji = '‚úÖ';
    } else if(prix <= epargneDisponible) {
      score = 70;
      details.push('‚ö†Ô∏è Tu devras utiliser ton CELI/CELIAPP');
      recommandation = "Tu as le budget, mais garde ton √©pargne pour les urgences si possible.";
      couleur = '#f59e0b';
      emoji = '‚ö†Ô∏è';
    } else {
      score = 30;
      details.push('‚ùå Tu n\'as pas le budget disponible');
      recommandation = "Tu n'as pas le budget. Selon McSween : √©pargne d'abord, ach√®te ensuite !";
      couleur = '#ef4444';
      emoji = '‚ùå';
    }
    
  } else {
    // ========== ACHAT SIGNIFICATIF (‚â• 50$) : ANALYSE COMPL√àTE ==========
    questionsBlock.style.display = 'block'; // Afficher les questions
    
    details.push('üéØ Achat ‚â• 50$ : analyse approfondie n√©cessaire');
    
    // A. Questions pond√©r√©es (max 40 pts)
    if(q1) { score += 10; details.push('Besoin vital: +10 pts'); }
    if(q2) { score += 10; details.push('Remplace bris√©: +10 pts'); }
    if(q3) { score += 8; details.push('Utilisation r√©guli√®re: +8 pts'); }
    if(q4) { score += 7; details.push('Budget disponible: +7 pts'); }
    if(q5) { score += 3; details.push('Attente 30 jours: +3 pts'); }
    if(q6) { score += 2; details.push('Alternative consid√©r√©e: +2 pts'); }
    
    // B. Temps de travail (max 25 pts)
    if(heuresTravail < 4) { 
      score += 25; 
      details.push('< 4h de travail: +25 pts');
    } else if(heuresTravail < 20) { 
      score += 15; 
      details.push('4-20h de travail: +15 pts');
    } else if(heuresTravail < 40) { 
      score += 5; 
      details.push('20-40h de travail: +5 pts');
    } else if(heuresTravail < 80) { 
      score -= 5;
      details.push('40-80h de travail: -5 pts');
    } else {
      score -= 15;
      details.push('> 80h de travail: -15 pts');
    }
    
    // C. Co√ªt par jour (max 20 pts)
    if(coutParJour < 0.50) { score += 20; details.push('< 0.50$/jour: +20 pts'); }
    else if(coutParJour < 2) { score += 10; details.push('0.50-2$/jour: +10 pts'); }
    else if(coutParJour < 5) { score += 5; details.push('2-5$/jour: +5 pts'); }
    else { details.push('> 5$/jour: 0 pts'); }
    
    // D. √âpargne et dettes (max 15 pts)
    if(prix <= comptesBancaires) {
      score += 10;
      details.push('√âpargne suffisante: +10 pts');
    } else if(prix > epargneDisponible) {
      score -= 20;
      details.push('‚ö†Ô∏è √âpargne insuffisante: -20 pts');
    }
    
    if(dettesConsommation > 5000 && !q1) {
      score -= 15;
      details.push('‚ö†Ô∏è Dettes √©lev√©es existantes: -15 pts');
    }
    
    // Limite le score entre 0 et 100
    score = Math.max(0, Math.min(100, score));
    
    // Recommandation bas√©e sur le score
    if(score >= 70) {
      recommandation = "C'est probablement un bon achat !";
      couleur = '#10b981';
      emoji = '‚úÖ';
    } else if(score >= 50) {
      recommandation = "R√©fl√©chis encore quelques jours avant d'acheter.";
      couleur = '#f59e0b';
      emoji = '‚ö†Ô∏è';
    } else {
      recommandation = "Tu devrais repenser cet achat.";
      couleur = '#ef4444';
      emoji = '‚ùå';
    }
  }
  
  // Recommandation bas√©e sur le score
  var recommandation = '';
  var couleur = '';
  var emoji = '';
  
  if(score >= 70) {
    recommandation = "C'est probablement un bon achat !";
    couleur = '#10b981';
    emoji = '‚úÖ';
  } else if(score >= 50) {
    recommandation = "R√©fl√©chis encore quelques jours avant d'acheter.";
    couleur = '#f59e0b';
    emoji = '‚ö†Ô∏è';
  } else {
    recommandation = "Tu devrais repenser cet achat.";
    couleur = '#ef4444';
    emoji = '‚ùå';
  }
  
  // D√©lai de r√©flexion
  var delai = '';
  if(prix < 50) delai = '24 heures';
  else if(prix < 200) delai = '3 jours';
  else if(prix < 1000) delai = '1 semaine';
  else delai = '30 jours';
  
  // ===== CONSTRUCTION DU HTML =====
  var html = '';
  
// ALERTE : Situation financi√®re critique (SAUF pour micro-achats)
var estMicroAchat = heuresTravail < 0.5 || prix < 10;
if((prix > epargneDisponible || dettesConsommation > 5000) && !estMicroAchat) {
  html += '<div class="result-box red" style="margin-bottom:20px;">';
  html += '<strong>üö® ALERTE FINANCI√àRE</strong><br>';
    
    if(prix > epargneDisponible) {
      var manquant = prix - epargneDisponible;
      html += '‚ùå √âpargne disponible : ' + fmt(epargneDisponible) + ' $<br>';
      html += '‚ùå Cet achat n√©cessiterait de t\'endetter de ' + fmt(manquant) + ' $<br>';
    }
    
    if(dettesConsommation > 0) {
      html += '‚ö†Ô∏è Tu as d√©j√† ' + fmt(dettesConsommation) + ' $ de dettes de consommation<br>';
    }
    
    html += '<strong style="color:#991b1b;">Recommandation : √âpargne d\'abord, ach√®te ensuite !</strong>';
    html += '</div>';
  }
  
  // Situation financi√®re
  html += '<div class="result-box blue">';
  html += '<strong>üí∞ Ta situation financi√®re</strong><br>';
  
  if(epargneDisponible > 0) {
    html += '‚úÖ √âpargne disponible : ' + fmt(epargneDisponible) + ' $<br>';
    if(prix <= comptesBancaires) {
      html += '<span style="color:#10b981;font-weight:600;">‚úÖ Tu peux payer CASH pour cet achat !</span><br>';
    } else if(prix <= epargneDisponible) {
      html += '<span style="color:#f59e0b;">‚ö†Ô∏è Tu devrais utiliser ton CELI/CELIAPP</span><br>';
    }
  }
  
  if(dettesConsommation > 0) {
    html += '‚ö†Ô∏è Dettes actuelles : ' + fmt(dettesConsommation) + ' $<br>';
  }
  
  if(revenuMensuel > 0) {
    html += 'Revenu mensuel : ' + fmt(revenuMensuel) + ' $<br>';
    html += 'Cet achat repr√©sente <strong>' + pctRevenuMensuel.toFixed(1) + '% de ton revenu mensuel</strong>';
  }
  
  html += '</div>';
  
// Heures de travail (diff√©rent selon < 50$ ou ‚â• 50$)
  if(prix >= 50) {
    html += '<div class="result-box">';
    html += '<strong>‚è±Ô∏è Temps de travail n√©cessaire</strong><br>';
    html += '<span style="font-size:2em;color:#2563eb;">' + heuresTravail.toFixed(1) + ' heures</span><br>';
    if(heuresTravail >= 8) {
      var jours = Math.floor(heuresTravail / 8);
      var heures = (heuresTravail % 8).toFixed(1);
      html += '<small style="color:#6b7280;">Soit environ ' + jours + ' jour(s) et ' + heures + ' heure(s) de travail</small>';
    }
    html += '</div>';
  } else {
    html += '<div class="result-box blue">';
    html += '<strong>‚è±Ô∏è Effort minimal</strong><br>';
    html += '<span style="font-size:1.5em;color:#2563eb;">' + heuresTravail.toFixed(2) + ' heures de travail</span><br>';
    html += '<small style="color:#6b7280;">Selon McSween, les achats < 50$ ne n√©cessitent pas d\'analyse pouss√©e.<br>Question simple : <strong>As-tu le budget ?</strong></small>';
    html += '</div>';
  }
  html += '<span style="font-size:2em;color:#2563eb;">' + heuresTravail.toFixed(1) + ' heures</span><br>';
  if(heuresTravail >= 8) {
    var jours = Math.floor(heuresTravail / 8);
    var heures = (heuresTravail % 8).toFixed(1);
    html += '<small style="color:#6b7280;">Soit environ ' + jours + ' jour(s) et ' + heures + ' heure(s) de travail</small>';
  }
  html += '</div>';
  
  // Co√ªt par jour
  html += '<div class="result-box">';
  html += '<strong>üìÖ Co√ªt par jour d\'utilisation</strong><br>';
  html += '<span style="font-size:1.5em;color:#047857;">' + fmt(coutParJour) + ' $/jour</span><br>';
  html += '<small style="color:#6b7280;">Sur ' + dureeVie + ' ans (' + Math.round(joursUtilisation) + ' jours)</small>';
  html += '</div>';
  
  // Co√ªt d'opportunit√©
  if(prix >= 100) {
    html += '<div class="result-box orange">';
    html += '<strong>üí∏ Co√ªt d\'opportunit√©</strong><br>';
    html += 'Si tu investissais ' + fmt(prix) + '$ √† 6%/an pendant ' + dureeVie + ' ans :<br>';
    html += '<span style="font-size:1.5em;color:#ea580c;">' + fmt(valeurSiInvesti) + ' $</span><br>';
    html += '<small style="color:#6b7280;">Tu perds un gain potentiel de ' + fmt(gainManque) + ' $</small>';
    html += '</div>';
  }
  
  // Score et recommandation
  html += '<div class="result-box" style="background:' + couleur + '15;border-left:4px solid ' + couleur + ';">';
  html += '<strong style="font-size:1.3em;">' + emoji + ' Score de pertinence : ' + score + '/100</strong><br>';
  html += '<p style="margin:10px 0;font-size:1.1em;color:' + couleur + ';font-weight:600;">' + recommandation + '</p>';
  
  // D√©tails du scoring (collapsible)
  html += '<details style="margin-top:10px;font-size:0.85em;color:#6b7280;">';
  html += '<summary style="cursor:pointer;font-weight:600;">Voir le d√©tail du calcul</summary>';
  html += '<ul style="margin:10px 0;line-height:1.6;">';
  for(var i = 0; i < details.length; i++) {
    html += '<li>' + details[i] + '</li>';
  }
  html += '</ul>';
  html += '</details>';
  html += '</div>';
  
  // D√©lai de r√©flexion
  if(!q5 && prix >= 50) {
    html += '<div class="result-box yellow">';
    html += '<strong>‚è≥ R√®gle des 30 jours de McSween</strong><br>';
    html += 'Pour un achat de ' + fmt(prix) + '$, attends <strong>' + delai + '</strong> avant d\'acheter.<br>';
    html += '<small style="color:#6b7280;">Si tu y penses encore apr√®s, c\'est probablement un bon achat !</small>';
    html += '</div>';
  }
  
  // Alternatives
  if(score < 50) {
    html += '<div class="card" style="background:#f0fdf4;margin-top:20px;">';
    html += '<h3 style="color:#166534;">üí° Alternatives √† consid√©rer</h3>';
    html += '<ul style="line-height:1.8;margin-left:20px;">';
    html += '<li>Acheter usag√© (Marketplace, Kijiji, friperies)</li>';
    html += '<li>Louer ou emprunter temporairement</li>';
    html += '<li>Attendre une vente ou un rabais</li>';
    html += '<li>Chercher une version moins ch√®re</li>';
    if(dettesConsommation > 0) {
      html += '<li><strong>Rembourser tes dettes existantes d\'abord</strong></li>';
    }
    html += '<li>√âpargner pendant quelques mois puis acheter cash</li>';
    html += '</ul>';
    html += '</div>';
  }
  
  // Citation
  var citations = [
    '"Acheter, c\'est voter avec son portefeuille." - Pierre-Yves McSween',
    '"Le succ√®s est la somme de petits efforts r√©p√©t√©s jour apr√®s jour." - Robert Collier',
    '"Un sou √©pargn√© est un sou gagn√©." - Benjamin Franklin',
    '"La richesse ne consiste pas √† avoir de grandes possessions, mais √† avoir peu de besoins." - √âpict√®te'
  ];
  var citationAleatoire = citations[Math.floor(Math.random() * citations.length)];
  
  html += '<div style="background:#fef3c7;padding:15px;border-radius:8px;margin-top:20px;border-left:4px solid #f59e0b;">';
  html += '<em style="color:#78350f;">' + citationAleatoire + '</em>';
  html += '</div>';
  
  document.getElementById('resultat-besoin').innerHTML = html;
}

function genererDiagnostic(){
if(!DATA.totalA && !DATA.totalP && !DATA.revenuTotal){
document.getElementById('diagnostic-global').innerHTML='Entrez vos donnees';return;
}
var score=0;
var mois=(DATA.cb||0)/(DATA.totalD||1);
var taux=parseFloat(DATA.taux)||0;
var ratio=DATA.totalA>0?(DATA.totalP/DATA.totalA*100):100;
var ratioDetteRevenu=DATA.revenuTotal>0?(DATA.totalD/DATA.revenuTotal*100):100;

var pointsFaibles = [];
var recommandations = [];

var html='<div class="result-box '+(mois>=6?'green':mois>=3?'orange':'red')+'">Fonds urgence: '+mois.toFixed(1)+' mois';
if(mois>=6){
  html+=' - Excellent';
  score++;
}else if(mois>=3){
  html+=' - Correct';
}else{
  pointsFaibles.push("fonds d'urgence insuffisant");
if(mois < 1) {
  recommandations.push("üö® <strong>Fonds d'urgence :</strong> Les experts financiers recommandent g√©n√©ralement un minimum de 1 000 $ en urgence pour faire face aux impr√©vus.");
} else {
  recommandations.push("üí∞ <strong>Fonds d'urgence :</strong> Selon les principes financiers reconnus, un fonds d'urgence devrait couvrir 3-6 mois de d√©penses (" + fmt((DATA.totalD||0)*3) + " $ √† " + fmt((DATA.totalD||0)*6) + " $).");
}
}
html+='</div>';

html+='<div class="result-box '+(taux>=20?'green':taux>=10?'orange':'red')+'">Taux epargne: '+taux+'%';
if(taux>=20){
  html+=' - Excellent';
  score++;
}else if(taux>=10){
  html+=' - Correct';
}else{
  pointsFaibles.push("taux d'√©pargne faible");
  if(DATA.revenuTotal>0){
  var manqueEpargne = (DATA.revenuTotal * 0.20) - DATA.epargne;
  recommandations.push("üìä <strong>Taux d'√©pargne :</strong> La r√®gle g√©n√©rale en finances personnelles sugg√®re un taux d'√©pargne de 20%. Pour atteindre ce niveau, il faudrait √©pargner " + fmt(manqueEpargne) + " $/mois de plus. Astuce courante : automatiser l'√©pargne d√®s la r√©ception du revenu.");
}
}
if(taux<20 && DATA.revenuTotal>0){
  html+='<p style="font-size:0.9em;margin-top:5px;">üí° Pour atteindre 20%, augmentez votre √©pargne de ' + fmt((DATA.revenuTotal * 0.20) - DATA.epargne) + ' $/mois</p>';
}
html+='</div>';

html+='<div class="result-box '+(DATA.totalA==0&&DATA.totalP>0?'red':ratio<=30?'green':ratio<=50?'orange':'red')+'">Endettement: '+(DATA.totalA>0?ratio.toFixed(1)+'%':'N/A');
if(DATA.totalA==0&&DATA.totalP>0){
  html+=' - Critique: dettes sans actifs';
  pointsFaibles.push("dettes sans actifs");
  recommandations.push("üö® <strong>Situation critique :</strong> Vos dettes d√©passent vos actifs actuels. Les conseillers financiers recommandent g√©n√©ralement d'√©tablir un plan de remboursement structur√© en commen√ßant par les dettes √† taux d'int√©r√™t √©lev√©. Consultez un conseiller en cr√©dit ou un planificateur financier.");
}else if(ratio<=30){
  html+=' - Excellent';
  score++;
}else if(ratio<=50){
  html+=' - Mod√©r√©';
}else{
  pointsFaibles.push("endettement √©lev√©");
  recommandations.push("üí≥ <strong>Endettement :</strong> Votre ratio dettes/actifs est de " + ratio.toFixed(1) + "%. Les experts financiers recommandent g√©n√©ralement de maintenir ce ratio sous 30%. La strat√©gie couramment conseill√©e est de rembourser en priorit√© les dettes √† taux d'int√©r√™t √©lev√© (cartes de cr√©dit, marges).");
}
html+='</div>';

if(DATA.revenuTotal > 0) {
 html+='<div class="result-box '+(ratioDetteRevenu<=35?'green':ratioDetteRevenu<=50?'orange':'red')+'">Ratio dettes/revenus: '+ratioDetteRevenu.toFixed(1)+'%';
if(ratioDetteRevenu<=35){
  html+=' - Excellent';
  score++;
}else if(ratioDetteRevenu<=50){
  html+=' - Acceptable';

}else{
  html+=' - Trop √©lev√©';
  pointsFaibles.push("ratio dettes/revenus trop √©lev√©");
  recommandations.push("‚ö†Ô∏è <strong>Dettes/revenus :</strong> Votre ratio est de " + ratioDetteRevenu.toFixed(1) + "% (les institutions financi√®res recommandent g√©n√©ralement un ratio sous 35%). Les strat√©gies courantes incluent la r√©duction des d√©penses fixes ou l'augmentation des revenus.");
}

html+='</div>';
}
html+='</div>';

html+='<div class="result-box '+(DATA.vn>0?'green':'red')+'">Valeur nette: '+fmt(DATA.vn)+' $';
if(DATA.vn>100000){
  score+=2;
  html+=' - Excellent';
}else if(DATA.vn>50000){
  score++;
  html+=' - Bon d√©part';
}else if(DATA.vn>0){
  html+=' - En construction';
}else{
  pointsFaibles.push("valeur nette n√©gative");
  recommandations.push("üìâ <strong>Valeur nette n√©gative :</strong> Vos dettes d√©passent actuellement vos actifs. Les conseillers financiers recommandent g√©n√©ralement une approche combin√©e : remboursement structur√© des dettes et accumulation progressive d'√©pargne. Un plan financier personnalis√© avec un professionnel peut aider √† prioriser ces actions.");
}

html+='</div>';

html+='<div class="result-box blue">Score: '+score+'/6';
html+='<div class="progress-bar"><div class="progress-fill" style="width:'+Math.round(score/6*100)+'%"></div></div></div>';

// Commentaire selon le score
if(score>=5){
  html+='<div style="background:#d1fae5;padding:15px;border-radius:8px;margin-top:15px;color:#065f46;">üéâ Excellente sant√© financi√®re ! Continuez sur cette lanc√©e.</div>';
}else if(score>=3){
  html+='<div style="background:#dbeafe;padding:15px;border-radius:8px;margin-top:15px;color:#1e40af;">üëç Bonne base financi√®re, mais place √† am√©lioration.';
  if(pointsFaibles.length>0){
    html+='<br><small>Points √† am√©liorer : ' + pointsFaibles.join(', ') + '.</small>';
  }
  html+='</div>';

}else if(score>=1){
  html+='<div style="background:#fed7aa;padding:15px;border-radius:8px;margin-top:15px;color:#92400e;"><h4 style="color:#92400e;margin:0 0 10px 0;">‚ö†Ô∏è Situation √† am√©liorer</h4>';
  html+='<p style="margin:0;color:#374151;line-height:1.6;">Votre situation financi√®re pr√©sente plusieurs aspects √† am√©liorer. Ne vous d√©couragez pas ! Les experts recommandent une approche progressive : discipline budg√©taire et plan d\'action structur√©. Consultez un conseiller financier pour √©tablir des priorit√©s adapt√©es √† votre situation.</p>';
}else{
  html+='<div style="background:#fee2e2;padding:15px;border-radius:8px;margin-top:15px;border-left:4px solid #dc2626;"><h4 style="color:#991b1b;margin:0 0 10px 0;">üö® Situation n√©cessitant attention</h4>';
  html+='<p style="margin:0;color:#374151;line-height:1.6;">Votre situation financi√®re n√©cessite une attention particuli√®re. Les principes de base incluent : √©tablir un budget r√©aliste, identifier les d√©penses r√©ductibles et cr√©er un plan de remboursement. <strong>Il est fortement recommand√© de consulter un conseiller financier autoris√© ou un conseiller en cr√©dit</strong> pour vous accompagner.</p>';
}

// Recommandations personnalis√©es
if(recommandations.length>0){
  html+='<div style="background:#eff6ff;padding:20px;border-radius:10px;margin-top:15px;">';
  html+='<h4 style="color:#1e40af;margin:0 0 15px 0;">üìã Recommandations personnalis√©es</h4>';
  html+='<div style="color:#374151;line-height:1.8;">';
  for(var i=0;i<recommandations.length;i++){
    html+='<p style="margin:8px 0;">'+recommandations[i]+'</p>';
  }
  html+='</div></div>';
}

// Comparaison avec les statistiques qu√©b√©coises
html+='<div style="background:#f0fdf4;padding:20px;border-radius:10px;margin-top:20px;border-left:4px solid #10b981;">';
html+='<h4 style="color:#047857;margin:0 0 15px 0;">üìä Comparaison avec les statistiques qu√©b√©coises</h4>';

// Taux d'√©pargne
if(taux > 0) {
  var tauxMoyen = 5;
  html+='<div style="margin-bottom:15px;padding:10px;background:white;border-radius:6px;">';
  html+='<strong>Taux d\'√©pargne</strong><br>';
  html+='<span style="font-size:0.9em;color:#6b7280;">Vous : <strong style="color:#2563eb;">' + taux + '%</strong> | Moyenne qu√©b√©coise : ~5-6%</span><br>';
  if(taux >= 15) {
    html+='<span style="color:#047857;">‚úÖ Excellent ! Vous √©pargnez bien plus que la moyenne.</span>';
  } else if(taux >= tauxMoyen) {
    html+='<span style="color:#047857;">üëç Au-dessus de la moyenne qu√©b√©coise.</span>';
  } else {
    html+='<span style="color:#ea580c;">‚ö†Ô∏è Sous la moyenne. Essayez d\'augmenter progressivement.</span>';
  }
  html+='</div>';
}

// Ratio dette/actifs
if(DATA.totalA > 0) {
  html+='<div style="margin-bottom:15px;padding:10px;background:white;border-radius:6px;">';
  html+='<strong>Endettement (dette/actifs)</strong><br>';
  html+='<span style="font-size:0.9em;color:#6b7280;">Vous : <strong style="color:#2563eb;">' + ratio.toFixed(1) + '%</strong> | Recommand√© : sous 30%</span><br>';
  if(ratio <= 20) {
    html+='<span style="color:#047857;">‚úÖ Excellent niveau d\'endettement.</span>';
  } else if(ratio <= 30) {
    html+='<span style="color:#047857;">üëç Endettement sain.</span>';
  } else {
    html+='<span style="color:#ea580c;">‚ö†Ô∏è Au-dessus du niveau recommand√©.</span>';
  }
  html+='</div>';
}

// Fonds d'urgence
html+='<div style="margin-bottom:15px;padding:10px;background:white;border-radius:6px;">';
html+='<strong>Fonds d\'urgence</strong><br>';
html+='<span style="font-size:0.9em;color:#6b7280;">Vous : <strong style="color:#2563eb;">' + mois.toFixed(1) + ' mois</strong> | Environ 40% des Canadiens n\'ont pas 3 mois d\'√©pargne</span><br>';
if(mois >= 6) {
  html+='<span style="color:#047857;">‚úÖ Vous faites partie des 30% les mieux pr√©par√©s !</span>';
} else if(mois >= 3) {
  html+='<span style="color:#047857;">üëç Mieux que 60% des Canadiens.</span>';
} else {
  html+='<span style="color:#ea580c;">‚ö†Ô∏è 60% des Canadiens ont au moins 3 mois. Continuez √† b√¢tir votre fonds.</span>';
}
html+='</div>';

// Valeur nette (optionnel - si l'utilisateur veut partager son √¢ge)
html+='<div style="margin-bottom:15px;padding:10px;background:white;border-radius:6px;">';
html+='<strong>Valeur nette</strong><br>';
html+='<span style="font-size:0.9em;color:#6b7280;">Vous : <strong style="color:#2563eb;">' + fmt(DATA.vn) + ' $</strong></span><br>';
html+='<span style="font-size:0.85em;color:#6b7280;">Valeur nette m√©diane au Canada (selon l\'√¢ge) :<br>';
html+='‚Ä¢ Moins de 35 ans : ~50 000$<br>';
html+='‚Ä¢ 35-44 ans : ~250 000$<br>';
html+='‚Ä¢ 45-54 ans : ~500 000$<br>';
html+='‚Ä¢ 55-64 ans : ~850 000$</span>';
html+='</div>';

// Liens vers sources officielles
html+='<div style="margin-top:15px;padding-top:15px;border-top:1px solid #d1fae5;">';
html+='<p style="font-size:0.85em;color:#6b7280;margin:0 0 8px 0;"><strong>üìö Sources officielles pour en savoir plus :</strong></p>';
html+='<ul style="font-size:0.85em;color:#6b7280;margin:0;padding-left:20px;line-height:1.8;">';
html+='<li><a href="https://www150.statcan.gc.ca/n1/fr/subjects/revenus_pensions_depenses_et_richesse" target="_blank" style="color:#2563eb;">Statistique Canada - Revenus et richesse</a></li>';
html+='<li><a href="https://www.banqueducanada.ca/taux/indicateurs/capacite-et-besoins-financiers/ratios-dette-menages/" target="_blank" style="color:#2563eb;">Banque du Canada - Endettement des m√©nages</a></li>';
html+='<li><a href="https://www.canada.ca/fr/agence-consommation-matiere-financiere/programmes/litteratie-financiere.html" target="_blank" style="color:#2563eb;">Gouvernement du Canada - Litt√©ratie financi√®re</a></li>';
html+='</ul>';
html+='</div>';

html+='</div>';

document.getElementById('diagnostic-global').innerHTML=html;
document.getElementById('diagnostic-global').innerHTML=html;

}

function exporterCSV() {
  const rows = [
    ["Section","Cl√©","Valeur"],
    ["Actifs","Compte bancaire", document.getElementById('cb').value],
    ["Actifs","CELI", document.getElementById('celi').value],
    ["Actifs","Compte non enregistr√©", document.getElementById('cne').value],
    ["Actifs","REER", document.getElementById('reer').value],
    ["Actifs","Immobilisations", document.getElementById('immob').value],
    ["Actifs","Autres actifs", document.getElementById('autre-actif').value],
    ["Passifs","Cartes de cr√©dit", document.getElementById('cc').value],
    ["Passifs","Marge de cr√©dit", document.getElementById('mc').value],
    ["Passifs","Pr√™t auto", document.getElementById('pa').value],
    ["Passifs","Hypoth√®que", document.getElementById('hypo').value],
    ["Passifs","Autres passifs", document.getElementById('autre-passif').value],
    ["R√©sum√©","Total actifs", DATA.totalA||0],
    ["R√©sum√©","Total passifs", DATA.totalP||0],
    ["R√©sum√©","Valeur nette", DATA.vn||0],
    ["Budget","Revenu mensuel net", document.getElementById('revenu').value],
    ["Budget","Revenu de loyer", document.getElementById('rev-loyer').value],
    ["Budget","Autre revenu", document.getElementById('autre-revenu').value],
    ["Budget","Revenus totaux", DATA.revenuTotal||0],
    ["Budget","Total d√©penses", DATA.totalD||0],
    ["Budget","√âpargne mensuelle", DATA.epargne||0],
    ["Budget","Taux d'√©pargne (%)", DATA.taux||0],
    ["Imp√¥ts","Revenu brut annuel", document.getElementById('rb').value],
    ["Imp√¥ts","Contribution REER", document.getElementById('cr').value],
    ["Imp√¥ts","Autres d√©ductions", document.getElementById('ad').value],
    ["Objectifs","Montant cible", document.getElementById('obj-montant').value],
    ["Objectifs","Date cible", document.getElementById('obj-date').value],
  ];

  let csvContent = rows.map(e => e.join(";")).join("\n");
  const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
  const url = URL.createObjectURL(blob);
  const link = document.createElement("a");
  link.setAttribute("href", url);
  link.setAttribute("download", "finance_personnelle.csv");
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
}

// Gestion des dettes - Version propre
var listeDettes = [];
var idCompteur = 0;

function ajouterLigneDette() {
  idCompteur++;
  var id = idCompteur;
  
  listeDettes.push({
    id: id,
    nom: '',
    solde: 0,
    taux: 0,
    paiementMin: 0
  });
  
  afficherDettes();
}

function supprimerLigneDette(id) {
  listeDettes = listeDettes.filter(function(d) { return d.id !== id; });
  afficherDettes();
  calculerStrategies();
}

function afficherDettes() {
  var html = '';
  
  if(listeDettes.length === 0) {
    html = '<p style="color:#6b7280;font-style:italic;">Aucune dette ajout√©e. Cliquez sur "Ajouter une dette" pour commencer.</p>';
  }
  
  for(var i = 0; i < listeDettes.length; i++) {
    var dette = listeDettes[i];
    html += '<div style="background:#f9fafb;padding:20px;border-radius:8px;margin-bottom:15px;border:1px solid #e5e7eb;">';
    html += '<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;">';
    html += '<h4 style="margin:0;color:#374151;">Dette #' + dette.id + '</h4>';
    html += '<button onclick="supprimerLigneDette(' + dette.id + ')" style="background:#ef4444;color:white;padding:6px 12px;border:none;border-radius:6px;cursor:pointer;font-size:0.9em;">Supprimer</button>';
    html += '</div>';
    
    html += '<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;">';
    
    html += '<div>';
    html += '<label style="display:block;font-size:0.875em;font-weight:500;color:#374151;margin-bottom:8px;">Type de dette</label>';
    html += '<select id="nom-' + dette.id + '" onchange="mettreAJourDette(' + dette.id + ')" style="width:100%;padding:10px;border:1px solid #d1d5db;border-radius:6px;">';
    html += '<option value="Carte de cr√©dit">Carte de cr√©dit</option>';
    html += '<option value="Pr√™t auto">Pr√™t auto</option>';
    html += '<option value="Marge de cr√©dit">Marge de cr√©dit</option>';
    html += '<option value="Pr√™t personnel">Pr√™t personnel</option>';
    html += '<option value="Pr√™t √©tudiant">Pr√™t √©tudiant</option>';
    html += '<option value="Autre">Autre</option>';
    html += '</select>';
    html += '</div>';
    
    html += '<div>';
    html += '<label style="display:block;font-size:0.875em;font-weight:500;color:#374151;margin-bottom:8px;">Solde actuel ($)</label>';
    html += '<input type="number" id="solde-' + dette.id + '" value="' + dette.solde + '" onchange="mettreAJourDette(' + dette.id + ')" style="width:100%;padding:10px;border:1px solid #d1d5db;border-radius:6px;" min="0">';
    html += '</div>';
    
    html += '<div>';
    html += '<label style="display:block;font-size:0.875em;font-weight:500;color:#374151;margin-bottom:8px;">Taux d\'int√©r√™t annuel (%)</label>';
    html += '<input type="number" id="taux-' + dette.id + '" value="' + dette.taux + '" onchange="mettreAJourDette(' + dette.id + ')" style="width:100%;padding:10px;border:1px solid #d1d5db;border-radius:6px;" min="0" step="0.1">';
    html += '</div>';
    
    html += '<div>';
    html += '<label style="display:block;font-size:0.875em;font-weight:500;color:#374151;margin-bottom:8px;">Paiement minimum ($)</label>';
    html += '<input type="number" id="paiementMin-' + dette.id + '" value="' + dette.paiementMin + '" onchange="mettreAJourDette(' + dette.id + ')" style="width:100%;padding:10px;border:1px solid #d1d5db;border-radius:6px;" min="0">';
    html += '</div>';
    
    html += '</div>';
    html += '</div>';
  }
  
  document.getElementById('liste-dettes-container').innerHTML = html;
}

function mettreAJourDette(id) {
  for(var i = 0; i < listeDettes.length; i++) {
    if(listeDettes[i].id === id) {
      listeDettes[i].nom = document.getElementById('nom-' + id).value;
      listeDettes[i].solde = parseFloat(document.getElementById('solde-' + id).value) || 0;
      listeDettes[i].taux = parseFloat(document.getElementById('taux-' + id).value) || 0;
      listeDettes[i].paiementMin = parseFloat(document.getElementById('paiementMin-' + id).value) || 0;
      break;
    }
  }
}

function calculerStrategies() {
  if(listeDettes.length === 0) {
    document.getElementById('resultats-strategies').innerHTML =
      '<div class="card"><p style="color:#6b7280;">Ajoutez au moins une dette pour voir les calculs.</p></div>';
    return;
  }

  // Filtrer uniquement les dettes avec un solde > 0
  var dettesValides = [];
  for (var i = 0; i < listeDettes.length; i++) {
    if ((listeDettes[i].solde || 0) > 0) {
      dettesValides.push({
        nom: listeDettes[i].nom,
        solde: Number(listeDettes[i].solde) || 0,
        taux: Number(listeDettes[i].taux) || 0,
        paiementMin: Math.max(0, Number(listeDettes[i].paiementMin) || 0)
      });
    }
  }

  if(dettesValides.length === 0) {
    document.getElementById('resultats-strategies').innerHTML =
      '<div class="card"><p style="color:#dc2626;">Entrez au moins une dette avec un solde sup√©rieur √† 0.</p></div>';
    return;
  }

  var paiementExtra = Math.max(0, Number(document.getElementById('paiement-extra').value) || 0);

  // Diagnostique ‚Äúamortisation n√©gative‚Äù (les int√©r√™ts du mois > minimums)
  var totalMin = 0, totalInteretsMensuels = 0;
  for (var j = 0; j < dettesValides.length; j++) {
    totalMin += dettesValides[j].paiementMin;
    totalInteretsMensuels += dettesValides[j].solde * (dettesValides[j].taux / 100 / 12);
  }

  var avertissement = '';
  if (totalMin + paiementExtra <= totalInteretsMensuels + 1e-6) {
    var manque = Math.ceil(totalInteretsMensuels - (totalMin + paiementExtra) + 1);
    avertissement = `
      <div class="card" style="background:#fee2e2;border-left:4px solid #dc2626;margin-top:20px;">
        <h3 style="color:#991b1b;">‚ö†Ô∏è Amortisation n√©gative</h3>
        <p>Vos int√©r√™ts mensuels (~${fmt(totalInteretsMensuels)} $) d√©passent vos paiements (min + extra = ${fmt(totalMin + paiementExtra)} $).</p>
        <p><strong>Ajoutez au moins ${fmt(manque)} $/mois</strong> pour commencer √† r√©duire le capital.</p>
      </div>`;
  }

  // Lancer les deux simulations (on ne bloque plus si extra = 0)
  var avalanche  = simulerStrategie(dettesValides, paiementExtra, 'avalanche');
  var bouleNeige = simulerStrategie(dettesValides, paiementExtra, 'boule');

  // Affichage
  afficherComparaison(avalanche, bouleNeige, dettesValides, paiementExtra);

  // Injecter l‚Äôavertissement √©ventuel (au-dessus des r√©sultats)
  if (avertissement) {
    var cont = document.getElementById('resultats-strategies');
    cont.innerHTML = avertissement + cont.innerHTML;
  }
}

function simulerStrategie(dettes, paiementExtra, type) {
  // Copie profonde
  var dettesCopie = dettes.map(function(d){
    return { nom:d.nom, solde:d.solde, taux:d.taux, paiementMin:d.paiementMin };
  });

  // Tri initial (une fois)
  if (type === 'avalanche') {
    dettesCopie.sort(function(a,b){ return b.taux - a.taux; });
  } else { // 'boule'
    dettesCopie.sort(function(a,b){ return a.solde - b.solde; });
  }

  var mois = 0;
  var interetsTotal = 0;
  var ordreRemboursement = [];

  // Pour d√©tecter les sc√©narios qui ne convergent pas
  var previousTotal = dettesCopie.reduce((s,d)=>s+d.solde,0);

  while (dettesCopie.length > 0 && mois < 1200) {
    mois++;

    // 1) Int√©r√™ts du mois
    for (var i = 0; i < dettesCopie.length; i++) {
      var r = dettesCopie[i].taux / 100 / 12;
      var interetsMois = dettesCopie[i].solde * r;
      dettesCopie[i].solde += interetsMois;
      interetsTotal += interetsMois;
    }

    // 2) Payer tous les minimums
    for (var k = 0; k < dettesCopie.length; k++) {
      var payMin = Math.min(dettesCopie[k].paiementMin, dettesCopie[k].solde);
      dettesCopie[k].solde -= payMin;
    }

    // 3) Appliquer le paiement EXTRA avec r√©allocation
    var extraRestant = paiementExtra;
    var idx = 0;
    while (extraRestant > 0 && dettesCopie.length > 0 && idx < dettesCopie.length) {
      var pay = Math.min(extraRestant, dettesCopie[idx].solde);
      dettesCopie[idx].solde -= pay;
      extraRestant -= pay;

      // si cette dette est sold√©e, passer automatiquement √† la suivante
      if (dettesCopie[idx].solde < 0.01) {
        ordreRemboursement.push({ nom: dettesCopie[idx].nom, mois: mois });
        dettesCopie.splice(idx,1);
        // pas d'idx++ ici, on retente m√™me index (prochaine dette ‚Äúprend la place‚Äù)
      } else {
        idx++; // continuer sur la prochaine seulement si celle-ci n'est pas sold√©e
      }
    }

    // Supprimer les dettes sold√©es restantes (s√©curit√©)
    for (var m = dettesCopie.length - 1; m >= 0; m--) {
      if (dettesCopie[m].solde < 0.01) {
        ordreRemboursement.push({ nom: dettesCopie[m].nom, mois: mois });
        dettesCopie.splice(m,1);
      }
    }

    // S√©curit√© : si le total augmente sur 6 mois, on arr√™te (non convergent)
    if (mois % 6 === 0) {
      var totalNow = dettesCopie.reduce((s,d)=>s+d.solde,0);
      if (totalNow > previousTotal + 0.01) {
        // on renvoie un √©tat ‚Äúnon convergent‚Äù
        return { mois: Infinity, annees: Infinity, interetsTotal: interetsTotal, ordre: ordreRemboursement, nonConvergent: true };
      }
      previousTotal = totalNow;
    }
  }

  return {
    mois: mois,
    annees: Math.round(mois / 12 * 10) / 10,
    interetsTotal: interetsTotal,
    ordre: ordreRemboursement,
    nonConvergent: false
  };
}

function afficherComparaison(avalanche, bouleNeige, dettes, paiementExtra) {
  var totalDettes = 0;
  var totalMin = 0;
  
  for(var i = 0; i < dettes.length; i++) {
    totalDettes += dettes[i].solde;
    totalMin += dettes[i].paiementMin;
  }
  
  var html = '';
  
  // R√©sum√© situation
  html += '<div class="card" style="background:#f0f9ff;margin-top:20px;">';
  html += '<h3 style="color:#1e40af;">üìã Votre situation</h3>';
  html += '<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;margin-top:15px;">';
  html += '<div><p style="color:#6b7280;font-size:0.9em;margin:0;">Total des dettes</p><p style="font-size:1.5em;font-weight:bold;color:#1f2937;margin:5px 0 0 0;">' + fmt(totalDettes) + ' $</p></div>';
  html += '<div><p style="color:#6b7280;font-size:0.9em;margin:0;">Paiements minimums</p><p style="font-size:1.5em;font-weight:bold;color:#1f2937;margin:5px 0 0 0;">' + fmt(totalMin) + ' $/mois</p></div>';
  html += '<div><p style="color:#6b7280;font-size:0.9em;margin:0;">Paiement extra</p><p style="font-size:1.5em;font-weight:bold;color:#047857;margin:5px 0 0 0;">' + fmt(paiementExtra) + ' $/mois</p></div>';
  html += '<div><p style="color:#6b7280;font-size:0.9em;margin:0;">Total mensuel</p><p style="font-size:1.5em;font-weight:bold;color:#2563eb;margin:5px 0 0 0;">' + fmt(totalMin + paiementExtra) + ' $/mois</p></div>';
  html += '</div>';
  html += '</div>';
  
  // Comparaison des deux m√©thodes
  html += '<div class="grid-2" style="margin-top:20px;">';
  
  // Avalanche
  html += '<div class="card" style="border-left:4px solid #dc2626;">';
  html += '<h3 style="color:#dc2626;">üî• M√©thode Avalanche</h3>';
  html += '<p style="background:#fef3c7;padding:10px;border-radius:6px;font-size:0.9em;margin-bottom:15px;">Priorit√© aux <strong>taux d\'int√©r√™t √©lev√©s</strong></p>';
  html += '<div class="result-box blue">Dur√©e: <strong>' + avalanche.mois + ' mois</strong> (' + avalanche.annees + ' ans)</div>';
  html += '<div class="result-box red">Int√©r√™ts pay√©s: <strong>' + fmt(avalanche.interetsTotal) + ' $</strong></div>';
  html += '</div>';
  
  // Boule de neige
  html += '<div class="card" style="border-left:4px solid #2563eb;">';
  html += '<h3 style="color:#2563eb;">‚ùÑÔ∏è M√©thode Boule de neige</h3>';
  html += '<p style="background:#dbeafe;padding:10px;border-radius:6px;font-size:0.9em;margin-bottom:15px;">Priorit√© aux <strong>petits soldes</strong> (motivation)</p>';
  html += '<div class="result-box blue">Dur√©e: <strong>' + bouleNeige.mois + ' mois</strong> (' + bouleNeige.annees + ' ans)</div>';
  html += '<div class="result-box red">Int√©r√™ts pay√©s: <strong>' + fmt(bouleNeige.interetsTotal) + ' $</strong></div>';
  html += '</div>';
  
  html += '</div>';
  
  // Verdict
  var diff = bouleNeige.interetsTotal - avalanche.interetsTotal;
  var diffMois = bouleNeige.mois - avalanche.mois;
  
  html += '<div class="card" style="margin-top:20px;">';
  html += '<h3>üèÜ Verdict</h3>';
  
  if(Math.abs(diff) < 10) {
    html += '<div class="result-box blue">Les deux m√©thodes donnent des r√©sultats tr√®s similaires. Choisissez celle qui vous motive le plus !</div>';
  } else if(diff > 0) {
    html += '<div class="result-box green">';
    html += '‚úÖ La m√©thode <strong>Avalanche</strong> vous fait √©conomiser <strong>' + fmt(diff) + ' $</strong> en int√©r√™ts ';
    html += 'et vous lib√®re <strong>' + Math.abs(diffMois) + ' mois plus t√¥t</strong> (' + Math.round(Math.abs(diffMois)/12*10)/10 + ' ans).';
    html += '</div>';
  } else {
    html += '<div class="result-box green">';
    html += '‚úÖ La m√©thode <strong>Boule de neige</strong> est l√©g√®rement avantageuse dans votre cas.';
    html += '</div>';
  }
  
html += '<div style="background:#f0f9ff;padding:20px;border-radius:10px;margin-top:20px;border-left:4px solid #2563eb;">';
html += '<h4 style="margin:0 0 15px 0;color:#1e40af;">üìã Plan d\'action recommand√©</h4>';

var meilleure = (diff >= 0) ? avalanche : bouleNeige;
var methodeNom = (diff >= 0) ? 'Avalanche' : 'Boule de neige';

html += '<p style="margin:0 0 10px 0;"><strong>Suivez la m√©thode ' + methodeNom + ' :</strong></p>';
html += '<ol style="margin:0;padding-left:20px;line-height:2;">';

for(var i = 0; i < meilleure.ordre.length; i++) {
  html += '<li><strong>' + meilleure.ordre[i].nom + '</strong> - sera rembours√©e au mois ' + meilleure.ordre[i].mois;
  if(i === 0) {
    html += ' <span style="color:#047857;font-weight:bold;">‚Üê Concentrez votre paiement suppl√©mentaire ici en premier</span>';
  }
  html += '</li>';
}

html += '</ol>';
html += '<p style="margin:15px 0 0 0;padding-top:15px;border-top:1px solid #bfdbfe;color:#6b7280;font-size:0.9em;">';
html += 'üí° <strong>Astuce :</strong> Continuez √† payer les minimums sur toutes les dettes, mais concentrez votre paiement suppl√©mentaire de ' + fmt(paiementExtra) + ' $/mois sur la dette prioritaire selon cet ordre.';
html += '</p>';
html += '</div>';

html += '</div>';

  document.getElementById('resultats-strategies').innerHTML = html;
}

function calcCouple() {
  // R√©cup√©rer toutes les donn√©es
  var revenuA = parseFloat(document.getElementById('couple-revenu-a').value) || 0;
  var revenuB = parseFloat(document.getElementById('couple-revenu-b').value) || 0;
  
  // Dettes A
  var dettesA = 
    (parseFloat(document.getElementById('couple-cc-a').value) || 0) +
    (parseFloat(document.getElementById('couple-pret-etude-a').value) || 0) +
    (parseFloat(document.getElementById('couple-auto-a').value) || 0) +
    (parseFloat(document.getElementById('couple-autres-dettes-a').value) || 0);
  
  // D√©penses perso A
  var depensesPersoA = dettesA +
    (parseFloat(document.getElementById('couple-assurance-a').value) || 0) +
    (parseFloat(document.getElementById('couple-abonnements-a').value) || 0) +
    (parseFloat(document.getElementById('couple-pension-a').value) || 0);
  
  var epargneA = parseFloat(document.getElementById('couple-epargne-a').value) || 0;
  
  // Dettes B
  var dettesB = 
    (parseFloat(document.getElementById('couple-cc-b').value) || 0) +
    (parseFloat(document.getElementById('couple-pret-etude-b').value) || 0) +
    (parseFloat(document.getElementById('couple-auto-b').value) || 0) +
    (parseFloat(document.getElementById('couple-autres-dettes-b').value) || 0);
  
  // D√©penses perso B
  var depensesPersoB = dettesB +
    (parseFloat(document.getElementById('couple-assurance-b').value) || 0) +
    (parseFloat(document.getElementById('couple-abonnements-b').value) || 0) +
    (parseFloat(document.getElementById('couple-pension-b').value) || 0);
  
  var epargneB = parseFloat(document.getElementById('couple-epargne-b').value) || 0;
  
  // D√©penses communes
  var depensesCommunes = 
    (parseFloat(document.getElementById('couple-loyer').value) || 0) +
    (parseFloat(document.getElementById('couple-epicerie').value) || 0) +
    (parseFloat(document.getElementById('couple-services').value) || 0) +
    (parseFloat(document.getElementById('couple-transport').value) || 0) +
    (parseFloat(document.getElementById('couple-loisirs').value) || 0) +
    (parseFloat(document.getElementById('couple-autres').value) || 0);
  
  document.getElementById('couple-total-depenses').textContent = fmt(depensesCommunes) + ' $';
  
  var tauxEpargne = (parseFloat(document.getElementById('couple-taux-epargne').value) || 20) / 100;
  
  // Calculs de revenu disponible
  var revenuDispoA = revenuA - depensesPersoA;
  var revenuDispoB = revenuB - depensesPersoB;
  
  // Ratios dette/revenu
  var ratioDetteA = revenuA > 0 ? (depensesPersoA / revenuA * 100) : 0;
  var ratioDetteB = revenuB > 0 ? (depensesPersoB / revenuB * 100) : 0;
  
  // ===== DIAGNOSTIC INDIVIDUEL A =====
  var diagA = '<div style="background:#eff6ff;padding:15px;border-radius:8px;margin-top:20px;">';
  diagA += '<h4 style="color:#1e40af;margin:0 0 10px 0;">üìä Diagnostic Personne A</h4>';
  diagA += '<p style="margin:5px 0;">Revenu disponible : <strong>' + fmt(revenuDispoA) + ' $/mois</strong></p>';
  diagA += '<p style="margin:5px 0;">Ratio dettes/revenu : <strong style="color:' + (ratioDetteA <= 35 ? '#10b981' : ratioDetteA <= 50 ? '#f59e0b' : '#ef4444') + '">' + ratioDetteA.toFixed(1) + '%</strong>';
  if(ratioDetteA > 50) diagA += ' ‚ö†Ô∏è √âlev√©';
  else if(ratioDetteA > 35) diagA += ' Acceptable';
  else diagA += ' ‚úÖ Sain';
  diagA += '</p>';
  diagA += '<p style="margin:5px 0;">Fonds d\'urgence : <strong style="color:' + (epargneA >= 3000 ? '#10b981' : epargneA >= 1000 ? '#f59e0b' : '#ef4444') + '">' + fmt(epargneA) + ' $</strong>';
  if(epargneA < 1000) diagA += ' ‚ùå Insuffisant';
  else if(epargneA < 3000) diagA += ' ‚ö†Ô∏è Minimal';
  else diagA += ' ‚úÖ Ad√©quat';
  diagA += '</p>';
  diagA += '</div>';
  
  document.getElementById('diagnostic-a').innerHTML = diagA;
  
  // ===== DIAGNOSTIC INDIVIDUEL B =====
  var diagB = '<div style="background:#faf5ff;padding:15px;border-radius:8px;margin-top:20px;">';
  diagB += '<h4 style="color:#7c3aed;margin:0 0 10px 0;">üìä Diagnostic Personne B</h4>';
  diagB += '<p style="margin:5px 0;">Revenu disponible : <strong>' + fmt(revenuDispoB) + ' $/mois</strong></p>';
  diagB += '<p style="margin:5px 0;">Ratio dettes/revenu : <strong style="color:' + (ratioDetteB <= 35 ? '#10b981' : ratioDetteB <= 50 ? '#f59e0b' : '#ef4444') + '">' + ratioDetteB.toFixed(1) + '%</strong>';
  if(ratioDetteB > 50) diagB += ' ‚ö†Ô∏è √âlev√©';
  else if(ratioDetteB > 35) diagB += ' Acceptable';
  else diagB += ' ‚úÖ Sain';
  diagB += '</p>';
  diagB += '<p style="margin:5px 0;">Fonds d\'urgence : <strong style="color:' + (epargneB >= 3000 ? '#10b981' : epargneB >= 1000 ? '#f59e0b' : '#ef4444') + '">' + fmt(epargneB) + ' $</strong>';
  if(epargneB < 1000) diagB += ' ‚ùå Insuffisant';
  else if(epargneB < 3000) diagB += ' ‚ö†Ô∏è Minimal';
  else diagB += ' ‚úÖ Ad√©quat';
  diagB += '</p>';
  diagB += '</div>';
  
  document.getElementById('diagnostic-b').innerHTML = diagB;
  
  // Si aucune donn√©e, ne pas afficher de r√©sultats
  if(revenuA === 0 && revenuB === 0) {
    document.getElementById('resultats-couple').innerHTML = '';
    return;
  }
  
  // ===== R√âSULTATS ET COMPARAISONS =====
  var html = '';
  
  // Diagnostic comparatif
  html += '<div class="card" style="margin-top:30px;">';
  html += '<h3 style="color:#1f2937;">üìä Diagnostic comparatif</h3>';
  html += '<div style="overflow-x:auto;">';
  html += '<table style="width:100%;border-collapse:collapse;margin-top:15px;">';
  html += '<thead style="background:#f9fafb;"><tr>';
  html += '<th style="text-align:left;padding:12px;border-bottom:2px solid #e5e7eb;">Crit√®re</th>';
  html += '<th style="text-align:right;padding:12px;border-bottom:2px solid #e5e7eb;">Personne A</th>';
  html += '<th style="text-align:right;padding:12px;border-bottom:2px solid #e5e7eb;">Personne B</th>';
  html += '</tr></thead><tbody>';
  
  html += '<tr><td style="padding:10px;border-bottom:1px solid #e5e7eb;">Revenu net</td>';
  html += '<td style="text-align:right;padding:10px;border-bottom:1px solid #e5e7eb;">' + fmt(revenuA) + ' $</td>';
  html += '<td style="text-align:right;padding:10px;border-bottom:1px solid #e5e7eb;">' + fmt(revenuB) + ' $</td></tr>';
  
  html += '<tr><td style="padding:10px;border-bottom:1px solid #e5e7eb;">D√©penses personnelles</td>';
  html += '<td style="text-align:right;padding:10px;border-bottom:1px solid #e5e7eb;">' + fmt(depensesPersoA) + ' $</td>';
  html += '<td style="text-align:right;padding:10px;border-bottom:1px solid #e5e7eb;">' + fmt(depensesPersoB) + ' $</td></tr>';
  
  html += '<tr><td style="padding:10px;border-bottom:1px solid #e5e7eb;"><strong>Revenu disponible</strong></td>';
  html += '<td style="text-align:right;padding:10px;border-bottom:1px solid #e5e7eb;"><strong>' + fmt(revenuDispoA) + ' $</strong></td>';
  html += '<td style="text-align:right;padding:10px;border-bottom:1px solid #e5e7eb;"><strong>' + fmt(revenuDispoB) + ' $</strong></td></tr>';
  
  html += '<tr><td style="padding:10px;border-bottom:1px solid #e5e7eb;">Ratio dette/revenu</td>';
  html += '<td style="text-align:right;padding:10px;border-bottom:1px solid #e5e7eb;color:' + (ratioDetteA > 50 ? '#ef4444' : ratioDetteA > 35 ? '#f59e0b' : '#10b981') + '">' + ratioDetteA.toFixed(1) + '%</td>';
  html += '<td style="text-align:right;padding:10px;border-bottom:1px solid #e5e7eb;color:' + (ratioDetteB > 50 ? '#ef4444' : ratioDetteB > 35 ? '#f59e0b' : '#10b981') + '">' + ratioDetteB.toFixed(1) + '%</td></tr>';
  
  html += '<tr><td style="padding:10px;">Fonds d\'urgence</td>';
  html += '<td style="text-align:right;padding:10px;color:' + (epargneA >= 3000 ? '#10b981' : epargneA >= 1000 ? '#f59e0b' : '#ef4444') + '">' + fmt(epargneA) + ' $</td>';
  html += '<td style="text-align:right;padding:10px;color:' + (epargneB >= 3000 ? '#10b981' : epargneB >= 1000 ? '#f59e0b' : '#ef4444') + '">' + fmt(epargneB) + ' $</td></tr>';
  
  html += '</tbody></table></div></div>';
  
  // ALERTES
  var alertes = [];
  
  // Alerte d√©s√©quilibre majeur
  if(Math.abs(ratioDetteA - ratioDetteB) > 20 || (ratioDetteA > 50 || ratioDetteB > 50)) {
    alertes.push({
      type: 'danger',
      titre: '‚ö†Ô∏è D√©s√©quilibre financier important d√©tect√©',
      message: 'L\'un des partenaires a un niveau d\'endettement significativement plus √©lev√© (' + 
               (ratioDetteA > ratioDetteB ? 'Personne A: ' + ratioDetteA.toFixed(1) : 'Personne B: ' + ratioDetteB.toFixed(1)) + 
               '%). Ceci peut cr√©er des dynamiques de pouvoir in√©gales. Avant d\'√©tablir un budget commun, consid√©rez un plan de remboursement.'
    });
  }
  
  // Alerte absence d'√©pargne
  if(epargneA < 1000 || epargneB < 1000) {
    var qui = epargneA < 1000 && epargneB < 1000 ? 'Les deux partenaires n\'ont' : 
              (epargneA < 1000 ? 'Personne A n\'a' : 'Personne B n\'a');
    alertes.push({
      type: 'warning',
      titre: '‚ùå Absence de fonds d\'urgence',
      message: qui + ' pas de fonds d\'urgence ad√©quat (minimum 1 000$). Chaque personne devrait avoir son propre fonds d\'urgence pour maintenir son autonomie financi√®re.'
    });
  }
  
  // Afficher les alertes
  for(var i = 0; i < alertes.length; i++) {
    var a = alertes[i];
    var bg = a.type === 'danger' ? '#fef2f2' : '#fff4e6';
    var border = a.type === 'danger' ? '#dc2626' : '#f97316';
    var color = a.type === 'danger' ? '#7f1d1d' : '#7c2d12';
    
    html += '<div style="background:' + bg + ';border:2px solid ' + border + ';padding:20px;border-radius:10px;margin:20px 0;">';
    html += '<h4 style="color:' + color + ';margin:0 0 10px 0;">' + a.titre + '</h4>';
    html += '<p style="color:' + color + ';margin:0;line-height:1.7;">' + a.message + '</p>';
    html += '</div>';
  }
  
  // Si alertes critiques, arr√™ter l√†
  if(alertes.length > 0 && (ratioDetteA > 50 || ratioDetteB > 50)) {
    html += '<div style="background:#fee2e2;padding:20px;border-radius:10px;margin:20px 0;border-left:6px solid #dc2626;">';
    html += '<strong style="color:#991b1b;font-size:1.1em;">üõë Recommandation : Stabilisez d\'abord vos situations individuelles</strong>';
    html += '<p style="margin:10px 0 0 0;color:#7f1d1d;line-height:1.7;">Avant de cr√©er un budget commun, il est pr√©f√©rable de consulter un conseiller financier (ACEF) pour √©tablir des plans de remboursement de dettes individuels.</p>';
    html += '</div>';
    document.getElementById('resultats-couple').innerHTML = html;
    return;
  }
  
  // ===== CALCULS DE R√âPARTITION =====
  
  if(depensesCommunes === 0) {
    html += '<div class="card"><p style="color:#6b7280;">Entrez vos d√©penses communes pour voir les calculs de r√©partition.</p></div>';
    document.getElementById('resultats-couple').innerHTML = html;
    return;
  }
  
  var totalDispo = revenuDispoA + revenuDispoB;
  
  // M√©thode 1 : 50/50
  var paiement5050A = depensesCommunes / 2;
  var paiement5050B = depensesCommunes / 2;
  var reste5050A = revenuDispoA - paiement5050A;
  var reste5050B = revenuDispoB - paiement5050B;
  var epargne5050A = revenuDispoA > 0 ? (reste5050A / revenuDispoA * 100) : 0;
  var epargne5050B = revenuDispoB > 0 ? (reste5050B / revenuDispoB * 100) : 0;
  
  // M√©thode 2 : Proportionnelle aux revenus
  var pctA = revenuA / (revenuA + revenuB);
  var pctB = revenuB / (revenuA + revenuB);
  var paiementPropA = depensesCommunes * pctA;
  var paiementPropB = depensesCommunes * pctB;
  var restePropA = revenuDispoA - paiementPropA;
  var restePropB = revenuDispoB - paiementPropB;
  var epargnePropA = revenuDispoA > 0 ? (restePropA / revenuDispoA * 100) : 0;
  var epargnePropB = revenuDispoB > 0 ? (restePropB / revenuDispoB * 100) : 0;
  
  // M√©thode 3 : Capacit√© d'√©pargne √©gale
  var epargneViseeA = revenuDispoA * tauxEpargne;
  var epargneViseeB = revenuDispoB * tauxEpargne;
  var resteApresEpargne = totalDispo - epargneViseeA - epargneViseeB;
  
  var paiementCapaA, paiementCapaB;
  if(resteApresEpargne >= depensesCommunes) {
    paiementCapaA = (revenuDispoA / totalDispo) * depensesCommunes;
    paiementCapaB = (revenuDispoB / totalDispo) * depensesCommunes;
  } else {
    paiementCapaA = (revenuDispoA / totalDispo) * depensesCommunes;
    paiementCapaB = (revenuDispoB / totalDispo) * depensesCommunes;
  }
  
  var resteCapaA = revenuDispoA - paiementCapaA;
  var resteCapaB = revenuDispoB - paiementCapaB;
  var epargneCapaA = revenuDispoA > 0 ? (resteCapaA / revenuDispoA * 100) : 0;
  var epargneCapaB = revenuDispoB > 0 ? (resteCapaB / revenuDispoB * 100) : 0;
  
  // Afficher les 3 m√©thodes
  html += '<div class="card" style="margin-top:30px;">';
  html += '<h3 style="color:#1f2937;">üí∞ Comparaison des m√©thodes de r√©partition</h3>';
  
  html += '<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:20px;margin-top:20px;">';
  
  // M√©thode 1
  html += '<div style="background:#f3f4f6;padding:20px;border-radius:10px;border-left:4px solid #6b7280;">';
  html += '<h4 style="color:#374151;margin:0 0 15px 0;">1Ô∏è‚É£ Parts √©gales (50/50)</h4>';
  html += '<p style="margin:5px 0;"><strong>Personne A :</strong> ' + fmt(paiement5050A) + ' $/mois</p>';
  html += '<p style="margin:5px 0;color:#6b7280;">Reste : ' + fmt(reste5050A) + ' $ (' + epargne5050A.toFixed(1) + '% √©pargne)</p>';
  html += '<p style="margin:5px 0;"><strong>Personne B :</strong> ' + fmt(paiement5050B) + ' $/mois</p>';
  html += '<p style="margin:5px 0;color:#6b7280;">Reste : ' + fmt(reste5050B) + ' $ (' + epargne5050B.toFixed(1) + '% √©pargne)</p>';
var diff5050 = Math.abs(epargne5050A - epargne5050B);
  html += '<p style="margin-top:10px;padding-top:10px;border-top:1px solid #d1d5db;color:' + (reste5050A < 0 || reste5050B < 0 ? '#dc2626' : diff5050 > 10 ? '#ef4444' : '#f59e0b') + ';font-weight:600;">';
  
  if(reste5050A < 0 || reste5050B < 0) {
    var qui = reste5050A < 0 ? 'Personne A' : 'Personne B';
    var manque = Math.abs(reste5050A < 0 ? reste5050A : reste5050B);
    html += 'üö´ IMPOSSIBLE';
    html += '<br><small style="font-weight:normal;">' + qui + ' n\'a pas assez d\'argent (manque ' + fmt(manque) + ' $)</small>';
  } else if(diff5050 > 10) {
    html += '‚ùå Tr√®s in√©quitable';
    html += '<br><small style="font-weight:normal;">√âcart d\'√©pargne : ' + diff5050.toFixed(1) + '%</small>';
  } else {
    html += '‚ö†Ô∏è In√©quitable';
    html += '<br><small style="font-weight:normal;">√âcart d\'√©pargne : ' + diff5050.toFixed(1) + '%</small>';
  }
  html += '</p>';
  html += '</div>';
  
  // M√©thode 2
  html += '<div style="background:#fef3c7;padding:20px;border-radius:10px;border-left:4px solid #f59e0b;">';
  html += '<h4 style="color:#92400e;margin:0 0 15px 0;">2Ô∏è‚É£ Proportionnelle aux revenus</h4>';
  html += '<p style="margin:5px 0;"><strong>Personne A :</strong> ' + fmt(paiementPropA) + ' $/mois (' + (pctA * 100).toFixed(1) + '%)</p>';
  html += '<p style="margin:5px 0;color:#78350f;">Reste : ' + fmt(restePropA) + ' $ (' + epargnePropA.toFixed(1) + '% √©pargne)</p>';
  html += '<p style="margin:5px 0;"><strong>Personne B :</strong> ' + fmt(paiementPropB) + ' $/mois (' + (pctB * 100).toFixed(1) + '%)</p>';
  html += '<p style="margin:5px 0;color:#78350f;">Reste : ' + fmt(restePropB) + ' $ (' + epargnePropB.toFixed(1) + '% √©pargne)</p>';
var diffProp = Math.abs(epargnePropA - epargnePropB);
  html += '<p style="margin-top:10px;padding-top:10px;border-top:1px solid #fcd34d;color:' + (restePropA < 0 || restePropB < 0 ? '#dc2626' : diffProp > 10 ? '#f59e0b' : '#10b981') + ';font-weight:600;">';
  
  if(restePropA < 0 || restePropB < 0) {
    var qui = restePropA < 0 ? 'Personne A' : 'Personne B';
    var manque = Math.abs(restePropA < 0 ? restePropA : restePropB);
    html += 'üö´ IMPOSSIBLE';
    html += '<br><small style="font-weight:normal;">' + qui + ' n\'a pas assez d\'argent (manque ' + fmt(manque) + ' $)</small>';
  } else if(diffProp > 10) {
    html += '‚ö†Ô∏è Encore in√©quitable';
    html += '<br><small style="font-weight:normal;">√âcart d\'√©pargne : ' + diffProp.toFixed(1) + '%</small>';
  } else {
    html += '‚úÖ Acceptable';
    html += '<br><small style="font-weight:normal;">√âcart d\'√©pargne : ' + diffProp.toFixed(1) + '%</small>';
  }
  html += '</p>';
  html += '</div>';
  
  // M√©thode 3
  html += '<div style="background:#d1fae5;padding:20px;border-radius:10px;border-left:4px solid #10b981;">';
  html += '<h4 style="color:#065f46;margin:0 0 15px 0;">3Ô∏è‚É£ Capacit√© d\'√©pargne √©gale ‚≠ê</h4>';
  html += '<p style="margin:5px 0;"><strong>Personne A :</strong> ' + fmt(paiementCapaA) + ' $/mois</p>';
  html += '<p style="margin:5px 0;color:#047857;">Reste : ' + fmt(resteCapaA) + ' $ (' + epargneCapaA.toFixed(1) + '% √©pargne)</p>';
  html += '<p style="margin:5px 0;"><strong>Personne B :</strong> ' + fmt(paiementCapaB) + ' $/mois</p>';
  html += '<p style="margin:5px 0;color:#047857;">Reste : ' + fmt(resteCapaB) + ' $ (' + epargneCapaB.toFixed(1) + '% √©pargne)</p>';
  var diffCapa = Math.abs(epargneCapaA - epargneCapaB);
  html += '<p style="margin-top:10px;padding-top:10px;border-top:1px solid #6ee7b7;color:#10b981;font-weight:600;">';
  html += '‚úÖ M√©thode √©quitable';
  html += '<br><small style="font-weight:normal;">√âcart d\'√©pargne : ' + diffCapa.toFixed(1) + '%</small></p>';
  html += '</div>';
  
  html += '</div></div>';
  
  // Recommandation finale
  html += '<div style="background:#eff6ff;padding:25px;border-radius:12px;margin-top:20px;border-left:6px solid #2563eb;">';
  html += '<h3 style="color:#1e40af;margin:0 0 15px 0;">üí° Recommandation</h3>';
  html += '<p style="margin:0 0 10px 0;line-height:1.7;">La <strong>m√©thode 3 (Capacit√© d\'√©pargne √©gale)</strong> est la plus √©quitable selon les principes de finances de couple.</p>';
  html += '<p style="margin:0;line-height:1.7;">Elle garantit que chacun conserve la m√™me <strong>capacit√© d\'√©pargne et de libert√© financi√®re</strong> apr√®s toutes les d√©penses, ce qui respecte la contribution de chacun selon ses moyens r√©els.</p>';
  html += '</div>';
  
  document.getElementById('resultats-couple').innerHTML = html;
}

function calcPlaisirs() {
  // R√©cup√©rer les inputs de base
  var revenu = parseFloat(document.getElementById('plaisirs-revenu').value) || 0;
  var essentielles = parseFloat(document.getElementById('plaisirs-essentielles').value) || 0;
  var epargnePct = (parseFloat(document.getElementById('plaisirs-epargne-pct').value) || 20) / 100;
  
  // Budget loisirs disponible
  var epargneVisee = revenu * epargnePct;
  var budgetDisponible = revenu - essentielles - epargneVisee;
  var budgetRecommande30 = revenu * 0.30; // R√®gle 50/30/20
  
  // Affichage budget disponible
  var htmlBudget = '<div style="background:#eff6ff;padding:20px;border-radius:10px;margin-top:20px;">';
  htmlBudget += '<h4 style="color:#1e40af;margin:0 0 15px 0;">üìä Ton budget</h4>';
  htmlBudget += '<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;">';
  
  htmlBudget += '<div><p style="margin:0;color:#6b7280;font-size:0.9em;">Revenu mensuel</p>';
  htmlBudget += '<p style="margin:5px 0 0 0;font-size:1.5em;font-weight:bold;color:#1f2937;">' + fmt(revenu) + ' $</p></div>';
  
  htmlBudget += '<div><p style="margin:0;color:#6b7280;font-size:0.9em;">D√©penses essentielles</p>';
  htmlBudget += '<p style="margin:5px 0 0 0;font-size:1.5em;font-weight:bold;color:#1f2937;">' + fmt(essentielles) + ' $</p></div>';
  
  htmlBudget += '<div><p style="margin:0;color:#6b7280;font-size:0.9em;">√âpargne vis√©e (' + (epargnePct*100) + '%)</p>';
  htmlBudget += '<p style="margin:5px 0 0 0;font-size:1.5em;font-weight:bold;color:#10b981;">' + fmt(epargneVisee) + ' $</p></div>';
  
  htmlBudget += '<div><p style="margin:0;color:#6b7280;font-size:0.9em;">Budget loisirs disponible</p>';
  htmlBudget += '<p style="margin:5px 0 0 0;font-size:1.5em;font-weight:bold;color:#2563eb;">' + fmt(budgetDisponible) + ' $</p></div>';
  
  htmlBudget += '</div>';
  
  htmlBudget += '<div style="background:#dbeafe;padding:12px;border-radius:6px;margin-top:15px;">';
  htmlBudget += '<small style="color:#1e40af;">üí° Selon la r√®gle 50/30/20, ton budget loisirs recommand√© est <strong>' + fmt(budgetRecommande30) + ' $/mois</strong></small>';
  htmlBudget += '</div>';
  
  htmlBudget += '</div>';
  document.getElementById('budget-disponible').innerHTML = htmlBudget;
  
  // Calcul des abonnements avec co√ªt par utilisation
  var abonnements = [
    {id: 'netflix', nom: 'Streaming'},
    {id: 'musique', nom: 'Musique'},
    {id: 'gym', nom: 'Gym'},
    {id: 'jeux', nom: 'Jeux vid√©o'},
    {id: 'cafe', nom: 'Caf√©'},
    {id: 'autre', nom: 'Autre'}
  ];
  
  var totalAbonnements = 0;
  var abonnementsInutilises = [];
  
  for(var i = 0; i < abonnements.length; i++) {
    var abo = abonnements[i];
    var cout = parseFloat(document.getElementById('abo-' + abo.id).value) || 0;
    var freq = parseFloat(document.getElementById('abo-' + abo.id + '-freq').value) || 0;
    totalAbonnements += cout;
    
    var coutDiv = document.getElementById('abo-' + abo.id + '-cout');
    if(cout > 0 && freq > 0) {
      var coutParUtil = cout / freq;
      var couleur = coutParUtil < 5 ? '#10b981' : coutParUtil < 15 ? '#f59e0b' : '#ef4444';
      var verdict = coutParUtil < 5 ? '‚úÖ' : coutParUtil < 15 ? '‚ö†Ô∏è' : '‚ùå';
      coutDiv.innerHTML = verdict + ' ' + fmt(coutParUtil) + '$/util';
      coutDiv.style.color = couleur;
      coutDiv.style.fontWeight = 'bold';
      
      if(freq < 2 && cout > 10) {
        abonnementsInutilises.push({nom: abo.nom, cout: cout, freq: freq});
      }
    } else if(cout > 0 && freq === 0) {
      coutDiv.innerHTML = '‚ö†Ô∏è Non utilis√©';
      coutDiv.style.color = '#ef4444';
      abonnementsInutilises.push({nom: abo.nom, cout: cout, freq: 0});
    } else {
      coutDiv.innerHTML = '-';
      coutDiv.style.color = '#6b7280';
    }
  }
  
  document.getElementById('total-abonnements').textContent = fmt(totalAbonnements) + ' $';
  document.getElementById('total-abonnements-an').textContent = fmt(totalAbonnements * 12) + ' $';
  
  // Calcul des d√©penses variables
  var totalVariables = 
    (parseFloat(document.getElementById('var-resto').value) || 0) +
    (parseFloat(document.getElementById('var-bars').value) || 0) +
    (parseFloat(document.getElementById('var-spectacles').value) || 0) +
    (parseFloat(document.getElementById('var-shopping').value) || 0) +
    (parseFloat(document.getElementById('var-hobbies').value) || 0) +
    (parseFloat(document.getElementById('var-autres').value) || 0);
  
  document.getElementById('total-variables').textContent = fmt(totalVariables) + ' $';
  
  // Total d√©penses plaisirs
  var totalPlaisirs = totalAbonnements + totalVariables;
  
  // Calcul projet
  var projetNom = document.getElementById('projet-nom').value || 'Projet';
  var projetCout = parseFloat(document.getElementById('projet-cout').value) || 0;
  var projetMois = parseFloat(document.getElementById('projet-mois').value) || 12;
  
  var htmlProjet = '';
  if(projetCout > 0) {
    var epargneMensuelle = projetCout / projetMois;
    var pctBudget = budgetDisponible > 0 ? (epargneMensuelle / budgetDisponible * 100) : 0;
    
    htmlProjet += '<div style="background:#fef3c7;padding:20px;border-radius:10px;margin-top:20px;">';
    htmlProjet += '<h4 style="color:#92400e;margin:0 0 10px 0;">üéØ ' + projetNom + '</h4>';
    htmlProjet += '<p style="margin:5px 0;">Co√ªt total : <strong>' + fmt(projetCout) + ' $</strong></p>';
    htmlProjet += '<p style="margin:5px 0;">D√©lai : <strong>' + projetMois + ' mois</strong></p>';
    htmlProjet += '<p style="margin:5px 0;font-size:1.2em;color:#92400e;">√âpargne n√©cessaire : <strong>' + fmt(epargneMensuelle) + ' $/mois</strong></p>';
    htmlProjet += '<p style="margin:10px 0 0 0;padding-top:10px;border-top:1px solid #fcd34d;color:#78350f;">';
    htmlProjet += 'Ceci repr√©sente <strong>' + pctBudget.toFixed(1) + '%</strong> de ton budget loisirs disponible.';
    htmlProjet += '</p>';
    
var margeActuelle = budgetDisponible - totalPlaisirs;

if(epargneMensuelle <= margeActuelle) {
  htmlProjet += '<p style="margin:10px 0 0 0;color:#047857;font-weight:600;">‚úÖ Tu peux √©pargner pour ce projet avec ta marge actuelle de ' + fmt(margeActuelle) + ' $/mois !</p>';
} else {
  var aReducer = epargneMensuelle - margeActuelle;
  var nouveauDelai = Math.ceil(projetCout / margeActuelle);
  
  htmlProjet += '<div style="background:#fff4e6;padding:15px;border-radius:8px;margin-top:10px;">';
  htmlProjet += '<p style="margin:0 0 10px 0;color:#9a3412;font-weight:600;">‚ö†Ô∏è Ta marge actuelle : ' + fmt(margeActuelle) + ' $/mois</p>';
  htmlProjet += '<p style="margin:0 0 10px 0;color:#7c2d12;">Pour √©pargner ' + fmt(epargneMensuelle) + ' $/mois, tu as <strong>3 options</strong> :</p>';
  htmlProjet += '<ul style="margin:0 0 0 20px;color:#7c2d12;line-height:1.8;">';
  htmlProjet += '<li><strong>Option 1 :</strong> R√©duire tes d√©penses plaisirs de ' + fmt(aReducer) + ' $/mois</li>';
  htmlProjet += '<li><strong>Option 2 :</strong> Prolonger le d√©lai √† ' + nouveauDelai + ' mois (avec ta marge actuelle)</li>';
  htmlProjet += '<li><strong>Option 3 :</strong> R√©duire le co√ªt du projet √† ' + fmt(margeActuelle * projetMois) + ' $</li>';
  htmlProjet += '</ul>';
  htmlProjet += '</div>';
}
    
    htmlProjet += '</div>';
  }
  document.getElementById('resultat-projet').innerHTML = htmlProjet;
  
  // Si aucune donn√©e, ne pas afficher les r√©sultats
  if(revenu === 0) {
    document.getElementById('resultats-plaisirs').innerHTML = '';
    return;
  }
  
  // ===== R√âSULTATS GLOBAUX =====
  var html = '';
  
  // Tableau r√©capitulatif
  html += '<div class="card" style="margin-top:30px;">';
  html += '<h3 style="color:#1f2937;">üìä Tableau de bord de tes plaisirs</h3>';
  
  var resto = parseFloat(document.getElementById('var-resto').value) || 0;
  var bars = parseFloat(document.getElementById('var-bars').value) || 0;
  var spectacles = parseFloat(document.getElementById('var-spectacles').value) || 0;
  var shopping = parseFloat(document.getElementById('var-shopping').value) || 0;
  var hobbies = parseFloat(document.getElementById('var-hobbies').value) || 0;
  var autres = parseFloat(document.getElementById('var-autres').value) || 0;
  
  html += '<div style="overflow-x:auto;margin-top:20px;">';
  html += '<table style="width:100%;border-collapse:collapse;">';
  html += '<thead style="background:#f9fafb;"><tr>';
  html += '<th style="text-align:left;padding:12px;border-bottom:2px solid #e5e7eb;">Cat√©gorie</th>';
  html += '<th style="text-align:right;padding:12px;border-bottom:2px solid #e5e7eb;">Montant</th>';
  html += '<th style="text-align:right;padding:12px;border-bottom:2px solid #e5e7eb;">% du total</th>';
  html += '</tr></thead><tbody>';
  
  var categories = [
    {nom: 'Abonnements', valeur: totalAbonnements},
    {nom: 'Restaurants/Livraison', valeur: resto},
    {nom: 'Bars/Sorties', valeur: bars},
    {nom: 'Cin√©ma/Spectacles', valeur: spectacles},
    {nom: 'Shopping', valeur: shopping},
    {nom: 'Hobbies', valeur: hobbies},
    {nom: 'Autres', valeur: autres}
  ];
  
  for(var i = 0; i < categories.length; i++) {
    var cat = categories[i];
    if(cat.valeur > 0) {
      var pct = totalPlaisirs > 0 ? (cat.valeur / totalPlaisirs * 100) : 0;
      html += '<tr><td style="padding:10px;border-bottom:1px solid #e5e7eb;">' + cat.nom + '</td>';
      html += '<td style="text-align:right;padding:10px;border-bottom:1px solid #e5e7eb;">' + fmt(cat.valeur) + ' $</td>';
      html += '<td style="text-align:right;padding:10px;border-bottom:1px solid #e5e7eb;">' + pct.toFixed(1) + '%</td></tr>';
    }
  }
  
  html += '<tr style="background:#f9fafb;font-weight:bold;"><td style="padding:12px;border-top:2px solid #e5e7eb;">TOTAL</td>';
  html += '<td style="text-align:right;padding:12px;border-top:2px solid #e5e7eb;">' + fmt(totalPlaisirs) + ' $</td>';
  html += '<td style="text-align:right;padding:12px;border-top:2px solid #e5e7eb;">100%</td></tr>';
  
  html += '</tbody></table></div>';
  
  // Comparaison budget disponible vs d√©pens√©
  html += '<div style="margin-top:20px;padding:20px;background:#f3f4f6;border-radius:10px;">';
  html += '<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;">';
  
  html += '<div><p style="margin:0;color:#6b7280;font-size:0.9em;">Budget recommand√© (30%)</p>';
  html += '<p style="margin:5px 0 0 0;font-size:1.3em;font-weight:bold;color:#6b7280;">' + fmt(budgetRecommande30) + ' $</p></div>';
  
  html += '<div><p style="margin:0;color:#6b7280;font-size:0.9em;">Budget disponible (r√©el)</p>';
  html += '<p style="margin:5px 0 0 0;font-size:1.3em;font-weight:bold;color:#2563eb;">' + fmt(budgetDisponible) + ' $</p></div>';
  
  html += '<div><p style="margin:0;color:#6b7280;font-size:0.9em;">Tu d√©penses actuellement</p>';
  html += '<p style="margin:5px 0 0 0;font-size:1.3em;font-weight:bold;color:' + (totalPlaisirs > budgetDisponible ? '#ef4444' : '#10b981') + '">' + fmt(totalPlaisirs) + ' $</p></div>';
  
  var diff = budgetDisponible - totalPlaisirs;
  html += '<div><p style="margin:0;color:#6b7280;font-size:0.9em;">' + (diff > 0 ? 'D√©passement' : 'Marge restante') + '</p>';
  html += '<p style="margin:5px 0 0 0;font-size:1.3em;font-weight:bold;color:' + (diff > 0 ? '#ef4444' : '#10b981') + '">' + (diff > 0 ? '+' : '') + fmt(diff) + ' $</p></div>';
  
  html += '</div></div>';
  html += '</div>';
  
  // Diagnostic et recommandations
  if(totalPlaisirs > budgetDisponible) {
    var depassement = totalPlaisirs - budgetDisponible;
    var pctDepassement = budgetDisponible > 0 ? (depassement / budgetDisponible * 100) : 0;
    
    html += '<div style="background:#fee2e2;border-left:6px solid #dc2626;padding:25px;border-radius:12px;margin-top:20px;">';
    html += '<h4 style="color:#991b1b;margin:0 0 10px 0;">‚ö†Ô∏è Tu d√©passes ton budget loisirs</h4>';
    html += '<p style="margin:0 0 10px 0;color:#7f1d1d;">D√©passement : <strong>' + fmt(depassement) + ' $/mois</strong> (' + pctDepassement.toFixed(1) + '%)</p>';
    html += '<p style="margin:0 0 10px 0;color:#7f1d1d;">Sur un an, cela repr√©sente <strong>' + fmt(depassement * 12) + ' $</strong> qui pourraient √™tre √©pargn√©s ou investis.</p>';
    
    if(abonnementsInutilises.length > 0) {
      html += '<div style="background:#fef2f2;padding:15px;border-radius:8px;margin-top:15px;">';
      html += '<strong style="color:#991b1b;">üí° Opportunit√©s d\'√©conomies d√©tect√©es :</strong>';
      html += '<ul style="margin:10px 0 0 20px;color:#7f1d1d;line-height:1.8;">';
      var economiesPotentielles = 0;
      for(var i = 0; i < abonnementsInutilises.length; i++) {
        var abo = abonnementsInutilises[i];
        economiesPotentielles += abo.cout;
        html += '<li><strong>' + abo.nom + '</strong> : ' + fmt(abo.cout) + ' $/mois ';
        html += '(' + (abo.freq === 0 ? 'jamais utilis√©' : 'utilis√© < 2x/mois') + ')</li>';
      }
      html += '</ul>';
      html += '<p style="margin:10px 0 0 0;color:#991b1b;font-weight:600;">En annulant ces abonnements : ' + fmt(economiesPotentielles) + ' $/mois √©conomis√©s = ' + fmt(economiesPotentielles * 12) + ' $/an !</p>';
      html += '</div>';
    }
    
    html += '</div>';
    
  } else if(totalPlaisirs > 0) {
    var marge = budgetDisponible - totalPlaisirs;
    html += '<div style="background:#d1fae5;border-left:6px solid #10b981;padding:25px;border-radius:12px;margin-top:20px;">';
    html += '<h4 style="color:#065f46;margin:0 0 10px 0;">‚úÖ Bravo ! Tu g√®res bien ton budget plaisirs</h4>';
    html += '<p style="margin:0 0 10px 0;color:#047857;">Il te reste <strong>' + fmt(marge) + ' $/mois</strong> dans ton budget loisirs.</p>';
    html += '<p style="margin:0;color:#047857;">Tu peux :</p>';
    html += '<ul style="margin:10px 0 0 20px;color:#047857;line-height:1.8;">';
    html += '<li>√âpargner pour un gros projet (voyage, √©quipement)</li>';
    html += '<li>Augmenter ton √©pargne g√©n√©rale</li>';
    html += '<li>Te permettre une d√©pense plaisir occasionnelle</li>';
    html += '</ul>';
    html += '</div>';
  }
  
  // Alerte si abonnements > 50% du budget plaisirs
  if(totalPlaisirs > 0 && totalAbonnements / totalPlaisirs > 0.5) {
    var pctAbo = (totalAbonnements / totalPlaisirs * 100);
    html += '<div style="background:#fff4e6;border-left:4px solid #f97316;padding:20px;border-radius:10px;margin-top:20px;">';
    html += '<strong style="color:#9a3412;">‚ö†Ô∏è ' + pctAbo.toFixed(0) + '% de ton budget plaisirs est en abonnements</strong>';
    html += '<p style="margin:10px 0 0 0;color:#7c2d12;">La moiti√© (ou plus) de ton budget plaisirs part en abonnements automatiques. Assure-toi que tu les utilises vraiment !</p>';
    html += '</div>';
  }
  
  document.getElementById('resultats-plaisirs').innerHTML = html;
}

function calcAcheterLouer() {
  // R√©cup√©rer les inputs
  var prixAchat = parseFloat(document.getElementById('al-prix').value) || 0;
  var miseFondsPct = parseFloat(document.getElementById('al-mise-fonds-pct').value) / 100;
  var tauxHypo = (parseFloat(document.getElementById('al-taux-hypo').value) || 5) / 100;
  var amortissement = parseInt(document.getElementById('al-amortissement').value) || 25;
  var taxesAn = parseFloat(document.getElementById('al-taxes').value) || 0;
  var entretienAn = parseFloat(document.getElementById('al-entretien').value) || 0;
  var assuranceAn = parseFloat(document.getElementById('al-assurance').value) || 0;
  
  var loyer = parseFloat(document.getElementById('al-loyer').value) || 0;
  var depotGarantie = parseFloat(document.getElementById('al-depot-garantie').value) || 0;
  var augmentationLoyer = (parseFloat(document.getElementById('al-augmentation-loyer').value) || 3) / 100;
  var rendement = (parseFloat(document.getElementById('al-rendement').value) || 6) / 100;
  
  var duree = parseInt(document.getElementById('al-duree').value) || 10;
  var appreciation = (parseFloat(document.getElementById('al-appreciation').value) || 3) / 100;
  var fraisVente = (parseFloat(document.getElementById('al-frais-vente').value) || 6) / 100;
  
  // Si aucune donn√©e, ne pas afficher
  if(prixAchat === 0 || loyer === 0) {
    document.getElementById('resultats-acheter-louer').innerHTML = '';
    return;
  }
  
  // ===== SC√âNARIO ACHAT =====
  
  var miseFonds = prixAchat * miseFondsPct;
  var montantHypo = prixAchat - miseFonds;
  
  // Frais SCHL si mise de fonds < 20%
  var fraisSCHL = 0;
  if(miseFondsPct < 0.20) {
    var ratioEmprunt = 1 - miseFondsPct;
    var tauxPrime = ratioEmprunt > 0.95 ? 0.04 : ratioEmprunt > 0.90 ? 0.031 : ratioEmprunt > 0.85 ? 0.028 : 0.024;
    fraisSCHL = montantHypo * tauxPrime;
    montantHypo += fraisSCHL;
  }
  
  // Frais de notaire et inspection (estim√©s √† 2-3% du prix)
  var fraisAchat = prixAchat * 0.025;
  
  // Taxe de bienvenue
  var taxeBienvenue = 0;
  if(prixAchat <= 58900) {
    taxeBienvenue = prixAchat * 0.005;
  } else if(prixAchat <= 294600) {
    taxeBienvenue = 58900 * 0.005 + (prixAchat - 58900) * 0.01;
  } else {
    taxeBienvenue = 58900 * 0.005 + (294600 - 58900) * 0.01 + (prixAchat - 294600) * 0.015;
  }
  
  // Paiement hypoth√©caire mensuel
  var tauxMensuel = tauxHypo / 12;
  var nMois = amortissement * 12;
  var paiementHypoMensuel = (montantHypo * tauxMensuel) / (1 - Math.pow(1 + tauxMensuel, -nMois));
  
  // Simulation ann√©e par ann√©e
  var soldeHypo = montantHypo;
  var coutTotalAchat = miseFonds + fraisAchat + taxeBienvenue + fraisSCHL;
  var interetsPayes = 0;
  var valeurMaison = prixAchat;
  
  for(var annee = 1; annee <= duree; annee++) {
    // Paiements hypoth√©caires de l'ann√©e
    var interetsAnnee = 0;
    var capitalAnnee = 0;
    var paiementsHypoAnnee = 0;
    
    for(var mois = 0; mois < 12 && soldeHypo > 0; mois++) {
      var interetsMois = soldeHypo * tauxMensuel;
      var capitalMois = Math.min(paiementHypoMensuel - interetsMois, soldeHypo);
      var paiementReel = Math.min(paiementHypoMensuel, interetsMois + capitalMois);
      
      interetsAnnee += interetsMois;
      capitalAnnee += capitalMois;
      paiementsHypoAnnee += paiementReel;
      soldeHypo -= capitalMois;
    }
    
    interetsPayes += interetsAnnee;
    
    // Frais annuels - utiliser les paiements R√âELS
    coutTotalAchat += paiementsHypoAnnee + taxesAn + entretienAn + assuranceAn;
    
    // Appr√©ciation de la maison
    valeurMaison *= (1 + appreciation);
  }
  
  // Valeur nette √† la fin (√©quit√©)
  var equiteFin = valeurMaison - soldeHypo;
  var fraisVenteFinaux = valeurMaison * fraisVente;
  var gainNetVente = equiteFin - fraisVenteFinaux;
  
  var coutNetAchat = coutTotalAchat - gainNetVente;
  
  // ===== SC√âNARIO LOCATION =====
  
  var coutTotalLocation = 0;
  var loyerActuel = loyer;
  var fraisLocationInitiaux = loyer * (1 + depotGarantie);
  var portefeuilleInvesti = (miseFonds + fraisAchat + taxeBienvenue + fraisSCHL) - fraisLocationInitiaux;
  
  for(var annee = 1; annee <= duree; annee++) {
    // Loyers de l'ann√©e
    coutTotalLocation += loyerActuel * 12;
    
    // Diff√©rence mensuelle investie
    var fraisProprio = (taxesAn + entretienAn + assuranceAn) / 12;
    var differenceMensuelle = (paiementHypoMensuel + fraisProprio) - loyerActuel;
    
    if(differenceMensuelle > 0) {
      // Si louer co√ªte moins cher, on investit la diff√©rence
      for(var mois = 0; mois < 12; mois++) {
        portefeuilleInvesti += differenceMensuelle;
        portefeuilleInvesti *= (1 + rendement / 12);
      }
    } else {
      // Si louer co√ªte plus cher, on retire du portefeuille
      for(var mois = 0; mois < 12; mois++) {
        portefeuilleInvesti += differenceMensuelle;
        portefeuilleInvesti *= (1 + rendement / 12);
      }
    }
    
    // Augmentation du loyer pour l'ann√©e suivante
    loyerActuel *= (1 + augmentationLoyer);
  }
  
  var coutNetLocation = coutTotalLocation - portefeuilleInvesti;
  
  // ===== COMPARAISON =====
  
  var difference = coutNetLocation - coutNetAchat;
  var meilleurChoix = difference > 0 ? 'achat' : 'location';
  
  // ===== AFFICHAGE DES R√âSULTATS =====
  
  var html = '';
  
  // R√©capitulatif des co√ªts initiaux
  html += '<div class="card" style="margin-top:30px;">';
  html += '<h3 style="color:#1f2937;">üí∞ Co√ªts initiaux</h3>';
  html += '<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;margin-top:20px;">';
  
  html += '<div style="background:#eff6ff;padding:20px;border-radius:10px;">';
  html += '<h4 style="color:#1e40af;margin:0 0 10px 0;">Sc√©nario ACHAT</h4>';
  html += '<p style="margin:5px 0;">Mise de fonds : <strong>' + fmt(miseFonds) + ' $</strong></p>';
  html += '<p style="margin:5px 0;">Frais notaire/inspection : <strong>' + fmt(fraisAchat) + ' $</strong></p>';
 html += '<p style="margin:5px 0;">Taxe de bienvenue : <strong>' + fmt(taxeBienvenue) + ' $</strong></p>';
  if(fraisSCHL > 0) {
    html += '<p style="margin:5px 0;color:#dc2626;">Frais SCHL : <strong>' + fmt(fraisSCHL) + ' $</strong></p>';
  }
  html += '<p style="margin:10px 0 0 0;padding-top:10px;border-top:2px solid #bfdbfe;font-size:1.2em;color:#1e40af;"><strong>Total : ' + fmt(miseFonds + fraisAchat + taxeBienvenue + fraisSCHL) + ' $</strong></p>';
  html += '</div>';
  
  html += '<div style="background:#d1fae5;padding:20px;border-radius:10px;">';
  html += '<h4 style="color:#065f46;margin:0 0 10px 0;">Sc√©nario LOCATION</h4>';
  html += '<p style="margin:5px 0;">Premier mois de loyer : <strong>' + fmt(loyer) + ' $</strong></p>';
  if(depotGarantie > 0) {
    html += '<p style="margin:5px 0;">D√©p√¥t de garantie (' + depotGarantie + ' mois) : <strong>' + fmt(loyer * depotGarantie) + ' $</strong></p>';
  }
  var totalLocationInitial = loyer * (1 + depotGarantie);
  html += '<p style="margin:10px 0 0 0;padding-top:10px;border-top:2px solid #6ee7b7;font-size:1.2em;color:#065f46;"><strong>Total : ' + fmt(totalLocationInitial) + ' $</strong></p>';
  html += '<p style="margin:10px 0 0 0;font-size:0.9em;color:#047857;">Capital disponible pour investir : ' + fmt(portefeuilleInvesti) + ' $</strong></p>';
  html += '</div>';
  html += '</div></div>';
  
  // Paiements mensuels
  html += '<div class="card" style="margin-top:20px;">';
  html += '<h3 style="color:#1f2937;">üìÖ Paiements mensuels (ann√©e 1)</h3>';
  html += '<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;margin-top:20px;">';
  
  var fraisProprioMensuel = (taxesAn + entretienAn + assuranceAn) / 12;
  var totalMensuelAchat = paiementHypoMensuel + fraisProprioMensuel;
  
  html += '<div style="background:#eff6ff;padding:20px;border-radius:10px;">';
  html += '<h4 style="color:#1e40af;margin:0 0 10px 0;">ACHAT</h4>';
  html += '<p style="margin:5px 0;">Hypoth√®que : <strong>' + fmt(paiementHypoMensuel) + ' $/mois</strong></p>';
  html += '<p style="margin:5px 0;">Taxes : <strong>' + fmt(taxesAn/12) + ' $/mois</strong></p>';
  html += '<p style="margin:5px 0;">Entretien : <strong>' + fmt(entretienAn/12) + ' $/mois</strong></p>';
  html += '<p style="margin:5px 0;">Assurance : <strong>' + fmt(assuranceAn/12) + ' $/mois</strong></p>';
  html += '<p style="margin:10px 0 0 0;padding-top:10px;border-top:2px solid #bfdbfe;font-size:1.3em;color:#1e40af;"><strong>' + fmt(totalMensuelAchat) + ' $/mois</strong></p>';
  html += '</div>';
  
  html += '<div style="background:#d1fae5;padding:20px;border-radius:10px;">';
  html += '<h4 style="color:#065f46;margin:0 0 10px 0;">LOCATION</h4>';
  html += '<p style="margin:5px 0;">Loyer : <strong>' + fmt(loyer) + ' $/mois</strong></p>';
  html += '<p style="margin:10px 0 0 0;padding-top:10px;border-top:2px solid #6ee7b7;font-size:1.3em;color:#065f46;"><strong>' + fmt(loyer) + ' $/mois</strong></p>';
  var diff = totalMensuelAchat - loyer;
  html += '<p style="margin:10px 0 0 0;font-size:0.9em;color:' + (diff > 0 ? '#047857' : '#dc2626') + ';">';
  html += diff > 0 ? '√âconomie de ' + fmt(diff) + ' $/mois √† investir' : 'Co√ªt suppl√©mentaire de ' + fmt(Math.abs(diff)) + ' $/mois';
  html += '</p>';
  html += '</div>';
  html += '</div></div>';
  
  // R√©sultats apr√®s X ann√©es
  html += '<div class="card" style="margin-top:20px;">';
  html += '<h3 style="color:#1f2937;">üìä Comparaison apr√®s ' + duree + ' ans</h3>';
  html += '<div style="overflow-x:auto;margin-top:20px;">';
  html += '<table style="width:100%;border-collapse:collapse;">';
  html += '<thead style="background:#f9fafb;"><tr>';
  html += '<th style="text-align:left;padding:12px;border-bottom:2px solid #e5e7eb;">Crit√®re</th>';
  html += '<th style="text-align:right;padding:12px;border-bottom:2px solid #e5e7eb;">ACHAT</th>';
  html += '<th style="text-align:right;padding:12px;border-bottom:2px solid #e5e7eb;">LOCATION</th>';
  html += '</tr></thead><tbody>';
  
  html += '<tr><td style="padding:10px;border-bottom:1px solid #e5e7eb;">Co√ªts totaux d√©bours√©s</td>';
  html += '<td style="text-align:right;padding:10px;border-bottom:1px solid #e5e7eb;">' + fmt(coutTotalAchat) + ' $</td>';
  html += '<td style="text-align:right;padding:10px;border-bottom:1px solid #e5e7eb;">' + fmt(coutTotalLocation) + ' $</td></tr>';
  
  html += '<tr><td style="padding:10px;border-bottom:1px solid #e5e7eb;">Valeur de la maison</td>';
  html += '<td style="text-align:right;padding:10px;border-bottom:1px solid #e5e7eb;color:#10b981;">' + fmt(valeurMaison) + ' $</td>';
  html += '<td style="text-align:right;padding:10px;border-bottom:1px solid #e5e7eb;">-</td></tr>';
  
  html += '<tr><td style="padding:10px;border-bottom:1px solid #e5e7eb;">Solde hypoth√©caire restant</td>';
  html += '<td style="text-align:right;padding:10px;border-bottom:1px solid #e5e7eb;color:#ef4444;">-' + fmt(soldeHypo) + ' $</td>';
  html += '<td style="text-align:right;padding:10px;border-bottom:1px solid #e5e7eb;">-</td></tr>';
  
  html += '<tr><td style="padding:10px;border-bottom:1px solid #e5e7eb;">√âquit√© (valeur - solde)</td>';
  html += '<td style="text-align:right;padding:10px;border-bottom:1px solid #e5e7eb;color:#10b981;">' + fmt(equiteFin) + ' $</td>';
  html += '<td style="text-align:right;padding:10px;border-bottom:1px solid #e5e7eb;">-</td></tr>';
  
  html += '<tr><td style="padding:10px;border-bottom:1px solid #e5e7eb;">Frais de vente (' + (fraisVente*100).toFixed(1) + '%)</td>';
  html += '<td style="text-align:right;padding:10px;border-bottom:1px solid #e5e7eb;color:#ef4444;">-' + fmt(fraisVenteFinaux) + ' $</td>';
  html += '<td style="text-align:right;padding:10px;border-bottom:1px solid #e5e7eb;">-</td></tr>';
  
  html += '<tr><td style="padding:10px;border-bottom:1px solid #e5e7eb;">Portefeuille investi</td>';
  html += '<td style="text-align:right;padding:10px;border-bottom:1px solid #e5e7eb;">-</td>';
  html += '<td style="text-align:right;padding:10px;border-bottom:1px solid #e5e7eb;color:#10b981;">' + fmt(portefeuilleInvesti) + ' $</td></tr>';
  
  html += '<tr style="background:#f9fafb;font-weight:bold;font-size:1.1em;"><td style="padding:15px;border-top:2px solid #e5e7eb;">CO√õT NET FINAL</td>';
  html += '<td style="text-align:right;padding:15px;border-top:2px solid #e5e7eb;color:' + (coutNetAchat < coutNetLocation ? '#10b981' : '#ef4444') + '">' + fmt(coutNetAchat) + ' $</td>';
  html += '<td style="text-align:right;padding:15px;border-top:2px solid #e5e7eb;color:' + (coutNetLocation < coutNetAchat ? '#10b981' : '#ef4444') + '">' + fmt(coutNetLocation) + ' $</td></tr>';
  
  html += '</tbody></table></div>';
  html += '</div>';
  
  // Note explicative
  html += '<div style="background:#f0f9ff;padding:15px;border-radius:8px;margin-top:15px;border-left:4px solid #2563eb;">';
  html += '<p style="margin:0;font-size:0.9em;color:#1e40af;"><strong>üìä Comment lire les r√©sultats :</strong></p>';
  html += '<p style="margin:5px 0 0 0;font-size:0.85em;color:#1e3a8a;">';
  html += '‚Ä¢ Un montant positif = vous payez ce montant<br>';
  html += '‚Ä¢ Un montant n√©gatif = vous gagnez ce montant (votre patrimoine augmente)';
  html += '</p></div>';
  
  // Verdict final
  var couleurVerdict = meilleurChoix === 'achat' ? '#1e40af' : '#047857';
  var bgVerdict = meilleurChoix === 'achat' ? '#eff6ff' : '#d1fae5';
  
  html += '<div style="background:' + bgVerdict + ';border-left:6px solid ' + couleurVerdict + ';padding:25px;border-radius:12px;margin-top:30px;">';
  html += '<h3 style="color:' + couleurVerdict + ';margin:0 0 15px 0;">üéØ Verdict apr√®s ' + duree + ' ans</h3>';
  
  if(meilleurChoix === 'achat') {
    html += '<p style="margin:0 0 10px 0;font-size:1.2em;color:#1e40af;"><strong>ACHETER est plus avantageux de ' + fmt(Math.abs(difference)) + ' $</strong></p>';
    html += '<p style="margin:0;color:#1e3a8a;line-height:1.7;">Dans ce sc√©nario, acheter permet d\'accumuler plus de richesse gr√¢ce √† l\'√©quit√© dans la propri√©t√©, m√™me en tenant compte des frais d\'entretien et des co√ªts de vente.</p>';
  } else {
    html += '<p style="margin:0 0 10px 0;font-size:1.2em;color:#065f46;"><strong>LOUER est plus avantageux de ' + fmt(Math.abs(difference)) + ' $</strong></p>';
    html += '<p style="margin:0;color:#064e3b;line-height:1.7;">Dans ce sc√©nario, continuer √† louer et investir la diff√©rence dans un portefeuille permet d\'accumuler plus de richesse que l\'achat d\'une propri√©t√©.</p>';
  }
  
  html += '</div>';
  
  // Point mort (break-even)
  html += '<div style="background:#fef3c7;padding:20px;border-radius:10px;margin-top:20px;">';
  html += '<h4 style="color:#92400e;margin:0 0 10px 0;">‚è±Ô∏è Point mort (break-even)</h4>';
  html += '<p style="margin:0;color:#78350f;line-height:1.7;">Pour trouver le point mort exact, il faudrait calculer ann√©e par ann√©e jusqu\'√† ce que les deux options s\'√©galisent. ';
  html += 'G√©n√©ralement, l\'achat devient avantageux apr√®s <strong>5-7 ans</strong> si la maison s\'appr√©cie bien et que vous restez longtemps.</p>';
  html += '</div>';
  
  // Facteurs √† consid√©rer
  html += '<div style="background:#f3f4f6;padding:20px;border-radius:10px;margin-top:20px;">';
  html += '<h4 style="color:#374151;margin:0 0 15px 0;">ü§î Autres facteurs √† consid√©rer</h4>';
  html += '<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:15px;">';
  
  html += '<div><strong style="color:#1f2937;">‚úÖ Avantages ACHAT</strong>';
  html += '<ul style="margin:5px 0 0 20px;color:#6b7280;line-height:1.8;font-size:0.9em;">';
  html += '<li>Stabilit√© du paiement hypoth√©caire</li>';
  html += '<li>Accumulation d\'√©quit√© forc√©e</li>';
  html += '<li>Libert√© de r√©novation</li>';
  html += '<li>Pas de propri√©taire</li>';
  html += '</ul></div>';
  
  html += '<div><strong style="color:#1f2937;">‚úÖ Avantages LOCATION</strong>';
  html += '<ul style="margin:5px 0 0 20px;color:#6b7280;line-height:1.8;font-size:0.9em;">';
  html += '<li>Flexibilit√© g√©ographique</li>';
  html += '<li>Pas de frais d\'entretien</li>';
  html += '<li>Moins de capital immobilis√©</li>';
  html += '<li>Liquidit√© pr√©serv√©e</li>';
  html += '</ul></div>';
  
  html += '</div></div>';
  
  document.getElementById('resultats-acheter-louer').innerHTML = html;
}

</script>

<script>
// === √âCRAN D'ACCUEIL GUID√â ===

// V√©rifier si l'utilisateur a d√©j√† vu l'intro
window.addEventListener('DOMContentLoaded', function() {
  var hasSeenIntro = localStorage.getItem('hasSeenIntro');
  if (hasSeenIntro === 'true') {
    document.getElementById('welcomeModal').style.display = 'none';
  }
});

var currentQuestion = 0;
var userAnswers = {};

var questions = [
  {
    id: 'profil',
    question: 'Quelle est votre situation actuelle ?',
    options: [
      { value: 'etudiant', label: 'üéì √âtudiant / D√©but de carri√®re' },
      { value: 'jeune', label: 'üíº Jeune professionnel (25-35 ans)' },
      { value: 'famille', label: 'üë®‚Äçüë©‚Äçüëß Famille √©tablie (35-50 ans)' },
      { value: 'proche-retraite', label: 'üèñÔ∏è Proche de la retraite (50-65 ans)' },
      { value: 'retraite', label: 'üå¥ Retrait√©' }
    ]
  },
  {
    id: 'priorite',
    question: 'Quelle est votre priorit√© #1 aujourd\'hui ?',
    options: [
      { value: 'comprendre', label: 'üìä Comprendre ma situation financi√®re' },
      { value: 'dettes', label: 'üí≥ Rembourser mes dettes' },
      { value: 'urgence', label: 'üÜò Constituer un fonds d\'urgence' },
      { value: 'epargne', label: 'üéØ √âpargner pour un projet' },
      { value: 'retraite', label: 'üèñÔ∏è Planifier ma retraite' },
      { value: 'maison', label: 'üè† Comparer achat vs location' }
    ]
  },
  {
    id: 'logement',
    question: 'Votre situation de logement actuelle :',
    options: [
      { value: 'locataire', label: 'üîë Locataire' },
      { value: 'proprio-hypo', label: 'üè† Propri√©taire avec hypoth√®que' },
      { value: 'proprio', label: 'üè° Propri√©taire sans hypoth√®que' },
      { value: 'autre', label: 'üë®‚Äçüë©‚Äçüëß Chez mes parents / Autre' }
    ]
  },
  {
    id: 'dettes',
    question: 'Avez-vous des dettes (hors hypoth√®que) ?',
    options: [
      { value: 'aucune', label: '‚úÖ Aucune dette' },
      { value: 'petite', label: 'üìä Moins de 5 000 $' },
      { value: 'moyenne', label: '‚ö†Ô∏è Entre 5 000 $ et 20 000 $' },
      { value: 'grosse', label: 'üö® Plus de 20 000 $' }
    ]
  },
  {
    id: 'urgence',
    question: 'Avez-vous un fonds d\'urgence ?',
    options: [
      { value: 'oui', label: '‚úÖ Oui, au moins 3 mois de d√©penses' },
      { value: 'partiel', label: 'üìä Un peu, mais pas assez' },
      { value: 'non', label: '‚ùå Non, pas encore' }
    ]
  }
];

function startGuide() {
  document.getElementById('welcomeScreen').classList.add('hidden');
  document.getElementById('questionsScreen').classList.remove('hidden');
  currentQuestion = 0;
  showQuestion();
}

function skipGuide() {
  document.getElementById('welcomeModal').style.display = 'none';
  localStorage.setItem('hasSeenIntro', 'true');
}

function showQuestion() {
  var q = questions[currentQuestion];
  var progress = ((currentQuestion + 1) / questions.length * 100);
  
  var html = '<div class="question-container">';
  html += '<div class="progress-bar"><div class="progress-fill" style="width:' + progress + '%"></div></div>';
  html += '<p style="text-align:center;color:#6b7280;margin-bottom:20px;">Question ' + (currentQuestion + 1) + ' sur ' + questions.length + '</p>';
  html += '<h2 class="question-title">' + q.question + '</h2>';
  html += '<div class="options-grid">';
  
  for (var i = 0; i < q.options.length; i++) {
    var opt = q.options[i];
    var selected = userAnswers[q.id] === opt.value ? 'selected' : '';
    html += '<button class="option-btn ' + selected + '" onclick="selectOption(\'' + q.id + '\', \'' + opt.value + '\')">';
    html += opt.label;
    html += '</button>';
  }
  
  html += '</div>';
  html += '<div class="nav-buttons">';
  
  if (currentQuestion > 0) {
    html += '<button class="btn-secondary" onclick="previousQuestion()">‚Üê Pr√©c√©dent</button>';
  } else {
    html += '<button class="btn-secondary" onclick="backToWelcome()">‚Üê Retour</button>';
  }
  
  var disabled = userAnswers[q.id] ? '' : 'disabled';
  var btnText = currentQuestion === questions.length - 1 ? 'Voir mes recommandations ‚Üí' : 'Suivant ‚Üí';
  html += '<button class="btn-primary" ' + disabled + ' onclick="nextQuestion()">' + btnText + '</button>';
  
  html += '</div>';
  html += '</div>';
  
  document.getElementById('questionsScreen').innerHTML = html;
}

function selectOption(questionId, value) {
  userAnswers[questionId] = value;
  showQuestion();
}

function previousQuestion() {
  if (currentQuestion > 0) {
    currentQuestion--;
    showQuestion();
  }
}

function nextQuestion() {
  if (currentQuestion < questions.length - 1) {
    currentQuestion++;
    showQuestion();
  } else {
    showResults();
  }
}

function backToWelcome() {
  document.getElementById('questionsScreen').classList.add('hidden');
  document.getElementById('welcomeScreen').classList.remove('hidden');
  currentQuestion = 0;
  userAnswers = {};
}

function showResults() {
  document.getElementById('questionsScreen').classList.add('hidden');
  document.getElementById('resultsScreen').classList.remove('hidden');
  
  var priorities = [];
  var recommendations = [];
  
  // Analyser les r√©ponses pour g√©n√©rer les recommandations
  
  // Fonds d'urgence
  if (userAnswers.urgence === 'non' || userAnswers.urgence === 'partiel') {
    priorities.push({
      icon: 'üÜò',
      title: 'Constituer un fonds d\'urgence',
      desc: 'Visez 3-6 mois de d√©penses',
      action: 'objectifs'
    });
  }
  
  // Dettes
  if (userAnswers.dettes !== 'aucune') {
    var urgence = userAnswers.dettes === 'grosse' ? 'URGENT : ' : '';
    priorities.push({
      icon: 'üí≥',
      title: urgence + 'Rembourser vos dettes',
      desc: 'Strat√©gie avalanche ou boule de neige',
      action: 'dettes'
    });
  }
  
  // Recommandations selon la priorit√©
  if (userAnswers.priorite === 'comprendre') {
    recommendations.push('Commencez par compl√©ter votre <strong>Bilan</strong>');
  }
  
  if (userAnswers.priorite === 'maison') {
    recommendations.push('Utilisez le calculateur <strong>Acheter vs Louer</strong>');
  }
  
  if (userAnswers.priorite === 'retraite') {
    recommendations.push('Calculez votre <strong>Plan de retraite</strong>');
  }
  
  if (userAnswers.priorite === 'epargne') {
    recommendations.push('D√©finissez vos <strong>Objectifs d\'√©pargne</strong>');
  }
  
  recommendations.push('Calculez votre budget id√©al avec la r√®gle <strong>50/30/20</strong>');
  recommendations.push('Optimisez vos <strong>Imp√¥ts</strong>');
  
  // Construire le HTML
  var html = '<div class="results-container">';
  html += '<div class="welcome-header">';
  html += '<h1>üìã Votre plan d\'action personnalis√©</h1>';
  html += '</div>';
  
  if (priorities.length > 0) {
    html += '<div class="priority-box">';
    html += '<h3>üö® PRIORIT√âS URGENTES</h3>';
    for (var i = 0; i < priorities.length; i++) {
      var p = priorities[i];
      html += '<div class="priority-item">';
      html += '<h4>' + p.icon + ' ' + p.title + '</h4>';
      html += '<p>' + p.desc + '</p>';
      html += '</div>';
    }
    html += '</div>';
  }
  
  html += '<div class="recommendations-box">';
  html += '<h3>üìä RECOMMANDATIONS</h3>';
  html += '<ul>';
  for (var j = 0; j < recommendations.length; j++) {
    html += '<li>‚Ä¢ ' + recommendations[j] + '</li>';
  }
  html += '</ul>';
  html += '</div>';
  
  html += '<div class="final-buttons">';
  html += '<button class="btn-primary" onclick="goToBilan()">üìä Commencer mon bilan</button>';
  html += '<button class="btn-secondary" onclick="closeModal()">Voir tous les outils</button>';
  html += '</div>';
  
  html += '</div>';
  
  document.getElementById('resultsScreen').innerHTML = html;
}

function goToBilan() {
  closeModal();
  changeTab('bilan');
}

function closeModal() {
  document.getElementById('welcomeModal').style.display = 'none';
  localStorage.setItem('hasSeenIntro', 'true');
}
</script>
```

---

## üéØ **R√âSUM√â DES EMPLACEMENTS**
```
<head>
  <style>
    ... vos styles existants ...
    
    /* AJOUTER ICI LE CSS DE L'√âCRAN D'ACCUEIL */
    
  </style>
</head>

<body>
  
  <!-- AJOUTER ICI LE HTML DE LA MODAL -->
  
  <header>
    ... votre header existant ...
  </header>
  
  ... reste du contenu ...
  
  <script>
    ... vos scripts existants ...
  </script>
  
  <!-- AJOUTER ICI LE JAVASCRIPT DE L'√âCRAN D'ACCUEIL -->
  
</body>
</html>
